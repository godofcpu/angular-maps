!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("async"),require("@angular/core"),require("rxjs"),require("@angular/common"),require("bingmaps")):"function"==typeof define&&define.amd?define("angular-maps",["exports","async","@angular/core","rxjs","@angular/common","bingmaps"],e):e(t["angular-maps"]={},null,t.ng.core,t.rxjs,t.ng.common)}(this,function(t,n,r,a,e){"use strict";function i(){}var s={None:0,FontMarker:1,CanvasMarker:2,DynamicCircleMarker:3,RotatedImageMarker:4,RoundedImageMarker:5,ScaledImageMarker:6,Custom:7};s[s.None]="None",s[s.FontMarker]="FontMarker",s[s.CanvasMarker]="CanvasMarker",s[s.DynamicCircleMarker]="DynamicCircleMarker",s[s.RotatedImageMarker]="RotatedImageMarker",s[s.RoundedImageMarker]="RoundedImageMarker",s[s.ScaledImageMarker]="ScaledImageMarker",s[s.Custom]="Custom";var l=(u.CreateMarker=function(t){switch(t.markerType){case s.CanvasMarker:return u.CreateCanvasMarker(t);case s.DynamicCircleMarker:return u.CreateDynamicCircleMarker(t);case s.FontMarker:return u.CreateFontBasedMarker(t);case s.RotatedImageMarker:return u.CreateRotatedImageMarker(t);case s.RoundedImageMarker:return u.CreateRoundedImageMarker(t);case s.ScaledImageMarker:return u.CreateScaledImageMarker(t);case s.Custom:throw Error("Custom Marker Creators are not currently supported.")}throw Error("Unsupported marker type: "+t.markerType)},u.GetImageForMarker=function(t){if(null==t||""===t)return null;var e=null;return null!=(e=u.ImageElementCache.get(t))||"undefined"!=typeof document&&null!=document&&((e=document.createElement("img")).src=t,u.ImageElementCache.set(t,e)),e},u.CreateCanvasMarker=function(t){if(null==document)throw Error("Document context (window.document) is required for canvas markers.");if(null==t||null==t.size||null==t.points)throw Error("IMarkerIconInfo.size, and IMarkerIConInfo.points are required for canvas markers.");if(null!=t.id&&u.MarkerCache.has(t.id)){var e=u.MarkerCache.get(t.id);return t.size=e.markerSize,e.markerIconString}var i=document.createElement("canvas"),n=i.getContext("2d");i.width=t.size.width,i.height=t.size.height,t.rotation&&(n.translate(.5*i.width,.5*i.height),n.rotate(t.rotation*Math.PI/180),n.translate(.5*-i.width,.5*-i.height)),n.fillStyle=t.color||"red",n.beginPath(),t.drawingOffset&&n.moveTo(t.drawingOffset.x,t.drawingOffset.y),t.points.forEach(function(t){n.lineTo(t.x,t.y)}),n.closePath(),n.fill(),n.stroke();var o=i.toDataURL();return null!=t.id&&u.MarkerCache.set(t.id,{markerIconString:o,markerSize:t.size}),o},u.CreateDynamicCircleMarker=function(t){if(null==document)throw Error("Document context (window.document) is required for dynamic circle markers.");if(null==t||null==t.size)throw Error("IMarkerIconInfo.size is required for dynamic circle markers.");if(null!=t.id&&u.MarkerCache.has(t.id)){var e=u.MarkerCache.get(t.id);return t.size=e.markerSize,e.markerIconString}var i=t.strokeWidth||0,n=['<svg xmlns="http://www.w3.org/2000/svg" width="',t.size.width.toString(),'" height="',t.size.width.toString(),'"><circle cx="',(t.size.width/2).toString(),'" cy="',(t.size.width/2).toString(),'" r="',(t.size.width/2-i).toString(),'" stroke="',t.color||"red",'" stroke-width="',i.toString(),'" fill="',t.color||"red",'"/></svg>'].join("");return null!=t.id&&u.MarkerCache.set(t.id,{markerIconString:n,markerSize:t.size}),n},u.CreateFontBasedMarker=function(t){if(null==document)throw Error("Document context (window.document) is required for font based markers");if(null==t||null==t.fontName||null==t.fontSize)throw Error("IMarkerIconInfo.fontName, IMarkerIconInfo.fontSize and IMarkerIConInfo.text are required for font based markers.");if(null!=t.id&&u.MarkerCache.has(t.id)){var e=u.MarkerCache.get(t.id);return t.size=e.markerSize,e.markerIconString}var i=document.createElement("canvas"),n=i.getContext("2d"),o=t.fontSize+"px "+t.fontName;n.font=o;var r=n.measureText(t.text);i.width=r.width,i.height=t.fontSize,t.rotation&&(n.translate(.5*i.width,.5*i.height),n.rotate(t.rotation*Math.PI/180),n.translate(.5*-i.width,.5*-i.height)),n.font=o,n.textBaseline="top",n.fillStyle=t.color||"red",n.fillText(t.text,0,0),t.size={width:i.width,height:i.height};var a=i.toDataURL();return null!=t.id&&u.MarkerCache.set(t.id,{markerIconString:a,markerSize:t.size}),a},u.CreateRotatedImageMarker=function(r){if(null==document)throw Error("Document context (window.document) is required for rotated image markers");if(null==r||null==r.rotation||null==r.url)throw Error("IMarkerIconInfo.rotation, IMarkerIconInfo.url are required for rotated image markers.");if(null!=r.id&&u.MarkerCache.has(r.id)){var t=u.MarkerCache.get(r.id);return r.size=t.markerSize,t.markerIconString}var a=new Image;return new Promise(function(o,t){a.crossOrigin="anonymous",a.src=r.url,r.size&&(a.width=r.size.width,a.height=r.size.height),a.onload=function(){var t=document.createElement("canvas"),e=t.getContext("2d"),i=r.rotation*Math.PI/180;t.width=Math.ceil(Math.abs(a.width*Math.cos(i))+Math.abs(a.height*Math.sin(i))),t.height=Math.ceil(Math.abs(a.width*Math.sin(i))+Math.abs(a.height*Math.cos(i))),e.translate(t.width/2,t.height/2),e.rotate(i),e.drawImage(a,-a.width/2,-a.height/2,a.width,a.height),r.size={width:t.width,height:t.height};var n=t.toDataURL();null!=r.id&&u.MarkerCache.set(r.id,{markerIconString:n,markerSize:r.size}),o({icon:n,iconInfo:r})}})},u.CreateRoundedImageMarker=function(s){if(null==document)throw Error("Document context (window.document) is required for rounded image markers");if(null==s||null==s.size||null==s.url)throw Error("IMarkerIconInfo.size, IMarkerIconInfo.url are required for rounded image markers.");if(null!=s.id&&u.MarkerCache.has(s.id)){var t=u.MarkerCache.get(s.id);return s.size=t.markerSize,t.markerIconString}return new Promise(function(n,t){var o=s.size.width/2,r=new Image,a=s.drawingOffset||{x:0,y:0};r.crossOrigin="anonymous",r.src=s.url,r.onload=function(){var t=document.createElement("canvas"),e=t.getContext("2d");t.width=s.size.width,t.height=s.size.width,e.beginPath(),e.arc(o,o,o,0,2*Math.PI,!1),e.fill(),e.clip(),e.drawImage(r,a.x,a.y,s.size.width,s.size.width),s.size={width:t.width,height:t.height};var i=t.toDataURL();null!=s.id&&u.MarkerCache.set(s.id,{markerIconString:i,markerSize:s.size}),n({icon:i,iconInfo:s})}})},u.CreateScaledImageMarker=function(r){if(null==document)throw Error("Document context (window.document) is required for scaled image markers");if(null==r||null==r.scale||null==r.url)throw Error("IMarkerIconInfo.scale, IMarkerIconInfo.url are required for scaled image markers.");if(null!=r.id&&u.MarkerCache.has(r.id)){var t=u.MarkerCache.get(r.id);return r.size=t.markerSize,t.markerIconString}return new Promise(function(n,t){var o=new Image;o.crossOrigin="anonymous",o.src=r.url,o.onload=function(){var t=document.createElement("canvas"),e=t.getContext("2d");t.width=o.width*r.scale,t.height=o.height*r.scale,e.drawImage(o,0,0,t.width,t.height),r.size={width:t.width,height:t.height};var i=t.toDataURL();null!=r.id&&u.MarkerCache.set(r.id,{markerIconString:i,markerSize:r.size}),n({icon:i,iconInfo:r})}})},u.ImageElementCache=new Map,u.MarkerCache=new Map,u);function u(){}var p={aerial:0,canvasDark:1,canvasLight:2,grayscale:3,hybrid:4,mercator:5,ordnanceSurvey:6,road:7,streetside:8};p[p.aerial]="aerial",p[p.canvasDark]="canvasDark",p[p.canvasLight]="canvasLight",p[p.grayscale]="grayscale",p[p.hybrid]="hybrid",p[p.mercator]="mercator",p[p.ordnanceSurvey]="ordnanceSurvey",p[p.road]="road",p[p.streetside]="streetside";function o(){}var c=(Object.defineProperty(h.prototype,"Center",{get:function(){return null==this._center&&(this._center=this.GetBoundingCenter()),this._center},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"Centroid",{get:function(){return null==this._centroid&&(this._centroid=this.GetPolygonCentroid()),this._centroid},enumerable:!0,configurable:!0}),h.prototype.GetBoundingCenter=function(){var t={latitude:0,longitude:0},e=90,i=-90,n=180,o=-180,r=this.GetPaths();return r?(r.forEach(function(t){return t.forEach(function(t){t.latitude<e&&(e=t.latitude),t.latitude>i&&(i=t.latitude),t.longitude<n&&(n=t.longitude),t.longitude>o&&(o=t.longitude)})}),t.latitude=e+(i-e)/2,t.longitude=n+(o-n)/2):t=null,t},h.prototype.GetPolygonCentroid=function(){var t={latitude:0,longitude:0},e=this.GetPaths(),i=e[0][0];if(null!=i){for(var n=0,o=0,r=0,a=void 0,s=void 0,l=void 0,u=0;u<e.length;u++)for(var p=0,c=e[u].length-1;p<e[u].length;c=p++)a=e[u][p],s=e[u][c],n+=l=(a.latitude-i.latitude)*(s.longitude-i.longitude)-(s.latitude-i.latitude)*(a.longitude-i.longitude),o+=(a.latitude+s.latitude-2*i.latitude)*l,r+=(a.longitude+s.longitude-2*i.longitude)*l;0!==n?(l=3*n,t.latitude=o/l+i.latitude,t.longitude=r/l+i.longitude):(t.latitude=i.latitude,t.longitude=i.longitude)}else t=null;return t},h);function h(){}var f=(Object.defineProperty(d.prototype,"Center",{get:function(){return null==this._center&&(this._center=this.GetBoundingCenter()),this._center},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"Centroid",{get:function(){return null==this._centroid&&(this._centroid=this.GetPolylineCentroid()),this._centroid},enumerable:!0,configurable:!0}),d.GetPolylineCentroid=function(t){var e={latitude:0,longitude:0},i=t[0];if(null!=i){for(var n=0,o=0,r=0,a=void 0,s=void 0,l=void 0,u=0,p=t.length-1;u<t.length;p=u++)a=t[u],s=t[p],n+=l=(a.latitude-i.latitude)*(s.longitude-i.longitude)-(s.latitude-i.latitude)*(a.longitude-i.longitude),o+=(a.latitude+s.latitude-2*i.latitude)*l,r+=(a.longitude+s.longitude-2*i.longitude)*l;0!==n?(l=3*n,e.latitude=o/l+i.latitude,e.longitude=r/l+i.longitude):(e.latitude=i.latitude,e.longitude=i.longitude)}else e=null;return e},d.prototype.GetBoundingCenter=function(){var t={latitude:0,longitude:0},e=90,i=-90,n=180,o=-180,r=this.GetPath();return r?(r.forEach(function(t){t.latitude<e&&(e=t.latitude),t.latitude>i&&(i=t.latitude),t.longitude<n&&(n=t.longitude),t.longitude>o&&(o=t.longitude)}),t.latitude=e+(i-e)/2,t.longitude=n+(o-n)/2):t=null,t},d.prototype.GetPolylineCentroid=function(){var t=this.GetPath();return d.GetPolylineCentroid(t)},d);function d(){}var y=function(t,e){return(y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};function m(t,e){function i(){this.constructor=t}y(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}function g(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var n,o,r=i.call(t),a=[];try{for(;(void 0===e||0<e--)&&!(n=r.next()).done;)a.push(n.value)}catch(s){o={error:s}}finally{try{n&&!n.done&&(i=r["return"])&&i.call(r)}finally{if(o)throw o.error}}return a}function v(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(g(arguments[e]));return t}var _,b=(m(M,_=l),M);function M(){return null!==_&&_.apply(this,arguments)||this}var k={None:0,MeanValue:1,FirstPin:2};k[k.None]="None",k[k.MeanValue]="MeanValue",k[k.FirstPin]="FirstPin";var C={None:0,ZoomIntoCluster:1,Spider:2};C[C.None]="None",C[C.ZoomIntoCluster]="ZoomIntoCluster",C[C.Spider]="Spider";var S=0,O=(Object.defineProperty(P.prototype,"CanvasReady",{get:function(){return this._canvasReady},enumerable:!0,configurable:!0}),P.prototype.Delete=function(){this.SetMap(null)},P.prototype.OnAdd=function(){this._canvas=document.createElement("canvas"),this._canvas.style.position="absolute",this._canvas.style.left="0px",this._canvas.style.top="0px",this._canvas.id="xMapOverlay"+S,this.SetCanvasElement(this._canvas)},P.prototype.OnRemove=function(){this.SetCanvasElement(null),this.RemoveEventHandlers(),this._canvas=null},P.prototype.Redraw=function(t){null!=this._canvas&&(t&&this.Resize(),this._drawCallback&&this._drawCallback(this._canvas))},P.prototype.UpdatePosition=function(t,e,i,n){this._canvas.style.left=t+"px",this._canvas.style.top=e+"px",this._canvas.style.width=i+"px",this._canvas.style.height=n+"px"},P);function P(t){var i=this;this._canvasReady=new Promise(function(t,e){i._readyResolver=t}),this._drawCallback=t,S++}var w=(Object.defineProperty(L.prototype,"NativePrimitve",{get:function(){return this._layer},enumerable:!0,configurable:!0}),L.prototype.AddListener=function(t,e){Microsoft.Maps.Events.addHandler(this._layer,t,function(t){e(t)})},L.prototype.AddEntity=function(t){t&&t.NativePrimitve&&(this.GetVisible()?this._layer.add(t.NativePrimitve):this._pendingEntities.push(t))},L.prototype.AddEntities=function(t){var i=this;null!=t&&Array.isArray(t)&&0!==t.length&&n.eachSeries(v(t),function(t,e){i.GetVisible()?i._layer.add(t.NativePrimitve):i._pendingEntities.push(t),n.nextTick(function(){return e()})})},L.prototype.Delete=function(){this._maps.DeleteLayer(this)},L.prototype.GetOptions=function(){return{id:Number(this._layer.getId())}},L.prototype.GetVisible=function(){return this._layer.getVisible()},L.prototype.RemoveEntity=function(t){t.NativePrimitve&&this._layer.remove(t.NativePrimitve)},L.prototype.SetEntities=function(t){this._layer.setPrimitives([]),this.AddEntities(t)},L.prototype.SetOptions=function(t){this._layer.metadata.id=t.id.toString()},L.prototype.SetVisible=function(t){this._layer.setVisible(t),t&&0<this._pendingEntities.length&&this.AddEntities(this._pendingEntities.splice(0))},L);function L(t,e){this._layer=t,this._maps=e,this._pendingEntities=new Array}var I=(E.TranslateAction=function(t){return{eventHandler:t.eventHandler,label:t.label}},E.TranslateActions=function(t){var e=new Array;return t.forEach(function(t){return e.push(E.TranslateAction(t))}),e},E.TranslateBounds=function(t){return Microsoft.Maps.LocationRect.fromEdges(t.maxLatitude,t.minLongitude,t.minLatitude,t.maxLongitude)},E.TranslateClusterOptions=function(e){var i={};return Object.keys(e).filter(function(t){return-1!==E._clusterOptionsAttributes.indexOf(t)}).forEach(function(t){"layerOffset"===t&&(i.layerOffset=E.TranslatePoint(e.layerOffset)),"placementMode"===t?e.placementMode===k.FirstPin?i.placementMode=Microsoft.Maps.ClusterPlacementType.FirstLocation:i.placementMode=Microsoft.Maps.ClusterPlacementType.MeanAverage:i[t]=e[t]}),i},E.TranslateInfoBoxOptions=function(e){var i={};return Object.keys(e).filter(function(t){return-1!==E._infoWindowOptionsAttributes.indexOf(t)}).forEach(function(t){"pixelOffset"===t?i.offset=E.TranslatePoint(e.pixelOffset):"position"===t?i.location=E.TranslateLocation(e.position):"actions"===t?i.actions=E.TranslateActions(e.actions):i[t]=e[t]}),i},E.TranslateLoadOptions=function(e){var i={};return Object.keys(e).filter(function(t){return-1!==E._mapOptionsAttributes.indexOf(t)||-1!==E._viewOptionsAttributes.indexOf(t)}).forEach(function(t){"center"===t?i.center=E.TranslateLocation(e.center):"mapTypeId"===t?e.mapTypeId===p.hybrid?(i.mapTypeId=Microsoft.Maps.MapTypeId.aerial,i.labelOverlay=Microsoft.Maps.LabelOverlay.visible):e.mapTypeId===p.aerial?(i.mapTypeId=Microsoft.Maps.MapTypeId.aerial,i.labelOverlay=Microsoft.Maps.LabelOverlay.hidden):i.mapTypeId=Microsoft.Maps.MapTypeId[p[e.mapTypeId]]:"bounds"===t?i.bounds=E.TranslateBounds(e.bounds):i[t]=e[t]}),i},E.TranslateLocation=function(t){return new Microsoft.Maps.Location(t.latitude,t.longitude)},E.TranslateMarkerOptions=function(e){var i={};return Object.keys(e).filter(function(t){return-1!==E._markerOptionsAttributes.indexOf(t)}).forEach(function(t){"anchor"===t?i.anchor=E.TranslatePoint(e.anchor):i[t]=e[t]}),i},E.TranslateOptions=function(e){var i={};return Object.keys(e).filter(function(t){return-1!==E._mapOptionsAttributes.indexOf(t)}).forEach(function(t){"center"===t?i.center=E.TranslateLocation(e.center):"mapTypeId"===t?i.mapTypeId=Microsoft.Maps.MapTypeId[p[e.mapTypeId]]:i[t]=e[t]}),i},E.TranslatePaths=function(t){var e=new Array;if(null!=t&&Array.isArray(t)&&0!==t.length)if(Array.isArray(t[0]))for(var i=t,n=0;n<i.length;n++){for(var o=new Array,r=0;r<i[n].length;r++)o.push(new Microsoft.Maps.Location(i[n][r].latitude,i[n][r].longitude));e.push(o)}else{var a=new Array;for(i=t,n=0;n<i.length;n++)a.push(new Microsoft.Maps.Location(i[n].latitude,i[n].longitude));e.push(a)}else e.push(new Array);return e},E.TranslatePoint=function(t){return new Microsoft.Maps.Point(t.x,t.y)},E.TranslatePolygonOptions=function(e){function i(t,e){var i=/rgba?\((\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*\d+[\.\d+]*)*\)/g.exec(t);if(i&&3<i.length)return e=1<e?e/100:e,"rgba("+[i[1],i[2],i[3],e].join(",")+")";if("#"!==t[0])return t;var n=t.substr(1);return"rgba("+[parseInt(n.substr(0,2),16),parseInt(n.substr(2,2),16),parseInt(n.substr(4,2),16),e].join(",")+")"}var n={};return Object.keys(e).filter(function(t){return-1!==E._polygonOptionsAttributes.indexOf(t)}).forEach(function(t){"strokeWeight"===t?n.strokeThickness=e.strokeWeight:"strokeColor"===t?e.strokeOpacity?n.strokeColor=i(e.strokeColor,e.strokeOpacity):n.strokeColor=e.strokeColor:"strokeOpacity"===t||("fillColor"===t?e.fillOpacity?n.fillColor=i(e.fillColor,e.fillOpacity):n.fillColor=e.fillColor:"fillOpacity"===t||(n[t]=e[t]))}),n},E.TranslatePolylineOptions=function(e){var i={};return Object.keys(e).filter(function(t){return-1!==E._polylineOptionsAttributes.indexOf(t)}).forEach(function(t){"strokeWeight"===t?i.strokeThickness=e.strokeWeight:"strokeColor"===t?e.strokeOpacity?i.strokeColor=function(t,e){var i=/rgba?\((\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*\d+[\.\d+]*)*\)/g.exec(t);if(i&&3<i.length)return e=1<e?e/100:e,"rgba("+[i[1],i[2],i[3],e].join(",")+")";if("#"!==t[0])return t;var n=t.substr(1);return"rgba("+[parseInt(n.substr(0,2),16),parseInt(n.substr(2,2),16),parseInt(n.substr(4,2),16),e].join(",")+")"}(e.strokeColor,e.strokeOpacity):i.strokeColor=e.strokeColor:"strokeOpacity"===t||(i[t]=e[t])}),i},E.TranslateViewOptions=function(e){var i={};return Object.keys(e).filter(function(t){return-1!==E._viewOptionsAttributes.indexOf(t)}).forEach(function(t){"center"===t?i.center=E.TranslateLocation(e.center):"bounds"===t?i.bounds=E.TranslateBounds(e.bounds):"centerOffset"===t?i.centerOffset=E.TranslatePoint(e.centerOffset):"mapTypeId"===t?i.mapTypeId=Microsoft.Maps.MapTypeId[p[e.mapTypeId]]:i[t]=e[t]}),i},E._mapOptionsAttributes=["backgroundColor","credentials","customizeOverlays","customMapStyle","disableBirdseye","disableKeyboardInput","disableMouseInput","disablePanning","disableTouchInput","disableUserInput","disableZooming","disableStreetside","enableClickableLogo","enableSearchLogo","fixedMapPosition","height","inertiaIntensity","navigationBarMode","showBreadcrumb","showCopyright","showDashboard","showMapTypeSelector","showScalebar","theme","tileBuffer","useInertia","width","center","zoom","mapTypeId","liteMode"],E._viewOptionsAttributes=["animate","bounds","center","centerOffset","heading","labelOverlay","mapTypeId","padding","zoom"],E._infoWindowOptionsAttributes=["actions","description","htmlContent","id","position","pixelOffset","showCloseButton","showPointer","pushpin","title","titleClickHandler","typeName","visible","width","height"],E._markerOptionsAttributes=["anchor","draggable","height","htmlContent","icon","infobox","state","title","textOffset","typeName","visible","width","zIndex"],E._polygonOptionsAttributes=["cursor","fillColor","fillOpacity","strokeColor","strokeOpacity","strokeWeight","visible"],E._polylineOptionsAttributes=["cursor","strokeColor","strokeOpacity","strokeWeight","visible"],E._clusterOptionsAttributes=["callback","clusteredPinCallback","clusteringEnabled","gridSize","layerOffset","placementMode","visible","zIndex"],E);function E(){}var T=(Object.defineProperty(x.prototype,"IsFirst",{get:function(){return this._isFirst},set:function(t){this._isFirst=t},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"IsLast",{get:function(){return this._isLast},set:function(t){this._isLast=t},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"Location",{get:function(){var t=this._pushpin.getLocation();return{latitude:t.latitude,longitude:t.longitude}},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"Metadata",{get:function(){return this._metadata},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"NativePrimitve",{get:function(){return this._pushpin},enumerable:!0,configurable:!0}),x.prototype.AddListener=function(t,e){Microsoft.Maps.Events.addHandler(this._pushpin,t,function(t){e(t)})},x.prototype.DeleteMarker=function(){(this._map||this._layer)&&(this._layer?this._layer.remove(this.NativePrimitve):this._map.entities.remove(this.NativePrimitve))},x.prototype.GetLabel=function(){return this._pushpin.getText()},x.prototype.GetVisible=function(){return this._pushpin.getVisible()},x.prototype.SetAnchor=function(t){var e={};e.anchor=new Microsoft.Maps.Point(t.x,t.y),this._pushpin.setOptions(e)},x.prototype.SetDraggable=function(t){var e={};e.draggable=t,this._pushpin.setOptions(e)},x.prototype.SetIcon=function(t){var e={};e.icon=t,this._pushpin.setOptions(e)},x.prototype.SetLabel=function(t){var e={};e.text=t,this._pushpin.setOptions(e)},x.prototype.SetPosition=function(t){var e=I.TranslateLocation(t);this._pushpin.setLocation(e)},x.prototype.SetTitle=function(t){var e={};e.title=t,this._pushpin.setOptions(e)},x.prototype.SetOptions=function(t){var e=I.TranslateMarkerOptions(t);this._pushpin.setOptions(e)},x.prototype.SetVisible=function(t){var e={};e.visible=t,this._pushpin.setOptions(e)},x);function x(t,e,i){this._pushpin=t,this._map=e,this._layer=i,this._metadata=new Map,this._isFirst=!1,this._isLast=!0}var A,z=(m(D,A=T),D);function D(){return null!==A&&A.apply(this,arguments)||this}var G=(Object.defineProperty(j.prototype,"NativePrimitve",{get:function(){return this._layer},enumerable:!0,configurable:!0}),j.prototype.AddListener=function(t,e){Microsoft.Maps.Events.addHandler(this._layer,t,function(t){e(t)})},j.prototype.AddEntity=function(t){var e=t instanceof l;if((e=t instanceof T||e)&&t.IsFirst&&this.StopClustering(),t.NativePrimitve&&t.Location){if(this._isClustering){var i=this._layer.getPushpins();i.push(t.NativePrimitve),this._layer.setPushpins(i),this._markers.push(t)}else this._pendingMarkers.push(t);this._markerLookup.set(t.NativePrimitve,t)}e&&t.IsLast&&this.StartClustering()},j.prototype.AddEntities=function(t){var e,i,n=this;if(null!=t&&Array.isArray(t)&&0!==t.length){var o=t.map(function(t){return n._markerLookup.set(t.NativePrimitve,t),t.NativePrimitve});if(this._isClustering){var r=this._layer.getPushpins();r.push.apply(r,v(o)),this._layer.setPushpins(r),(e=this._markers).push.apply(e,v(t))}else(i=this._pendingMarkers).push.apply(i,v(t))}},j.prototype.InitializeSpiderClusterSupport=function(t){var e=this;if(!this._useSpiderCluster){var i=this._maps.MapInstance;this._useSpiderCluster=!0,this._spiderLayer=new Microsoft.Maps.Layer,this._currentZoom=i.getZoom(),this.SetSpiderOptions(t),i.layers.insert(this._spiderLayer),this._events.push(Microsoft.Maps.Events.addHandler(i,"click",function(t){return e.OnMapClick(t)})),this._events.push(Microsoft.Maps.Events.addHandler(i,"viewchangestart",function(t){return e.OnMapViewChangeStart(t)})),this._events.push(Microsoft.Maps.Events.addHandler(i,"viewchangeend",function(t){return e.OnMapViewChangeEnd(t)})),this._events.push(Microsoft.Maps.Events.addHandler(this._layer,"click",function(t){return e.OnLayerClick(t)})),this._events.push(Microsoft.Maps.Events.addHandler(this._spiderLayer,"click",function(t){return e.OnLayerClick(t)})),this._events.push(Microsoft.Maps.Events.addHandler(this._spiderLayer,"mouseover",function(t){return e.OnSpiderMouseOver(t)})),this._events.push(Microsoft.Maps.Events.addHandler(this._spiderLayer,"mouseout",function(t){return e.OnSpiderMouseOut(t)}))}},j.prototype.Delete=function(){var e=this;this._useSpiderCluster&&(this._spiderLayer.clear(),this._maps.MapPromise.then(function(t){t.layers.remove(e._spiderLayer),e._spiderLayer=null}),this._events.forEach(function(t){return Microsoft.Maps.Events.removeHandler(t)}),this._events.splice(0),this._useSpiderCluster=!1),this._markers.splice(0),this._spiderMarkers.splice(0),this._pendingMarkers.splice(0),this._markerLookup.clear(),this._maps.DeleteLayer(this)},j.prototype.GetMarkerFromBingMarker=function(t){return this._markerLookup.get(t)},j.prototype.GetOptions=function(){var t=this._layer.getOptions();return{id:0,gridSize:t.gridSize,layerOffset:t.layerOffset,clusteringEnabled:t.clusteringEnabled,callback:t.callback,clusteredPinCallback:t.clusteredPinCallback,visible:t.visible,zIndex:t.zIndex}},j.prototype.GetVisible=function(){return this._layer.getOptions().visible},j.prototype.GetSpiderMarkerFromBingMarker=function(t){return this._spiderMarkerLookup.get(t)},j.prototype.RemoveEntity=function(t){if(t.NativePrimitve&&t.Location){var e=this._markers.indexOf(t),i=this._pendingMarkers.indexOf(t);if(-1<e&&this._markers.splice(e,1),-1<i&&this._pendingMarkers.splice(i,1),this._isClustering){var n=this._layer.getPushpins(),o=n.indexOf(t.NativePrimitve);-1<o&&(n.splice(o,1),this._layer.setPushpins(n))}this._markerLookup["delete"](t.NativePrimitve)}},j.prototype.SetEntities=function(t){var e=this,i=new Array;this._markers.splice(0),this._markerLookup.clear(),t.forEach(function(t){t.NativePrimitve&&t.Location&&(e._markers.push(t),e._markerLookup.set(t.NativePrimitve,t),i.push(t.NativePrimitve))}),this._layer.setPushpins(i)},j.prototype.SetOptions=function(t){var e=I.TranslateClusterOptions(t);this._layer.setOptions(e),t.spiderClusterOptions&&this.SetSpiderOptions(t.spiderClusterOptions)},j.prototype.SetVisible=function(t){var e=this._layer.getOptions();e.visible=t,this._layer.setOptions(e)},j.prototype.StartClustering=function(){if(!this._isClustering){var e=new Array;this._markers.forEach(function(t){t.NativePrimitve&&t.Location&&e.push(t.NativePrimitve)}),this._pendingMarkers.forEach(function(t){t.NativePrimitve&&t.Location&&e.push(t.NativePrimitve)}),this._layer.setPushpins(e),this._markers=this._markers.concat(this._pendingMarkers.splice(0)),this._isClustering=!0}},j.prototype.StopClustering=function(){this._isClustering&&(this._isClustering=!1)},j.prototype.GetBasicPushpinOptions=function(t){return{anchor:t.getAnchor(),color:t.getColor(),cursor:t.getCursor(),icon:t.getIcon(),roundClickableArea:t.getRoundClickableArea(),subTitle:t.getSubTitle(),text:t.getText(),textOffset:t.getTextOffset(),title:t.getTitle()}},j.prototype.HideSpiderCluster=function(){this._mapclicks=0,this._currentCluster&&(this._spiderLayer.clear(),this._spiderMarkers.splice(0),this._spiderMarkerLookup.clear(),this._currentCluster=null,this._mapclicks=-1,this._spiderOptions.markerUnSelected&&this._spiderOptions.markerUnSelected())},j.prototype.OnLayerClick=function(t){if(t.primitive instanceof Microsoft.Maps.ClusterPushpin){var e=t.primitive!==this._currentCluster;this.HideSpiderCluster(),e&&this.ShowSpiderCluster(t.primitive)}else{var i=t.primitive;if(i.metadata&&i.metadata.isClusterMarker){var n=this.GetSpiderMarkerFromBingMarker(i).ParentMarker,o=n.NativePrimitve;this._spiderOptions.markerSelected&&this._spiderOptions.markerSelected(n,new T(this._currentCluster,null,null)),Microsoft.Maps.Events.hasHandler(o,"click")&&Microsoft.Maps.Events.invoke(o,"click",t),this._mapclicks=0}else this._spiderOptions.markerSelected&&this._spiderOptions.markerSelected(this.GetMarkerFromBingMarker(i),null),Microsoft.Maps.Events.hasHandler(i,"click")&&Microsoft.Maps.Events.invoke(i,"click",t)}},j.prototype.OnMapClick=function(t){-1!==this._mapclicks&&++this._mapclicks>=this._spiderOptions.collapseClusterOnNthClick&&this.HideSpiderCluster()},j.prototype.OnMapViewChangeEnd=function(t){var e=t.target.getZoom(),i=e!==this._currentZoom;this._currentZoom=e,i&&this.HideSpiderCluster()},j.prototype.OnMapViewChangeStart=function(t){this._spiderOptions.collapseClusterOnMapChange&&this.HideSpiderCluster()},j.prototype.OnSpiderMouseOut=function(t){var e=t.primitive;e instanceof Microsoft.Maps.Pushpin&&e.metadata&&e.metadata.isClusterMarker&&this.GetSpiderMarkerFromBingMarker(e).Stick.setOptions(this._spiderOptions.stickStyle)},j.prototype.OnSpiderMouseOver=function(t){var e=t.primitive;if(e instanceof Microsoft.Maps.Pushpin&&e.metadata&&e.metadata.isClusterMarker){var i=this.GetSpiderMarkerFromBingMarker(e);if(i.Stick.setOptions(this._spiderOptions.stickHoverStyle),this._spiderOptions.invokeClickOnHover){var n=i.ParentMarker.NativePrimitve;Microsoft.Maps.Events.hasHandler(n,"click")&&Microsoft.Maps.Events.invoke(n,"click",t)}}},j.prototype.SetSpiderOptions=function(t){t&&("number"==typeof t.circleSpiralSwitchover&&(this._spiderOptions.circleSpiralSwitchover=t.circleSpiralSwitchover),"boolean"==typeof t.collapseClusterOnMapChange&&(this._spiderOptions.collapseClusterOnMapChange=t.collapseClusterOnMapChange),"number"==typeof t.collapseClusterOnNthClick&&(this._spiderOptions.collapseClusterOnNthClick=t.collapseClusterOnNthClick),"boolean"==typeof t.invokeClickOnHover&&(this._spiderOptions.invokeClickOnHover=t.invokeClickOnHover),"number"==typeof t.minSpiralAngleSeperation&&(this._spiderOptions.minSpiralAngleSeperation=t.minSpiralAngleSeperation),"number"==typeof t.spiralDistanceFactor&&(this._spiderOptions.spiralDistanceFactor=t.spiralDistanceFactor),"number"==typeof t.minCircleLength&&(this._spiderOptions.minCircleLength=t.minCircleLength),t.stickHoverStyle&&(this._spiderOptions.stickHoverStyle=t.stickHoverStyle),t.stickStyle&&(this._spiderOptions.stickStyle=t.stickStyle),t.markerSelected&&(this._spiderOptions.markerSelected=t.markerSelected),t.markerUnSelected&&(this._spiderOptions.markerUnSelected=t.markerUnSelected),"boolean"==typeof t.visible&&(this._spiderOptions.visible=t.visible),this.SetOptions(t))},j.prototype.ShowSpiderCluster=function(t){if(this.HideSpiderCluster(),(this._currentCluster=t)&&t.containedPushpins){var e=this._maps.MapInstance,i=t.containedPushpins,n=t.getLocation(),o=e.tryLocationToPixel(n,Microsoft.Maps.PixelReference.control),r=void 0,a=0,s=i.length>this._spiderOptions.circleSpiralSwitchover,l=void 0,u=void 0,p=void 0;s?(l=this._spiderOptions.minCircleLength/Math.PI,p=2*Math.PI*this._spiderOptions.spiralDistanceFactor):(u=2*Math.PI/i.length,(l=this._spiderOptions.spiralDistanceFactor/u/Math.PI/2*i.length)<this._spiderOptions.minCircleLength&&(l=this._spiderOptions.minCircleLength));for(var c=0,h=i.length;c<h;c++){s?l+=p/(a+=this._spiderOptions.minSpiralAngleSeperation/l+5e-4*c):a=u*c;var f=new Microsoft.Maps.Point(o.x+l*Math.cos(a),o.y+l*Math.sin(a)),d=e.tryPixelToLocation(f,Microsoft.Maps.PixelReference.control);r=new Microsoft.Maps.Polyline([n,d],this._spiderOptions.stickStyle),this._spiderLayer.add(r);var y=new Microsoft.Maps.Pushpin(d);y.metadata=i[c].metadata||{},y.metadata.isClusterMarker=!0,y.setOptions(this.GetBasicPushpinOptions(i[c])),this._spiderLayer.add(y);var m=new z(y,null,this._spiderLayer);m.Stick=r,m.ParentMarker=this.GetMarkerFromBingMarker(i[c]),this._spiderMarkers.push(m),this._spiderMarkerLookup.set(y,m)}this._mapclicks=0}},j);function j(t,e){this._layer=t,this._maps=e,this._isClustering=!0,this._markers=new Array,this._markerLookup=new Map,this._pendingMarkers=new Array,this._spiderMarkers=new Array,this._spiderMarkerLookup=new Map,this._useSpiderCluster=!1,this._mapclicks=0,this._events=new Array,this._currentZoom=0,this._spiderOptions={circleSpiralSwitchover:9,collapseClusterOnMapChange:!1,collapseClusterOnNthClick:1,invokeClickOnHover:!0,minCircleLength:60,minSpiralAngleSeperation:25,spiralDistanceFactor:5,stickStyle:{strokeColor:"black",strokeThickness:2},stickHoverStyle:{strokeColor:"red"},markerSelected:null,markerUnSelected:null},this._currentCluster=null}var N=(Object.defineProperty(Z.prototype,"IsOpen",{get:function(){return!(!this._infoBox||!0!==this._infoBox.getOptions().visible)},enumerable:!0,configurable:!0}),Object.defineProperty(Z.prototype,"NativePrimitve",{get:function(){return this._infoBox},enumerable:!0,configurable:!0}),Z.prototype.AddListener=function(t,e){var i=this;Microsoft.Maps.Events.addHandler(this._infoBox,t,function(t){"infoboxChanged"===t.eventName?!0===i._infoBox.getOptions().visible?i._isOpen=!0:!1===i._infoBox.getOptions().visible&&!0===i._isOpen&&(i._isOpen=!1,e(t)):e(t)})},Z.prototype.Close=function(){var t={visible:!1};this._infoBox.setOptions(t)},Z.prototype.GetPosition=function(){return{latitude:this._infoBox.getLocation().latitude,longitude:this._infoBox.getLocation().longitude}},Z.prototype.Open=function(){var t={visible:!0};this._infoBox.setOptions(t)},Z.prototype.SetOptions=function(t){var e=I.TranslateInfoBoxOptions(t);this._infoBox.setOptions(e)},Z.prototype.SetPosition=function(t){var e=I.TranslateLocation(t);this._infoBox.setLocation(e)},Z);function Z(t){this._infoBox=t,this._isOpen=!1}var V=(R.prototype.Delete=function(){this.SetMap(null)},R.prototype.Changed=function(t){var e=!1,i=!1;Array.isArray(t)||(t=[t]),t.forEach(function(t){switch(t){case"fontFamily":case"fontSize":case"fontColor":case"strokeWeight":case"strokeColor":case"align":case"text":e=!0;break;case"maxZoom":case"minZoom":case"offset":case"hidden":case"position":i=!0}}),e&&this.DrawCanvas(),i&&this.Draw()},R.prototype.GetVisible=function(){var t=this.Get("minZoom"),e=this.Get("maxZoom");if(this.Get("hidden"))return"hidden";if(t===undefined&&e===undefined)return"";if(!this.GetMap())return"";var i=this.GetMap().getZoom();return i<t||e<i?"hidden":""},R.prototype.DrawCanvas=function(){if(this._canvas){var t=this._canvas.style;t.zIndex=this.Get("zIndex");var e=this._canvas.getContext("2d");e.clearRect(0,0,this._canvas.width,this._canvas.height),e.strokeStyle=this.Get("strokeColor"),e.font=this.Get("fontSize")+"px "+this.Get("fontFamily");var i=this.Get("backgroundColor"),n=Number(this.Get("strokeWeight")),o=this.Get("text"),r=e.measureText(o).width;o&&n&&0<n&&(e.lineWidth=n,e.strokeText(o,4,4)),i&&""!==i&&(e.fillStyle=i,e.fillRect(0,0,r+8,2*parseInt(e.font,10)-2)),e.fillStyle=this.Get("fontColor"),e.fillText(o,4,4),t.marginLeft=this.GetMarginLeft(r)+"px",t.marginTop="-0.4em",t.pointerEvents="none"}},R.prototype.GetMarginLeft=function(t){switch(this.Get("align")){case"left":return 0;case"right":return-t}return t/-2},R.prototype.OnRemove=function(){this._canvas&&this._canvas.parentNode&&this._canvas.parentNode.removeChild(this._canvas)},R);function R(t){this.Set("fontFamily","sans-serif"),this.Set("fontSize",12),this.Set("fontColor","#ffffff"),this.Set("strokeWeight",4),this.Set("strokeColor","#000000"),this.Set("align","center"),this.SetValues(t)}var B=(H.prototype.Extend=function(t){for(var e in this.Set("prototype",t,this._obj),this._proto)null!=this._proto[e]&&this.Set(e,this._proto[e],this._obj.prototype[e]);return this},H.prototype.Set=function(t,e,i){if(void 0===e)return this;void 0===i&&(i=this._proto),Object.defineProperty(i,t,e)},H.prototype.Map=function(t,e){return this.Set(t,this._proto[e],this._obj.prototype),this},H);function H(t){this._obj=t,this._proto=t.prototype}var F,W=0,U=(m(q,F=V),Object.defineProperty(q.prototype,"DefaultLabelStyle",{get:function(){return{fontSize:12,fontFamily:"sans-serif",fontColor:"#ffffff",strokeWeight:2,strokeColor:"#000000"}},enumerable:!0,configurable:!0}),q.prototype.Get=function(t){return this[t]},q.prototype.GetMap=function(){return"function"==typeof this.getMap?this.getMap():null},q.prototype.Set=function(t,e){"position"===t&&!e.hasOwnProperty("altitude")&&e.hasOwnProperty("latitude")&&e.hasOwnProperty("longitude")&&(e=new Microsoft.Maps.Location(e.latitude,e.longitude)),this.Get(t)!==e&&(this[t]=e,this.Changed(t))},q.prototype.SetMap=function(t){var e=this.GetMap();t!==e&&(e&&e.layers.remove(this),null!=t&&t.layers.insert(this))},q.prototype.SetValues=function(t){var e=new Array;for(var i in t)""!==i&&("position"===i&&!t[i].hasOwnProperty("altitude")&&t[i].hasOwnProperty("latitude")&&t[i].hasOwnProperty("longitude")&&(t[i]=new Microsoft.Maps.Location(t[i].latitude,t[i].longitude)),this.Get(i)!==t[i]&&(this[i]=t[i],e.push(i)));0<e.length&&this.Changed(e)},q.prototype.Draw=function(){var t=this.GetVisible(),e=this.GetMap();if(this._canvas&&e){var i=this._canvas.style;if(""===t){var n=this.Get("offset"),o=this.Get("position");if(o){n=n||new Microsoft.Maps.Point(0,0);var r=e.tryLocationToPixel(o,Microsoft.Maps.PixelReference.control);i.top=r.y+n.y+"px",i.left=r.x+n.x+"px",i.visibility=t}}else i.visibility=t}},q.prototype.OnAdd=function(){this._canvas=document.createElement("canvas"),this._canvas.id="xMapLabel"+W++,this._canvas.style.position="absolute";var t=this._canvas.getContext("2d");t.lineJoin="round",t.textBaseline="top",this.setHtmlElement(this._canvas)},q.prototype.OnLoad=function(){var t=this;Microsoft.Maps.Events.addHandler(this.GetMap(),"viewchange",function(){t.Changed("position")}),this.DrawCanvas(),this.Draw()},q);function q(t){var e=this;return t.fontSize=t.fontSize||12,t.fontColor=t.fontColor||"#ffffff",t.strokeWeight=t.strokeWeight||2,t.strokeColor=t.strokeColor||"#000000",(e=F.call(this,t)||this)._options.beneathLabels=!1,e}var Y,K=(m(X,Y=c),Object.defineProperty(X.prototype,"LabelMaxZoom",{get:function(){return this._maxZoom},set:function(t){this._maxZoom=t,this.ManageLabel()},enumerable:!0,configurable:!0}),Object.defineProperty(X.prototype,"LabelMinZoom",{get:function(){return this._minZoom},set:function(t){this._minZoom=t,this.ManageLabel()},enumerable:!0,configurable:!0}),Object.defineProperty(X.prototype,"Metadata",{get:function(){return this._metadata},enumerable:!0,configurable:!0}),Object.defineProperty(X.prototype,"NativePrimitve",{get:function(){return this._polygon},enumerable:!0,configurable:!0}),Object.defineProperty(X.prototype,"ShowLabel",{get:function(){return this._showLabel},set:function(t){this._showLabel=t,this.ManageLabel()},enumerable:!0,configurable:!0}),Object.defineProperty(X.prototype,"ShowTooltip",{get:function(){return this._showTooltip},set:function(t){this._showTooltip=t,this.ManageTooltip()},enumerable:!0,configurable:!0}),Object.defineProperty(X.prototype,"Title",{get:function(){return this._title},set:function(t){this._title=t,this.ManageLabel(),this.ManageTooltip()},enumerable:!0,configurable:!0}),X.prototype.AddListener=function(t,e){var i=this;if(-1!==["click","dblclick","drag","dragend","dragstart","mousedown","mouseout","mouseover","mouseup"].indexOf(t)&&Microsoft.Maps.Events.addHandler(this._polygon,t,function(t){e(t)}),"mousemove"===t){var n=void 0;Microsoft.Maps.Events.addHandler(this._polygon,"mouseover",function(t){n=Microsoft.Maps.Events.addHandler(i._map,"mousemove",function(t){return e(t)})}),Microsoft.Maps.Events.addHandler(this._polygon,"mouseout",function(t){n&&Microsoft.Maps.Events.removeHandler(n)})}"pathchanged"===t&&(this._editingCompleteEmitter=e)},X.prototype.Delete=function(){this._layer?this._layer.remove(this.NativePrimitve):this._map.entities.remove(this.NativePrimitve),this._label&&this._label.Delete(),this._tooltip&&this._tooltip.Delete()},X.prototype.GetDraggable=function(){return!1},X.prototype.GetEditable=function(){return this._isEditable},X.prototype.GetPath=function(){var t=this._polygon.getLocations(),e=new Array;return t.forEach(function(t){return e.push({latitude:t.latitude,longitude:t.longitude})}),e},X.prototype.GetPaths=function(){var t=this._polygon.getRings(),i=new Array;return t.forEach(function(t){var e=new Array;t.forEach(function(t){return e.push({latitude:t.latitude,longitude:t.longitude})}),i.push(e)}),i},X.prototype.GetVisible=function(){return this._polygon.getVisible()},X.prototype.SetDraggable=function(t){throw new Error("The bing maps implementation currently does not support draggable polygons.")},X.prototype.SetEditable=function(t){var n=this,e=this._isEditable!==t;this._isEditable=t,e&&(this._isEditable?(this._originalPath=this.GetPaths(),this._mapService.GetDrawingTools().then(function(t){t.edit(n._polygon)})):this._mapService.GetDrawingTools().then(function(t){t.finish(function(t){if(t===n._polygon&&n._editingCompleteEmitter){var e=n.GetPaths(),i=n._originalPath;n.SetPaths(e),n._editingCompleteEmitter({Click:null,Polygon:n,OriginalPath:i,NewPath:e})}})}))},X.prototype.SetOptions=function(t){var e=I.TranslatePolygonOptions(t);this._polygon.setOptions(e),null!=t.visible&&this._showLabel&&this._label&&this._label.Set("hidden",!t.visible),"undefined"!=typeof t.editable&&this.SetEditable(t.editable)},X.prototype.SetPath=function(t){var e=new Array;t.forEach(function(t){return e.push(new Microsoft.Maps.Location(t.latitude,t.longitude))}),this._originalPath=[t],this._polygon.setLocations(e),this._label&&(this._centroid=null,this.ManageLabel())},X.prototype.SetPaths=function(t){if(null!=t&&Array.isArray(t)){if(0===t.length)return this._polygon.setRings(new Array),void(this._label&&(this._label.Delete(),this._label=null));if(Array.isArray(t[0])){var i=new Array;t.forEach(function(t){var e=new Array;t.forEach(function(t){return e.push(new Microsoft.Maps.Location(t.latitude,t.longitude))}),i.push(e)}),this._originalPath=t,this._polygon.setRings(i),this._label&&(this._centroid=null,this.ManageLabel())}else this.SetPath(t)}},X.prototype.SetVisible=function(t){this._polygon.setOptions({visible:t}),this._showLabel&&this._label&&this._label.Set("hidden",!t)},X.prototype.ManageLabel=function(){if(null!=this.GetPath&&0!==this.GetPath().length)if(this._showLabel&&null!=this._title&&""!==this._title){var t={text:this._title,position:I.TranslateLocation(this.Centroid)};if(null==t.position)return;-1!==this._minZoom&&(t.minZoom=this._minZoom),-1!==this._maxZoom&&(t.maxZoom=this._maxZoom),null==this._label?(this._label=new U(t),this._label.SetMap(this._map)):this._label.SetValues(t),this._label.Set("hidden",!this.GetVisible())}else this._label&&(this._label.SetMap(null),this._label=null)},X.prototype.ManageTooltip=function(){var e=this;if(this._showTooltip&&null!=this._title&&""!==this._title){var t={text:this._title,align:"left",offset:new Microsoft.Maps.Point(0,25),backgroundColor:"bisque",hidden:!0,fontSize:12,fontColor:"#000000",strokeWeight:0};null==this._tooltip?(this._tooltip=new U(t),this._tooltip.SetMap(this._map)):this._tooltip.SetValues(t),this._hasToolTipReceiver||(this._mouseOverListener=Microsoft.Maps.Events.addHandler(this._polygon,"mouseover",function(t){e._tooltip.Set("position",t.location),e._tooltipVisible||(e._tooltip.Set("hidden",!1),e._tooltipVisible=!0),e._mouseMoveListener=Microsoft.Maps.Events.addHandler(e._map,"mousemove",function(t){e._tooltipVisible&&t.location&&t.primitive===e._polygon&&e._tooltip.Set("position",t.location)})}),this._mouseOutListener=Microsoft.Maps.Events.addHandler(this._polygon,"mouseout",function(t){e._tooltipVisible&&(e._tooltip.Set("hidden",!0),e._tooltipVisible=!1),e._mouseMoveListener&&Microsoft.Maps.Events.removeHandler(e._mouseMoveListener)}),this._hasToolTipReceiver=!0)}this._showTooltip&&""!==this._title&&null!=this._title||(this._hasToolTipReceiver&&(this._mouseOutListener&&Microsoft.Maps.Events.removeHandler(this._mouseOutListener),this._mouseOverListener&&Microsoft.Maps.Events.removeHandler(this._mouseOverListener),this._mouseMoveListener&&Microsoft.Maps.Events.removeHandler(this._mouseMoveListener),this._hasToolTipReceiver=!1),this._tooltip&&(this._tooltip.SetMap(null),this._tooltip=null))},X);function X(t,e,i){var n=Y.call(this)||this;return n._polygon=t,n._mapService=e,n._layer=i,n._map=null,n._isEditable=!1,n._title="",n._maxZoom=-1,n._minZoom=-1,n._showLabel=!1,n._showTooltip=!1,n._label=null,n._tooltip=null,n._hasToolTipReceiver=!1,n._tooltipVisible=!1,n._metadata=new Map,n._map=n._mapService.MapInstance,n._originalPath=n.GetPaths(),n}var J,Q=(m($,J=f),Object.defineProperty($.prototype,"Metadata",{get:function(){return this._metadata},enumerable:!0,configurable:!0}),Object.defineProperty($.prototype,"NativePrimitve",{get:function(){return this._polyline},enumerable:!0,configurable:!0}),Object.defineProperty($.prototype,"ShowTooltip",{get:function(){return this._showTooltip},set:function(t){this._showTooltip=t,this.ManageTooltip()},enumerable:!0,configurable:!0}),Object.defineProperty($.prototype,"Title",{get:function(){return this._title},set:function(t){this._title=t,this.ManageTooltip()},enumerable:!0,configurable:!0}),$.prototype.AddListener=function(t,e){var i=this;if(-1!==["click","dblclick","drag","dragend","dragstart","mousedown","mouseout","mouseover","mouseup"].indexOf(t)&&Microsoft.Maps.Events.addHandler(this._polyline,t,function(t){e(t)}),"mousemove"===t){var n=void 0;Microsoft.Maps.Events.addHandler(this._polyline,"mouseover",function(t){n=Microsoft.Maps.Events.addHandler(i._map,"mousemove",function(t){return e(t)})}),Microsoft.Maps.Events.addHandler(this._polyline,"mouseout",function(t){n&&Microsoft.Maps.Events.removeHandler(n)})}},$.prototype.Delete=function(){this._layer?this._layer.remove(this.NativePrimitve):this._map.entities.remove(this.NativePrimitve),this._tooltip&&this._tooltip.Delete()},$.prototype.GetDraggable=function(){return!1},$.prototype.GetEditable=function(){return this._isEditable},$.prototype.GetPath=function(){var t=this._polyline.getLocations(),e=new Array;return t.forEach(function(t){return e.push({latitude:t.latitude,longitude:t.longitude})}),e},$.prototype.GetVisible=function(){return this._polyline.getVisible()},$.prototype.SetDraggable=function(t){throw new Error("The bing maps implementation currently does not support draggable polylines.")},$.prototype.SetEditable=function(t){this._isEditable=t},$.prototype.SetOptions=function(t){var e=I.TranslatePolylineOptions(t);this._polyline.setOptions(e),t.path&&this.SetPath(t.path)},$.prototype.SetPath=function(t){var e=new Array;t.forEach(function(t){return e.push(new Microsoft.Maps.Location(t.latitude,t.longitude))}),this._polyline.setLocations(e)},$.prototype.SetVisible=function(t){this._polyline.setOptions({visible:t})},$.prototype.ManageTooltip=function(){var e=this;if(this._showTooltip&&null!=this._title&&""!==this._title){var t={text:this._title,align:"left",offset:new Microsoft.Maps.Point(0,25),backgroundColor:"bisque",hidden:!0,fontSize:12,fontColor:"#000000",strokeWeight:0};null==this._tooltip?(this._tooltip=new U(t),this._tooltip.SetMap(this._map)):this._tooltip.SetValues(t),this._hasToolTipReceiver||(this._mouseOverListener=Microsoft.Maps.Events.addHandler(this._polyline,"mouseover",function(t){e._tooltip.Set("position",t.location),e._tooltipVisible||(e._tooltip.Set("hidden",!1),e._tooltipVisible=!0)}),this._mouseMoveListener=Microsoft.Maps.Events.addHandler(this._map,"mousemove",function(t){e._tooltipVisible&&t.location&&t.primitive===e._polyline&&e._tooltip.Set("position",t.location)}),this._mouseOutListener=Microsoft.Maps.Events.addHandler(this._polyline,"mouseout",function(t){e._tooltipVisible&&(e._tooltip.Set("hidden",!0),e._tooltipVisible=!1)}),this._hasToolTipReceiver=!0)}this._showTooltip&&""!==this._title&&null!=this._title||(this._hasToolTipReceiver&&(this._mouseOutListener&&Microsoft.Maps.Events.removeHandler(this._mouseOutListener),this._mouseOverListener&&Microsoft.Maps.Events.removeHandler(this._mouseOverListener),this._mouseMoveListener&&Microsoft.Maps.Events.removeHandler(this._mouseMoveListener),this._hasToolTipReceiver=!1),this._tooltip&&(this._tooltip.SetMap(null),this._tooltip=null))},$);function $(t,e,i){var n=J.call(this)||this;return n._polyline=t,n._map=e,n._layer=i,n._isEditable=!0,n._title="",n._showTooltip=!1,n._tooltip=null,n._hasToolTipReceiver=!1,n._tooltipVisible=!1,n._metadata=new Map,n}var tt,et={click:"click",dblclick:"dblclick",rightclick:"rightclick",resize:"resize",boundschanged:"viewchangeend",centerchanged:"viewchangeend",zoomchanged:"viewchangeend",mouseover:"mouseover",mouseout:"mouseout",mousemove:"mousemove",infowindowclose:"infoboxChanged"},it=(m(nt,tt=O),nt.prototype.GetCoordinatesFromClick=function(t){return{latitude:t.location.latitude,longitude:t.location.longitude}},nt.prototype.GetMap=function(){return this.getMap()},nt.prototype.GetToolTipOverlay=function(){var t={align:"left",offset:new Microsoft.Maps.Point(0,25),backgroundColor:"bisque",hidden:!0,fontSize:12,fontColor:"#000000",strokeWeight:0},e=new U(t);return e.SetMap(this.GetMap()),e},nt.prototype.OnLoad=function(){var c=this,h=this.getMap();this._zoomStart=h.getZoom(),this._centerStart=h.getCenter(),this.Redraw(!0),this._viewChangeEvent=Microsoft.Maps.Events.addHandler(h,"viewchange",function(t){if(h.getMapTypeId()===Microsoft.Maps.MapTypeId.streetside)c._canvas.style.display="none";else{var e=h.getZoom(),i=h.getCenter(),n=Math.pow(2,e-c._zoomStart),o=h.getWidth()*n,r=h.getHeight()*n,a=h.tryLocationToPixel([I.TranslateLocation(c._centerStart),i],Microsoft.Maps.PixelReference.control),s=a[1].x-a[0].x,l=a[1].y-a[0].y,u=-(o-h.getWidth())/2-s,p=-(r-h.getHeight())/2-l;c.UpdatePosition(u,p,o,r)}}),this._viewChangeEndEvent=Microsoft.Maps.Events.addHandler(h,"viewchangeend",function(t){c.UpdateCanvas()}),this._mapResizeEvent=Microsoft.Maps.Events.addHandler(h,"mapresize",function(t){c.UpdateCanvas()}),this._readyResolver(!0)},nt.prototype.SetMap=function(t){var e=this.GetMap();t!==e&&(e&&e.layers.remove(this),null!=t&&t.layers.insert(this))},nt.prototype.SetCanvasElement=function(t){this.setHtmlElement(t)},nt.prototype.RemoveEventHandlers=function(){Microsoft.Maps.Events.removeHandler(this._viewChangeEvent),Microsoft.Maps.Events.removeHandler(this._viewChangeEndEvent),Microsoft.Maps.Events.removeHandler(this._mapResizeEvent)},nt.prototype.Resize=function(){var t=this.getMap();this._canvas.width=t.getWidth(),this._canvas.height=t.getHeight()},nt.prototype.UpdateCanvas=function(){var t=this.getMap();t.getMapTypeId()!==Microsoft.Maps.MapTypeId.streetside&&(this._canvas.style.display="",this.UpdatePosition(0,0,t.getWidth(),t.getHeight()),this.Redraw(!0),this._zoomStart=t.getZoom(),this._centerStart=t.getCenter())},nt);function nt(t){return tt.call(this,t)||this}var ot={hybrid:0,roadmap:1,satellite:2,terrain:3};ot[ot.hybrid]="hybrid",ot[ot.roadmap]="roadmap",ot[ot.satellite]="satellite",ot[ot.terrain]="terrain";var rt=(at.TranslateBounds=function(t){return{east:t.maxLongitude,north:t.maxLatitude,south:t.minLatitude,west:t.minLongitude}},at.TranslateInfoWindowOptions=function(e){var i={};return Object.keys(e).filter(function(t){return-1!==at._infoWindowOptionsAttributes.indexOf(t)}).forEach(function(t){"htmlContent"===t?i.content=e[t]:i[t]=e[t]}),null!=i.content&&""!==i.content||(""!==e.title&&""!==e.description?i.content=e.title+": "+e.description:""!==e.description?i.content=e.description:i.content=e.title),i},at.TranslateLocation=function(t){return{lat:t.latitude,lng:t.longitude}},at.TranslateLatLng=function(t){return{latitude:t.lat,longitude:t.lng}},at.TranslateLocationObject=function(t){return new google.maps.LatLng(t.latitude,t.longitude)},at.TranslateLatLngObject=function(t){return{latitude:t.lat(),longitude:t.lng()}},at.TranslateLocationObjectArray=function(t){for(var e=new Array,i=0;i<t.length;i++)e.push(at.TranslateLocationObject(t[i]));return e},at.TranslateMapTypeId=function(t){switch(t){case p.road:return ot[ot.roadmap];case p.grayscale:return ot[ot.terrain];case p.hybrid:return ot[ot.hybrid];case p.ordnanceSurvey:return ot[ot.terrain];default:return ot[ot.satellite]}},at.TranslateMarkerOptions=function(i){var n={};return Object.keys(i).filter(function(t){return-1!==at._markerOptionsAttributes.indexOf(t)}).forEach(function(t){if("position"===t){var e=at.TranslateLocationObject(i[t]);n.position=e}else n[t]=i[t]}),n},at.TranslateOptions=function(e){var i={};return Object.keys(e).filter(function(t){return-1!==at._mapOptionsAttributes.indexOf(t)}).forEach(function(t){"center"===t?i.center=at.TranslateLocation(e.center):"mapTypeId"===t?i.mapTypeId=at.TranslateMapTypeId(e.mapTypeId):"disableZooming"===t?(i.gestureHandling="none",i.zoomControl=!1):"showMapTypeSelector"===t?i.mapTypeControl=!1:"customMapStyleGoogle"===t?i.styles=e.customMapStyleGoogle:i[t]=e[t]}),i},at.TranslatePaths=function(t){var e=new Array;if(null!=t&&Array.isArray(t)&&0!==t.length)if(Array.isArray(t[0]))for(var i=t,n=0;n<i.length;n++)e.push(at.TranslateLocationObjectArray(i[n]));else e.push(at.TranslateLocationObjectArray(t));else e.push(new Array);return e},at.TranslatePolygonOptions=function(o){var r={};return Object.keys(o).filter(function(t){return-1!==at._polygonOptionsAttributes.indexOf(t)}).forEach(function(t){if("paths"===t){if(!Array.isArray(o.paths))return;if(0===o.paths.length)r.paths=new Array;else if(Array.isArray(o.paths[0])){r.paths=new Array;for(var e=o.paths,i=0;i<e.length;i++){r.paths[i]=new Array;for(var n=0;n<e[i].length;n++)r.paths[i][n]={lat:e[i][n].latitude,lng:e[i][n].longitude}}}else for(r.paths=new Array,e=o.paths,i=0;i<e.length;i++)r.paths[i]={lat:e[i].latitude,lng:e[i].longitude}}else r[t]=o[t]}),r},at.TranslatePolylineOptions=function(e){var i={};return Object.keys(e).filter(function(t){return-1!==at._polylineOptionsAttributes.indexOf(t)}).forEach(function(t){i[t]=e[t]}),i},at._mapOptionsAttributes=["backgroundColor","center","clickableIcons","customMapStyleGoogle","disableDefaultUI","disableDoubleClickZoom","draggable","draggableCursor","draggingCursor","disableZooming","fullscreenControl","fullscreenControlOptions","gestureHandling","heading","keyboardShortcuts","mapTypeControl","mapTypeControlOptions","mapTypeId","maxZoom","minZoom","noClear","panControl","panControlOptions","rotateControl","rotateControlOptions","scaleControl","scaleControlOptions","scrollwheel","showMapTypeSelector","streetView","streetViewControl","streetViewControlOptions","styles","tilt","zoom","zoomControl","zoomControlOptions"],at._infoWindowOptionsAttributes=["actions","description","htmlContent","id","position","pixelOffset","showCloseButton","showPointer","pushpin","title","titleClickHandler","typeName","visible","width","height"],at._markerOptionsAttributes=["anchor","position","title","text","label","draggable","icon","width","height","iconInfo","metadata","visible"],at._clusterOptionsAttributes=["callback","clusteredPinCallback","clusteringEnabled","gridSize","layerOffset","placementMode","visible","zIndex"],at._polygonOptionsAttributes=["clickable","draggable","editable","fillColor","fillOpacity","geodesic","paths","strokeColor","strokeOpacity","strokeWeight","visible","zIndex"],at._polylineOptionsAttributes=["clickable","draggable","editable","geodesic","strokeColor","strokeOpacity","strokeWeight","visible","zIndex"],at);function at(){}var st=(Object.defineProperty(lt.prototype,"IsOpen",{get:function(){return!0===this._isOpen},enumerable:!0,configurable:!0}),Object.defineProperty(lt.prototype,"NativePrimitve",{get:function(){return this._infoWindow},enumerable:!0,configurable:!0}),lt.prototype.AddListener=function(e,i){var n=this;this._infoWindow.addListener(e,function(t){"closeclick"===e&&(n._isOpen=!1),i(t)})},lt.prototype.Close=function(){this._isOpen=!1,this._infoWindow.close()},lt.prototype.GetPosition=function(){return rt.TranslateLatLngObject(this._infoWindow.getPosition())},lt.prototype.Open=function(e){var i=this;this._mapService.MapPromise.then(function(t){i._isOpen=!0,i._infoWindow.open(t,e)})},lt.prototype.SetOptions=function(t){var e=rt.TranslateInfoWindowOptions(t);this._infoWindow.setOptions(e)},lt.prototype.SetPosition=function(t){var e=rt.TranslateLocation(t);this._infoWindow.setPosition(e)},lt);function lt(t,e){this._infoWindow=t,this._mapService=e}var ut=(Object.defineProperty(pt.prototype,"IsFirst",{get:function(){return this._isFirst},set:function(t){this._isFirst=t},enumerable:!0,configurable:!0}),Object.defineProperty(pt.prototype,"IsLast",{get:function(){return this._isLast},set:function(t){this._isLast=t},enumerable:!0,configurable:!0}),Object.defineProperty(pt.prototype,"Metadata",{get:function(){return this._metadata},enumerable:!0,configurable:!0}),Object.defineProperty(pt.prototype,"NativePrimitve",{get:function(){return this._marker},enumerable:!0,configurable:!0}),Object.defineProperty(pt.prototype,"Location",{get:function(){var t=this._marker.getPosition();return{latitude:t.lat(),longitude:t.lng()}},enumerable:!0,configurable:!0}),pt.prototype.AddListener=function(t,e){this._marker.addListener(t,e)},pt.prototype.DeleteMarker=function(){this._marker.setMap(null)},pt.prototype.GetLabel=function(){return this._marker.getLabel().text},pt.prototype.GetVisible=function(){return this._marker.getVisible()},pt.prototype.SetAnchor=function(t){},pt.prototype.SetDraggable=function(t){this._marker.setDraggable(t)},pt.prototype.SetIcon=function(t){this._marker.setIcon(t)},pt.prototype.SetLabel=function(t){this._marker.setLabel(t)},pt.prototype.SetPosition=function(t){var e=rt.TranslateLocationObject(t);this._marker.setPosition(e)},pt.prototype.SetTitle=function(t){this._marker.setTitle(t)},pt.prototype.SetOptions=function(t){var e=rt.TranslateMarkerOptions(t);this._marker.setOptions(e)},pt.prototype.SetVisible=function(t){this._marker.setVisible(t)},pt);function pt(t){this._marker=t,this._metadata=new Map,this._isFirst=!1,this._isLast=!0}var ct,ht=(m(ft,ct=V),Object.defineProperty(ft.prototype,"DefaultLabelStyle",{get:function(){return{fontSize:12,fontFamily:"sans-serif",fontColor:"#ffffff",strokeWeight:3,strokeColor:"#000000"}},enumerable:!0,configurable:!0}),ft.prototype.Get=function(t){return this.get(t)},ft.prototype.GetMap=function(){return this.getMap()},ft.prototype.Set=function(t,e){"position"===t&&e.hasOwnProperty("latitude")&&e.hasOwnProperty("longitude")&&(e=new google.maps.LatLng(e.latitude,e.longitude)),this.Get(t)!==e&&this.set(t,e)},ft.prototype.SetMap=function(t){this.setMap(t)},ft.prototype.SetValues=function(t){for(var e in t)""!==e&&("position"===e&&t[e].hasOwnProperty("latitude")&&t[e].hasOwnProperty("longitude")&&(t[e]=new google.maps.LatLng(t[e].latitude,t[e].longitude)),this.Get(e)===t[e]&&delete t[e]);this.setValues(t)},ft.prototype.Draw=function(){var t=this.getProjection(),e=this.GetVisible();if(t&&this._canvas){var i=this._canvas.style;if(""===e){var n=this.Get("offset"),o=this.Get("position");if(o){o instanceof google.maps.LatLng||(o=new google.maps.LatLng(o.lat,o.lng)),n=n||new google.maps.Point(0,0);var r=t.fromLatLngToDivPixel(o);i.top=r.y+n.y+"px",i.left=r.x+n.x+"px",i.visibility=e}}else i.visibility=e}},ft.prototype.OnAdd=function(){this._canvas=document.createElement("canvas"),this._canvas.style.position="absolute";var t=this._canvas.getContext("2d");t.lineJoin="round",t.textBaseline="top",this.DrawCanvas();var e=this.getPanes();e&&e.overlayLayer.appendChild(this._canvas)},ft);function ft(t){return t.fontSize=t.fontSize||12,t.fontColor=t.fontColor||"#ffffff",t.strokeWeight=t.strokeWeight||3,t.strokeColor=t.strokeColor||"#000000",ct.call(this,t)||this}var dt,yt=(m(mt,dt=c),Object.defineProperty(mt.prototype,"LabelMaxZoom",{get:function(){return this._maxZoom},set:function(t){this._maxZoom=t,this.ManageLabel()},enumerable:!0,configurable:!0}),Object.defineProperty(mt.prototype,"LabelMinZoom",{get:function(){return this._minZoom},set:function(t){this._minZoom=t,this.ManageLabel()},enumerable:!0,configurable:!0}),Object.defineProperty(mt.prototype,"Metadata",{get:function(){return this._metadata},enumerable:!0,configurable:!0}),Object.defineProperty(mt.prototype,"NativePrimitve",{get:function(){return this._polygon},enumerable:!0,configurable:!0}),Object.defineProperty(mt.prototype,"ShowLabel",{get:function(){return this._showLabel},set:function(t){this._showLabel=t,this.ManageLabel()},enumerable:!0,configurable:!0}),Object.defineProperty(mt.prototype,"ShowTooltip",{get:function(){return this._showTooltip},set:function(t){this._showTooltip=t,this.ManageTooltip()},enumerable:!0,configurable:!0}),Object.defineProperty(mt.prototype,"Title",{get:function(){return this._title},set:function(t){this._title=t,this.ManageLabel(),this.ManageTooltip()},enumerable:!0,configurable:!0}),mt.prototype.AddListener=function(t,e){-1!==["click","dblclick","drag","dragend","dragstart","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"].indexOf(t)&&this._polygon.addListener(t,e),"pathchanged"===t&&(this._editingCompleteEmitter=e)},mt.prototype.Delete=function(){this._polygon.setMap(null),this._label&&this._label.Delete(),this._tooltip&&this._tooltip.Delete()},mt.prototype.GetDraggable=function(){return this._polygon.getDraggable()},mt.prototype.GetEditable=function(){return this._polygon.getEditable()},mt.prototype.GetPath=function(){var t=this._polygon.getPath(),e=new Array;return t.forEach(function(t){return e.push({latitude:t.lat(),longitude:t.lng()})}),e},mt.prototype.GetPaths=function(){var t=this._polygon.getPaths(),i=new Array;return t.forEach(function(t){var e=new Array;t.forEach(function(t){return e.push({latitude:t.lat(),longitude:t.lng()})}),i.push(e)}),i},mt.prototype.GetVisible=function(){return this._polygon.getVisible()},mt.prototype.SetDraggable=function(t){this._polygon.setDraggable(t)},mt.prototype.SetEditable=function(t){var e=this._polygon.getEditable();this._polygon.setEditable(t),e&&!t&&this._editingCompleteEmitter&&(this._editingCompleteEmitter({Click:null,Polygon:this,OriginalPath:this._originalPath,NewPath:this.GetPaths()}),this._originalPath=this.GetPaths())},mt.prototype.SetOptions=function(t){var e=rt.TranslatePolygonOptions(t);"undefined"!=typeof e.editable&&(this.SetEditable(e.editable),delete e.editable),this._polygon.setOptions(e),null!=t.visible&&this._showLabel&&this._label&&this._label.Set("hidden",!t.visible)},mt.prototype.SetPath=function(t){var e=new Array;t.forEach(function(t){return e.push(new google.maps.LatLng(t.latitude,t.longitude))}),this._polygon.setPath(e),this._originalPath=[t],this._label&&(this._centroid=null,this.ManageLabel())},mt.prototype.SetPaths=function(t){if(null!=t&&Array.isArray(t)){if(0===t.length)return this._polygon.setPaths(new Array),void(this._label&&(this._label.Delete(),this._label=null));if(Array.isArray(t[0])){var i=new Array;t.forEach(function(t){var e=new Array;t.forEach(function(t){return e.push(new google.maps.LatLng(t.latitude,t.longitude))}),i.push(e)}),this._polygon.setPaths(i),this._originalPath=t,this._label&&(this._centroid=null,this.ManageLabel())}else this.SetPath(t)}},mt.prototype.SetVisible=function(t){this._polygon.setVisible(t),this._showLabel&&this._label&&this._label.Set("hidden",!t)},mt.prototype.ManageLabel=function(){if(null!=this.GetPath&&0!==this.GetPath().length)if(this._showLabel&&null!=this._title&&""!==this._title){var t={text:this._title,position:rt.TranslateLocationObject(this.Centroid)};if(null==t.position)return;-1!==this._minZoom&&(t.minZoom=this._minZoom),-1!==this._maxZoom&&(t.maxZoom=this._maxZoom),null==this._label?(t.map=this.NativePrimitve.getMap(),t.zIndex=this.NativePrimitve.zIndex?this.NativePrimitve.zIndex+1:100,this._label=new ht(t)):this._label.SetValues(t),this._label.Set("hidden",!this.GetVisible())}else this._label&&(this._label.SetMap(null),this._label=null)},mt.prototype.ManageTooltip=function(){var e=this;if(this._showTooltip&&null!=this._title&&""!==this._title){var t={text:this._title,align:"left",offset:new google.maps.Point(0,25),backgroundColor:"bisque",hidden:!0,fontSize:12,fontColor:"#000000",strokeWeight:0};null==this._tooltip?(t.map=this.NativePrimitve.getMap(),t.zIndex=1e5,this._tooltip=new ht(t)):this._tooltip.SetValues(t),this._hasToolTipReceiver||(this._mouseOverListener=this.NativePrimitve.addListener("mouseover",function(t){e._tooltip.Set("position",t.latLng),e._tooltipVisible||(e._tooltip.Set("hidden",!1),e._tooltipVisible=!0)}),this._mouseMoveListener=this.NativePrimitve.addListener("mousemove",function(t){e._tooltipVisible&&e._tooltip.Set("position",t.latLng)}),this._mouseOutListener=this.NativePrimitve.addListener("mouseout",function(t){e._tooltipVisible&&(e._tooltip.Set("hidden",!0),e._tooltipVisible=!1)}),this._hasToolTipReceiver=!0)}this._showTooltip&&""!==this._title&&null!=this._title||(this._hasToolTipReceiver&&(this._mouseOutListener&&google.maps.event.removeListener(this._mouseOutListener),this._mouseOverListener&&google.maps.event.removeListener(this._mouseOverListener),this._mouseMoveListener&&google.maps.event.removeListener(this._mouseMoveListener),this._hasToolTipReceiver=!1),this._tooltip&&(this._tooltip.SetMap(null),this._tooltip=null))},mt);function mt(t){var e=dt.call(this)||this;return e._polygon=t,e._title="",e._showLabel=!1,e._showTooltip=!1,e._maxZoom=-1,e._minZoom=-1,e._label=null,e._tooltip=null,e._tooltipVisible=!1,e._hasToolTipReceiver=!1,e._mouseOverListener=null,e._mouseOutListener=null,e._mouseMoveListener=null,e._metadata=new Map,e._editingCompleteEmitter=null,e._originalPath=e.GetPaths(),e}var gt,vt=(m(_t,gt=f),Object.defineProperty(_t.prototype,"Metadata",{get:function(){return this._metadata},enumerable:!0,configurable:!0}),Object.defineProperty(_t.prototype,"NativePrimitve",{get:function(){return this._polyline},enumerable:!0,configurable:!0}),Object.defineProperty(_t.prototype,"ShowTooltip",{get:function(){return this._showTooltip},set:function(t){this._showTooltip=t,this.ManageTooltip()},enumerable:!0,configurable:!0}),Object.defineProperty(_t.prototype,"Title",{get:function(){return this._title},set:function(t){this._title=t,this.ManageTooltip()},enumerable:!0,configurable:!0}),_t.prototype.AddListener=function(t,e){-1!==["click","dblclick","drag","dragend","dragstart","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"].indexOf(t)&&this._polyline.addListener(t,e)},_t.prototype.Delete=function(){this._polyline.setMap(null),this._tooltip&&this._tooltip.Delete()},_t.prototype.GetDraggable=function(){return this._polyline.getDraggable()},_t.prototype.GetEditable=function(){return this._polyline.getEditable()},_t.prototype.GetPath=function(){var t=this._polyline.getPath(),e=new Array;return t.forEach(function(t){return e.push({latitude:t.lat(),longitude:t.lng()})}),e},_t.prototype.GetVisible=function(){return this._polyline.getVisible()},_t.prototype.SetDraggable=function(t){this._polyline.setDraggable(t)},_t.prototype.SetEditable=function(t){this._polyline.setEditable(t)},_t.prototype.SetOptions=function(t){var e=rt.TranslatePolylineOptions(t);this._polyline.setOptions(e),t.path&&this.SetPath(t.path)},_t.prototype.SetPath=function(t){var e=new Array;t.forEach(function(t){return e.push(new google.maps.LatLng(t.latitude,t.longitude))}),this._polyline.setPath(e)},_t.prototype.SetVisible=function(t){this._polyline.setVisible(t)},_t.prototype.ManageTooltip=function(){var e=this;if(this._showTooltip&&null!=this._title&&""!==this._title){var t={text:this._title,align:"left",offset:new google.maps.Point(0,25),backgroundColor:"bisque",hidden:!0,fontSize:12,fontColor:"#000000",strokeWeight:0};null==this._tooltip?(t.map=this.NativePrimitve.getMap(),t.zIndex=1e5,this._tooltip=new ht(t)):this._tooltip.SetValues(t),this._hasToolTipReceiver||(this._mouseOverListener=this.NativePrimitve.addListener("mouseover",function(t){e._tooltip.Set("position",t.latLng),e._tooltipVisible||(e._tooltip.Set("hidden",!1),e._tooltipVisible=!0)}),this._mouseMoveListener=this.NativePrimitve.addListener("mousemove",function(t){e._tooltipVisible&&e._tooltip.Set("position",t.latLng)}),this._mouseOutListener=this.NativePrimitve.addListener("mouseout",function(t){e._tooltipVisible&&(e._tooltip.Set("hidden",!0),e._tooltipVisible=!1)}),this._hasToolTipReceiver=!0)}this._showTooltip&&""!==this._title&&null!=this._title||(this._hasToolTipReceiver&&(this._mouseOutListener&&google.maps.event.removeListener(this._mouseOutListener),this._mouseOverListener&&google.maps.event.removeListener(this._mouseOverListener),this._mouseMoveListener&&google.maps.event.removeListener(this._mouseMoveListener),this._hasToolTipReceiver=!1),this._tooltip&&(this._tooltip.SetMap(null),this._tooltip=null))},_t);function _t(t){var e=gt.call(this)||this;return e._polyline=t,e._title="",e._showTooltip=!1,e._tooltip=null,e._tooltipVisible=!1,e._hasToolTipReceiver=!1,e._mouseOverListener=null,e._mouseOutListener=null,e._mouseMoveListener=null,e._metadata=new Map,e}var bt,Mt={click:"click",dblclick:"dblclick",rightclick:"rightclick",resize:"resize",boundschanged:"bounds_changed",centerchanged:"center_changed",zoomchanged:"zoom_changed",mouseover:"mouseover",mouseout:"mouseout",mousemove:"mousemove",infowindowclose:"closeclick"},kt=(m(Ct,bt=O),Ct.prototype.GetCoordinatesFromClick=function(t){return t&&t.latLng&&t.latLng.lat&&t.latLng.lng?{latitude:t.latLng.lat(),longitude:t.latLng.lng()}:null},Ct.prototype.GetMap=function(){return this.getMap()},Ct.prototype.GetToolTipOverlay=function(){var t={align:"left",offset:new google.maps.Point(0,25),backgroundColor:"bisque",hidden:!0,fontSize:12,fontColor:"#000000",strokeWeight:0,zIndex:1e5},e=new ht(t);return e.SetMap(this.GetMap()),e},Ct.prototype.OnAdd=function(){bt.prototype.OnAdd.call(this),this.OnLoad(),this._canvas.style.zIndex="100",this._readyResolver(!0)},Ct.prototype.OnDraw=function(){var t=this.GetMap(),e=t.getZoom(),i=t.getCenter(),n=Math.pow(2,e-this._zoomStart),o=t.getDiv(),r=o.offsetWidth*n,a=o.offsetHeight*n,s=this.getProjection().fromLatLngToDivPixel(i);this.UpdatePosition(s.x-r/2,s.y-a/2,r,a)},Ct.prototype.OnLoad=function(){var e=this,t=this.getMap();this._zoomStart=t.getZoom();var i=t.getCenter();this._centerStart={latitude:i.lat(),longitude:i.lng()},this._viewChangeEndEvent=google.maps.event.addListener(t,"idle",function(t){e.UpdateCanvas()}),this._mapResizeEvent=google.maps.event.addListener(t,"resize",function(t){e.UpdateCanvas()})},Ct.prototype.SetMap=function(t){this.setMap(t)},Ct.prototype.SetCanvasElement=function(t){var e=this.getPanes();e&&(null!=t?e.overlayLayer.appendChild(t):e.overlayLayer.removeChild(this._canvas))},Ct.prototype.RemoveEventHandlers=function(){this._viewChangeEndEvent&&google.maps.event.removeListener(this._viewChangeEndEvent),this._mapResizeEvent&&google.maps.event.removeListener(this._mapResizeEvent)},Ct.prototype.Resize=function(){var t=this.getMap().getDiv();this._canvas.width=t.offsetWidth,this._canvas.height=t.offsetHeight},Ct.prototype.UpdateCanvas=function(){var t=this.getMap();this._canvas.style.display="";var e=t.getDiv(),i=e.offsetWidth,n=e.offsetHeight,o=this.getProjection().fromLatLngToDivPixel(t.getCenter());this.UpdatePosition(o.x-i/2,o.y-n/2,i,n),this.Redraw(!0),this._zoomStart=t.getZoom();var r=t.getCenter();this._centerStart={latitude:r.lat(),longitude:r.lng()}},Ct);function Ct(t){return bt.call(this,t)||this}var St=(Ot.decorators=[{type:r.Injectable}],Ot);function Ot(){}var Pt=(wt.GetRandonLocations=function(t,e){function i(t){var e=Math.random()*(t.maxLatitude-t.minLatitude)+t.minLatitude,i=0;return o?180<(i=Math.random()*(t.minLongitude+360-t.maxLongitude)+t.maxLongitude)&&(i-=360):i=Math.random()*(t.maxLongitude-t.minLongitude)+t.minLongitude,{latitude:e,longitude:i}}var n=[],o=!1;if(null==e&&(e={maxLatitude:360,minLatitude:0,maxLongitude:170,minLongitude:0}),(e.center.longitude<e.minLongitude||e.center.longitude>e.maxLongitude)&&(o=!0),!t||t<=0)return[i(e)];for(var r=0;r<t;r++)n.push(i(e));return n},wt.decorators=[{type:r.Injectable}],wt);function wt(){}var Lt=(It.decorators=[{type:r.Injectable}],It);function It(){}var Et=(Tt.decorators=[{type:r.Injectable}],Tt);function Tt(){}var xt=(At.decorators=[{type:r.Injectable}],At);function At(){}var zt=(Dt.decorators=[{type:r.Injectable}],Dt);function Dt(){}var Gt=(jt.decorators=[{type:r.Injectable}],jt);function jt(){}var Nt,Zt=(m(Vt,Nt=xt),Vt.decorators=[{type:r.Injectable}],Vt);function Vt(){return null!==Nt&&Nt.apply(this,arguments)||this}var Rt=(Bt.decorators=[{type:r.Directive,args:[{selector:"x-info-box-action"}]}],Bt.propDecorators={Label:[{type:r.Input}],ActionClicked:[{type:r.Output}]},Bt);function Bt(){this.ActionClicked=new r.EventEmitter}var Ht=0,Ft=(Object.defineProperty(Wt.prototype,"HtmlContent",{get:function(){return this._content.nativeElement&&this._content.nativeElement.innerText&&""!==this._content.nativeElement.innerText.trim()?this._content.nativeElement.outerHTML:""},enumerable:!0,configurable:!0}),Object.defineProperty(Wt.prototype,"Id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Wt.prototype.Close=function(){var t=this;return this._infoBoxService.Close(this).then(function(){t.InfoBoxClose.emit(t._id)})},Wt.prototype.ngAfterViewInit=function(){this._infoBoxService.AddInfoWindow(this),this._infoBoxAddedToManager=!0,this.HandleEvents()},Wt.prototype.ngOnChanges=function(t){this._infoBoxAddedToManager&&((t.latitude||t.longitude)&&"number"==typeof this.Latitude&&"number"==typeof this.Longitude&&this._infoBoxService.SetPosition(this,{latitude:t.latitude.currentValue,longitude:t.longitude.currentValue}),this.SetInfoWindowOptions(t))},Wt.prototype.ngOnDestroy=function(){this._infoBoxService.DeleteInfoWindow(this)},Wt.prototype.Open=function(t){return this._infoBoxService.Open(this,t)},Wt.prototype.ToString=function(){return"InfoBoxComponent-"+this._id},Wt.prototype.HandleEvents=function(){var e=this;this._infoBoxService.CreateEventObservable("infowindowclose",this).subscribe(function(t){e.InfoBoxClose.emit(e._id)})},Wt.prototype.SetInfoWindowOptions=function(t){var e={};t.title&&(e.title=this.Title),t.description&&(e.description=this.Description),t.disableAutoPan&&(e.disableAutoPan=this.DisableAutoPan),t.visible&&(e.visible=this.Visible),(t.xOffset||t.yOffset)&&(null==e.pixelOffset&&(e.pixelOffset={x:0,y:0}),e.pixelOffset.x=this.xOffset,e.pixelOffset.y=this.yOffset),this._infoBoxService.SetOptions(this,e)},Wt.decorators=[{type:r.Component,args:[{selector:"x-info-box",template:"\n        <div #infoBoxContent class='info-box-content'>\n            <ng-content></ng-content>\n        </div>",styles:["\n        x-map .MicrosoftMap .Infobox .infobox-title { padding: 10px 10px 5px 10px }\n        x-map .MicrosoftMap .Infobox .infobox-info { padding: 3px 10px 10px 10px }\n        x-map .MicrosoftMap .Infobox .infobox-actions { height: auto }\n    "],encapsulation:r.ViewEncapsulation.None}]}],Wt.ctorParameters=function(){return[{type:Et}]},Wt.propDecorators={_content:[{type:r.ViewChild,args:["infoBoxContent"]}],InfoWindowActions:[{type:r.ContentChildren,args:[Rt]}],Latitude:[{type:r.Input}],Longitude:[{type:r.Input}],Title:[{type:r.Input}],Description:[{type:r.Input}],DisableAutoPan:[{type:r.Input}],MaxWidth:[{type:r.Input}],Modal:[{type:r.Input}],HostMarker:[{type:r.Input}],Visible:[{type:r.Input}],xOffset:[{type:r.Input}],yOffset:[{type:r.Input}],CloseInfoBoxesOnOpen:[{type:r.Input}],InfoBoxClose:[{type:r.Output}]},Wt);function Wt(t){this._infoBoxService=t,this._infoBoxAddedToManager=!1,this._id=(Ht++).toString(),this.Modal=!0,this.Visible=!1,this.CloseInfoBoxesOnOpen=!0,this.InfoBoxClose=new r.EventEmitter}var Ut=0,qt=(Object.defineProperty(Yt.prototype,"AddedToManager",{get:function(){return this._markerAddedToManger},enumerable:!0,configurable:!0}),Object.defineProperty(Yt.prototype,"Id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(Yt.prototype,"InClusterLayer",{get:function(){return this._inClusterLayer},enumerable:!0,configurable:!0}),Object.defineProperty(Yt.prototype,"InCustomLayer",{get:function(){return this._inCustomLayer},enumerable:!0,configurable:!0}),Object.defineProperty(Yt.prototype,"LayerId",{get:function(){return this._layerId},enumerable:!0,configurable:!0}),Yt.prototype.LocationToPixel=function(t){return this._markerService.LocationToPoint(t||this)},Yt.prototype.ngAfterContentInit=function(){if(null!=this._infoBox&&(this._infoBox.HostMarker=this),this._containerRef.element.nativeElement.parentElement){var t=this._containerRef.element.nativeElement.parentElement.tagName;"x-cluster-layer"===t.toLowerCase()?this._inClusterLayer=!0:"x-map-layer"===t.toLowerCase()&&(this._inCustomLayer=!0),this._layerId=Number(this._containerRef.element.nativeElement.parentElement.attributes.layerId)}this._markerAddedToManger||(this._markerService.AddMarker(this),this._markerAddedToManger=!0,this.AddEventListeners())},Yt.prototype.ngOnChanges=function(t){"number"==typeof this.Latitude&&"number"==typeof this.Longitude&&this._markerAddedToManger&&((t.Latitude||t.Longitude)&&this._markerService.UpdateMarkerPosition(this),t.Title&&this._markerService.UpdateTitle(this),t.Label&&this._markerService.UpdateLabel(this),t.Draggable&&this._markerService.UpdateDraggable(this),(t.IconUrl||t.IconInfo)&&this._markerService.UpdateIcon(this),t.Anchor&&this._markerService.UpdateAnchor(this),t.Visible&&this._markerService.UpdateVisible(this))},Yt.prototype.ngOnDestroy=function(){this._markerService.DeleteMarker(this),this._events.forEach(function(t){return t.unsubscribe()})},Yt.prototype.toString=function(){return"MapMarker-"+this._id.toString()},Yt.prototype.AddEventListeners=function(){function i(t){return{Marker:n,Click:t,Location:n._markerService.GetCoordinatesFromClick(t),Pixels:n._markerService.GetPixelsFromClick(t)}}var n=this;this._events.push(this._markerService.CreateEventObservable("click",this).subscribe(function(e){n._clickTimeout=a.timer(300).subscribe(function(t){null!=n._infoBox&&n._infoBox.Open(n._markerService.GetCoordinatesFromClick(e)),n.MarkerClick.emit(i(e))})})),this._events.push(this._markerService.CreateEventObservable("dblclick",this).subscribe(function(t){n._clickTimeout&&(n._clickTimeout.unsubscribe(),n._clickTimeout=null),n.DblClick.emit(i(t))})),[{name:"drag",handler:function(t){return n.Drag.emit(i(t))}},{name:"dragend",handler:function(t){return n.DragEnd.emit(i(t))}},{name:"dragstart",handler:function(t){return n.DragStart.emit(i(t))}},{name:"mousedown",handler:function(t){return n.MouseDown.emit(i(t))}},{name:"mousemove",handler:function(t){return n.MouseMove.emit(i(t))}},{name:"mouseout",handler:function(t){return n.MouseOut.emit(i(t))}},{name:"mouseover",handler:function(t){return n.MouseOver.emit(i(t))}},{name:"mouseup",handler:function(t){return n.MouseUp.emit(i(t))}},{name:"rightclick",handler:function(t){return n.RightClick.emit(i(t))}}].forEach(function(t){var e=n._markerService.CreateEventObservable(t.name,n).subscribe(t.handler);n._events.push(e)})},Yt.decorators=[{type:r.Directive,args:[{selector:"x-map-marker"}]}],Yt.ctorParameters=function(){return[{type:Lt},{type:r.ViewContainerRef}]},Yt.propDecorators={_infoBox:[{type:r.ContentChild,args:[Ft]}],Anchor:[{type:r.Input}],DblClick:[{type:r.Output}],Drag:[{type:r.Output}],DragEnd:[{type:r.Output}],Draggable:[{type:r.Input}],DragStart:[{type:r.Output}],DynamicMarkerCreated:[{type:r.Output}],Height:[{type:r.Input}],IconInfo:[{type:r.Input}],IconUrl:[{type:r.Input}],IsFirstInSet:[{type:r.Input}],IsLastInSet:[{type:r.Input}],Label:[{type:r.Input}],Latitude:[{type:r.Input}],Longitude:[{type:r.Input}],MarkerClick:[{type:r.Output}],Metadata:[{type:r.Input}],MouseDown:[{type:r.Output}],MouseMove:[{type:r.Output}],MouseOut:[{type:r.Output}],MouseOver:[{type:r.Output}],MouseUp:[{type:r.Output}],RightClick:[{type:r.Output}],Title:[{type:r.Input}],Visible:[{type:r.Input}],Width:[{type:r.Input}]},Yt);function Yt(t,e){this._markerService=t,this._containerRef=e,this._clickTimeout=null,this._events=[],this._inClusterLayer=!1,this._inCustomLayer=!1,this._markerAddedToManger=!1,this.DblClick=new r.EventEmitter,this.Drag=new r.EventEmitter,this.DragEnd=new r.EventEmitter,this.Draggable=!1,this.DragStart=new r.EventEmitter,this.DynamicMarkerCreated=new r.EventEmitter,this.IsFirstInSet=!1,this.IsLastInSet=!0,this.MarkerClick=new r.EventEmitter,this.Metadata=new Map,this.MouseDown=new r.EventEmitter,this.MouseMove=new r.EventEmitter,this.MouseOut=new r.EventEmitter,this.MouseOver=new r.EventEmitter,this.MouseUp=new r.EventEmitter,this.RightClick=new r.EventEmitter,this._id=(Ut++).toString()}var Kt=(Object.defineProperty(Xt.prototype,"Box",{get:function(){return this._box},set:function(t){this._box=t},enumerable:!0,configurable:!0}),Object.defineProperty(Xt.prototype,"Latitude",{get:function(){return this._longitude},set:function(t){this._latitude=this.ConvertToDecimal(t),this.UpdateCenter()},enumerable:!0,configurable:!0}),Object.defineProperty(Xt.prototype,"Longitude",{get:function(){return this._longitude},set:function(t){this._longitude=this.ConvertToDecimal(t),this.UpdateCenter()},enumerable:!0,configurable:!0}),Object.defineProperty(Xt.prototype,"Options",{get:function(){return this._options},set:function(t){this._options=t},enumerable:!0,configurable:!0}),Object.defineProperty(Xt.prototype,"Zoom",{get:function(){return this._zoom},set:function(t){this._zoom=this.ConvertToDecimal(t,8),"number"==typeof this._zoom&&this._mapService.SetZoom(this._zoom)},enumerable:!0,configurable:!0}),Xt.prototype.ngOnInit=function(){this.InitMapInstance(this._container.nativeElement),this.MapPromise.emit(this._mapService.MapPromise),this.MapService.emit(this._mapService)},Xt.prototype.ngOnChanges=function(t){this._mapPromise&&(t.Box&&null!=this._box&&this._mapService.SetViewOptions({bounds:this._box}),t.Options&&this._mapService.SetMapOptions(this._options))},Xt.prototype.ngOnDestroy=function(){this._mapService.DisposeMap()},Xt.prototype.TriggerResize=function(){var e=this;return new Promise(function(t){setTimeout(function(){return e._mapService.TriggerMapEvent("resize").then(function(){return t()})})})},Xt.prototype.ConvertToDecimal=function(t,e){return void 0===e&&(e=null),"string"==typeof t?parseFloat(t):"number"==typeof t?t:e},Xt.prototype.HandleMapClickEvents=function(){var e=this;this._mapService.SubscribeToMapEvent("click").subscribe(function(t){e._clickTimeout=setTimeout(function(){e.MapClick.emit(t)},300)}),this._mapService.SubscribeToMapEvent("dblclick").subscribe(function(t){e._clickTimeout&&clearTimeout(e._clickTimeout),e.MapDblClick.emit(t)}),this._mapService.SubscribeToMapEvent("rightclick").subscribe(function(t){e.MapRightClick.emit(t)}),this._mapService.SubscribeToMapEvent("mouseover").subscribe(function(t){e.MapMouseOver.emit(t)}),this._mapService.SubscribeToMapEvent("mouseout").subscribe(function(t){e.MapMouseOut.emit(t)}),this._mapService.SubscribeToMapEvent("mousemove").subscribe(function(t){e.MapMouseMove.emit(t)})},Xt.prototype.HandleMapBoundsChange=function(){var e=this;this._mapService.SubscribeToMapEvent("boundschanged").subscribe(function(){e._mapService.GetBounds().then(function(t){e.BoundsChange.emit(t)})})},Xt.prototype.HandleMapCenterChange=function(){var e=this;this._mapService.SubscribeToMapEvent("centerchanged").subscribe(function(){e._mapService.GetCenter().then(function(t){e._latitude===t.latitude&&e._longitude===t.longitude||(e._latitude=t.latitude,e._longitude=t.longitude,e.CenterChange.emit({latitude:e._latitude,longitude:e._longitude}))})})},Xt.prototype.HandleMapZoomChange=function(){var e=this;this._mapService.SubscribeToMapEvent("zoomchanged").subscribe(function(){e._mapService.GetZoom().then(function(t){e._zoom!==t&&(e._zoom=t,e.ZoomChange.emit(t))})})},Xt.prototype.InitMapInstance=function(t){var e=this;this._zone.runOutsideAngular(function(){null==e._options.center&&(e._options.center={latitude:e._latitude,longitude:e._longitude}),null==e._options.zoom&&(e._options.zoom=e._zoom),null==e._options.mapTypeId&&(e._options.mapTypeId=p.hybrid),null!=e._box&&(e._options.bounds=e._box),e._mapPromise=e._mapService.CreateMap(t,e._options),e.HandleMapCenterChange(),e.HandleMapBoundsChange(),e.HandleMapZoomChange(),e.HandleMapClickEvents()})},Xt.prototype.UpdateCenter=function(){"number"==typeof this._latitude&&"number"==typeof this._longitude&&this._mapService.SetCenter({latitude:this._latitude,longitude:this._longitude})},Xt.decorators=[{type:r.Component,args:[{selector:"x-map",providers:[{provide:Pt,deps:[St],useFactory:te},{provide:Lt,deps:[St,Pt,xt,Zt],useFactory:ee},{provide:Et,deps:[St,Pt,Lt],useFactory:Qt},{provide:xt,deps:[St,Pt],useFactory:$t},{provide:Zt,deps:[St,Pt],useFactory:Jt},{provide:zt,deps:[St,Pt,xt],useFactory:ie},{provide:Gt,deps:[St,Pt,xt],useFactory:ne}],template:"\n        <div #container class='map-container-inner'></div>\n        <div class='map-content'>\n            <ng-content></ng-content>\n        </div>\n    ",styles:["\n        .map-container-inner { width: inherit; height: inherit; }\n        .map-container-inner div { background-repeat: no-repeat; }\n        .map-content { display:none; }\n    "],encapsulation:r.ViewEncapsulation.None,changeDetection:r.ChangeDetectionStrategy.OnPush}]}],Xt.ctorParameters=function(){return[{type:Pt},{type:r.NgZone}]},Xt.propDecorators={_containerClass:[{type:r.HostBinding,args:["class.map-container"]}],_container:[{type:r.ViewChild,args:["container"]}],_markers:[{type:r.ContentChildren,args:[qt]}],Box:[{type:r.Input}],Latitude:[{type:r.Input}],Longitude:[{type:r.Input}],Options:[{type:r.Input}],Zoom:[{type:r.Input}],BoundsChange:[{type:r.Output}],CenterChange:[{type:r.Output}],MapClick:[{type:r.Output}],MapDblClick:[{type:r.Output}],MapRightClick:[{type:r.Output}],MapMouseOver:[{type:r.Output}],MapMouseOut:[{type:r.Output}],MapMouseMove:[{type:r.Output}],MapPromise:[{type:r.Output}],ZoomChange:[{type:r.Output}],MapService:[{type:r.Output}]},Xt);function Xt(t,e){this._mapService=t,this._zone=e,this._longitude=0,this._latitude=0,this._zoom=0,this._options={},this._box=null,this._containerClass=!0,this.BoundsChange=new r.EventEmitter,this.CenterChange=new r.EventEmitter,this.MapClick=new r.EventEmitter,this.MapDblClick=new r.EventEmitter,this.MapRightClick=new r.EventEmitter,this.MapMouseOver=new r.EventEmitter,this.MapMouseOut=new r.EventEmitter,this.MapMouseMove=new r.EventEmitter,this.MapPromise=new r.EventEmitter,this.ZoomChange=new r.EventEmitter,this.MapService=new r.EventEmitter}function Jt(t,e){return t.CreateClusterService(e)}function Qt(t,e,i){return t.CreateInfoBoxService(e,i)}function $t(t,e){return t.CreateLayerService(e)}function te(t){return t.Create()}function ee(t,e,i,n){return t.CreateMarkerService(e,i,n)}function ie(t,e,i){return t.CreatePolygonService(e,i)}function ne(t,e,i){return t.CreatePolylineService(e,i)}var oe=0,re=(Object.defineProperty(ae.prototype,"Visible",{get:function(){return this._visible},set:function(t){this._visible=t},enumerable:!0,configurable:!0}),Object.defineProperty(ae.prototype,"Id",{get:function(){return this._id},enumerable:!0,configurable:!0}),ae.prototype.ngOnInit=function(){this._containerRef.element.nativeElement.attributes.layerId=this._id.toString(),this._layerService.AddLayer(this),this._addedToManager=!0},ae.prototype.ngOnChanges=function(t){this._addedToManager&&t.Visible&&this._layerService.GetNativeLayer(this).then(function(t){t.SetVisible(!t.GetVisible())})},ae.prototype.ngOnDestroy=function(){this._layerService.DeleteLayer(this)},ae.decorators=[{type:r.Directive,args:[{selector:"x-map-layer"}]}],ae.ctorParameters=function(){return[{type:xt},{type:r.ViewContainerRef}]},ae.propDecorators={_markers:[{type:r.ContentChildren,args:[qt]}],Visible:[{type:r.Input}]},ae);function ae(t,e){this._layerService=t,this._containerRef=e,this._visible=!0,this._addedToManager=!1,this._id=oe++}var se,le=(m(ue,se=re),Object.defineProperty(ue.prototype,"ClusterClickAction",{get:function(){return this._clusterClickAction},set:function(t){this._clusterClickAction=t},enumerable:!0,configurable:!0}),Object.defineProperty(ue.prototype,"ClusteringEnabled",{get:function(){return this._clusteringEnabled},set:function(t){this._clusteringEnabled=t},enumerable:!0,configurable:!0}),Object.defineProperty(ue.prototype,"ClusterPlacementMode",{get:function(){return this._clusterPlacementMode},set:function(t){this._clusterPlacementMode=t},enumerable:!0,configurable:!0}),Object.defineProperty(ue.prototype,"CustomMarkerCallback",{get:function(){return this._iconCreationCallback},set:function(t){if(this._useDynamicSizeMarker)throw new Error("You cannot set a custom marker callback when UseDynamicSizeMarkers is set to true.\n                    Set UseDynamicSizeMakers to false.");this._iconCreationCallback=t},enumerable:!0,configurable:!0}),Object.defineProperty(ue.prototype,"DynamicMarkerBaseSize",{get:function(){return this._dynamicMarkerBaseSize},set:function(t){this._dynamicMarkerBaseSize=t},enumerable:!0,configurable:!0}),Object.defineProperty(ue.prototype,"DynamicMarkerRanges",{get:function(){return this._dynamicMarkerRanges},set:function(t){this._dynamicMarkerRanges=t},enumerable:!0,configurable:!0}),Object.defineProperty(ue.prototype,"GridSize",{get:function(){return this._gridSize},set:function(t){this._gridSize=t},enumerable:!0,configurable:!0}),Object.defineProperty(ue.prototype,"IconInfo",{get:function(){return this._iconInfo},set:function(t){this._iconInfo=t},enumerable:!0,configurable:!0}),Object.defineProperty(ue.prototype,"LayerOffset",{get:function(){return this._layerOffset},set:function(t){this._layerOffset=t},enumerable:!0,configurable:!0}),Object.defineProperty(ue.prototype,"MinimumClusterSize",{get:function(){return this._minimumClusterSize},set:function(t){this._minimumClusterSize=t},enumerable:!0,configurable:!0}),Object.defineProperty(ue.prototype,"SpiderClusterOptions",{get:function(){return this._spiderClusterOptions},set:function(t){this._spiderClusterOptions=t},enumerable:!0,configurable:!0}),Object.defineProperty(ue.prototype,"Styles",{get:function(){return this._styles},set:function(t){this._styles=t},enumerable:!0,configurable:!0}),Object.defineProperty(ue.prototype,"UseDynamicSizeMarkers",{get:function(){return this._useDynamicSizeMarker},set:function(t){var i=this;(this._useDynamicSizeMarker=t)&&(this._iconCreationCallback=function(t,e){return ue.CreateDynamicSizeMarker(t.length,e,i._dynamicMarkerBaseSize,i._dynamicMarkerRanges)})},enumerable:!0,configurable:!0}),Object.defineProperty(ue.prototype,"ZIndex",{get:function(){return this._zIndex},set:function(t){this._zIndex=t},enumerable:!0,configurable:!0}),Object.defineProperty(ue.prototype,"ZoomOnClick",{get:function(){return this._zoomOnClick},set:function(t){this._zoomOnClick=t},enumerable:!0,configurable:!0}),ue.CreateDynamicSizeMarker=function(t,e,i,n){var o,r=i,a=.35*r,s=t,l=Math.log(s)/Math.log(10)*5+r,u=2*l;n.forEach(function(t,e){s<=e&&!o&&(o=t)});var p=["<svg xmlns='http://www.w3.org/2000/svg' width='"+u+"' height='"+u+"'>","<circle cx='"+l+"' cy='"+l+"' r='"+l+"' fill='"+(o=o||"rgba(20, 180, 20, 0.5)")+"'/>","<circle cx='"+l+"' cy='"+l+"' r='"+(l-a)+"' fill='"+o+"'/>","</svg>"];return e.size={width:u,height:u},e.markerOffsetRatio={x:.5,y:.5},e.textOffset={x:0,y:l-8},p.join("")},ue.prototype.ngOnChanges=function(t){if(this._addedToManager){if(t.ClusterClickAction)throw new Error("You cannot change the ClusterClickAction after the layer has been added to the layerservice.");var e={id:this._id};t.ClusteringEnabled&&(e.clusteringEnabled=this._clusteringEnabled),t.GridSize&&(e.gridSize=this._gridSize),t.LayerOffset&&(e.layerOffset=this._layerOffset),t.SpiderClusterOptions&&(e.spiderClusterOptions=this._spiderClusterOptions),t.ZIndex&&(e.zIndex=this._zIndex),t.Visible&&(e.visible=this._visible),this._layerService.GetNativeLayer(this).then(function(t){t.SetOptions(e)})}},ue.decorators=[{type:r.Directive,args:[{selector:"x-cluster-layer"}]}],ue.ctorParameters=function(){return[{type:Zt},{type:r.ViewContainerRef}]},ue.propDecorators={ClusterClickAction:[{type:r.Input}],ClusteringEnabled:[{type:r.Input}],ClusterPlacementMode:[{type:r.Input}],CustomMarkerCallback:[{type:r.Input}],DynamicMarkerBaseSize:[{type:r.Input}],DynamicMarkerRanges:[{type:r.Input}],GridSize:[{type:r.Input}],IconInfo:[{type:r.Input}],LayerOffset:[{type:r.Input}],MinimumClusterSize:[{type:r.Input}],SpiderClusterOptions:[{type:r.Input}],Styles:[{type:r.Input}],UseDynamicSizeMarkers:[{type:r.Input}],ZIndex:[{type:r.Input}],ZoomOnClick:[{type:r.Input}]},ue);function ue(t,e){var i=se.call(this,t,e)||this;return i._clusteringEnabled=!0,i._clusterPlacementMode=k.MeanValue,i._clusterClickAction=C.ZoomIntoCluster,i._useDynamicSizeMarker=!1,i._dynamicMarkerBaseSize=18,i._dynamicMarkerRanges=new Map([[10,"rgba(20, 180, 20, 0.5)"],[100,"rgba(255, 210, 40, 0.5)"],[Number.MAX_SAFE_INTEGER,"rgba(255, 40, 40, 0.5)"]]),i._zoomOnClick=!0,i}var pe=0,ce=(Object.defineProperty(he.prototype,"AddedToService",{get:function(){return this._addedToService},enumerable:!0,configurable:!0}),Object.defineProperty(he.prototype,"Id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(he.prototype,"IdAsString",{get:function(){return this._id.toString()},enumerable:!0,configurable:!0}),Object.defineProperty(he.prototype,"InCustomLayer",{get:function(){return this._inCustomLayer},enumerable:!0,configurable:!0}),Object.defineProperty(he.prototype,"LayerId",{get:function(){return this._layerId},enumerable:!0,configurable:!0}),he.prototype.ngAfterContentInit=function(){this._containerRef.element.nativeElement.parentElement&&"x-map-layer"===this._containerRef.element.nativeElement.parentElement.tagName.toLowerCase()&&(this._inCustomLayer=!0,this._layerId=Number(this._containerRef.element.nativeElement.parentElement.attributes.layerId)),this._addedToService||(this._polygonService.AddPolygon(this),this._addedToService=!0,this.AddEventListeners())},he.prototype.ngOnChanges=function(t){if(this._addedToService){var e=this.GeneratePolygonChangeSet(t);null!=e&&this._polygonService.SetOptions(this,e),t.Paths&&!t.Paths.isFirstChange()&&this._polygonService.UpdatePolygon(this)}},he.prototype.ngOnDestroy=function(){this._polygonService.DeletePolygon(this),this._events.forEach(function(t){return t.unsubscribe()})},he.prototype.AddEventListeners=function(){function e(t){return{Polygon:i,Click:t}}var i=this;this._events.push(this._polygonService.CreateEventObservable("click",this).subscribe(function(t){null!=i._infoBox&&i._infoBox.Open(i._polygonService.GetCoordinatesFromClick(t)),i.Click.emit(e(t))})),[{name:"dblclick",handler:function(t){return i.DblClick.emit(e(t))}},{name:"drag",handler:function(t){return i.Drag.emit(e(t))}},{name:"dragend",handler:function(t){return i.DragEnd.emit(e(t))}},{name:"dragstart",handler:function(t){return i.DragStart.emit(e(t))}},{name:"mousedown",handler:function(t){return i.MouseDown.emit(e(t))}},{name:"mousemove",handler:function(t){return i.MouseMove.emit(e(t))}},{name:"mouseout",handler:function(t){return i.MouseOut.emit(e(t))}},{name:"mouseover",handler:function(t){return i.MouseOver.emit(e(t))}},{name:"mouseup",handler:function(t){return i.MouseUp.emit(e(t))}},{name:"rightclick",handler:function(t){return i.RightClick.emit(e(t))}},{name:"pathchanged",handler:function(t){return i.PathChanged.emit(t)}}].forEach(function(t){var e=i._polygonService.CreateEventObservable(t.name,i).subscribe(t.handler);i._events.push(e)})},he.prototype.GeneratePolygonChangeSet=function(t){var e={id:this._id},i=!1;return t.Clickable&&(e.clickable=this.Clickable,i=!0),t.Draggable&&(e.draggable=this.Draggable,i=!0),t.Editable&&(e.editable=this.Editable,i=!0),(t.FillColor||t.FillOpacity)&&(e.fillColor=this.FillColor,e.fillOpacity=this.FillOpacity,i=!0),t.Geodesic&&(e.geodesic=this.Geodesic,i=!0),t.LabelMaxZoom&&(e.labelMaxZoom=this.LabelMaxZoom,i=!0),t.LabelMinZoom&&(e.labelMinZoom=this.LabelMinZoom,i=!0),t.ShowTooltip&&(e.showTooltip=this.ShowTooltip,i=!0),t.ShowLabel&&(e.showLabel=this.ShowLabel,i=!0),(t.StrokeColor||t.StrokeOpacity)&&(e.strokeColor=this.StrokeColor,e.strokeOpacity=this.StrokeOpacity,i=!0),t.StrokeWeight&&(e.strokeWeight=this.StrokeWeight,i=!0),t.Title&&(e.title=this.Title,i=!0),t.Visible&&(e.visible=this.Visible,i=!0),t.zIndex&&(e.zIndex=this.zIndex,i=!0),i?e:null},he.decorators=[{type:r.Directive,args:[{selector:"x-map-polygon"}]}],he.ctorParameters=function(){return[{type:zt},{type:r.ViewContainerRef}]},he.propDecorators={_infoBox:[{type:r.ContentChild,args:[Ft]}],Clickable:[{type:r.Input}],Draggable:[{type:r.Input}],Editable:[{type:r.Input}],FillColor:[{type:r.Input}],FillOpacity:[{type:r.Input}],Geodesic:[{type:r.Input}],LabelMaxZoom:[{type:r.Input}],LabelMinZoom:[{type:r.Input}],Metadata:[{type:r.Input}],Paths:[{type:r.Input}],ShowLabel:[{type:r.Input}],ShowTooltip:[{type:r.Input}],StrokeColor:[{type:r.Input}],StrokeOpacity:[{type:r.Input}],StrokeWeight:[{type:r.Input}],Title:[{type:r.Input}],Visible:[{type:r.Input}],zIndex:[{type:r.Input}],Click:[{type:r.Output}],DblClick:[{type:r.Output}],Drag:[{type:r.Output}],DragEnd:[{type:r.Output}],DragStart:[{type:r.Output}],MouseDown:[{type:r.Output}],MouseMove:[{type:r.Output}],MouseOut:[{type:r.Output}],MouseOver:[{type:r.Output}],MouseUp:[{type:r.Output}],RightClick:[{type:r.Output}],PathChanged:[{type:r.Output}]},he);function he(t,e){this._polygonService=t,this._containerRef=e,this._inCustomLayer=!1,this._addedToService=!1,this._events=[],this.Clickable=!0,this.Draggable=!1,this.Editable=!1,this.Geodesic=!1,this.Metadata=new Map,this.Paths=[],this.ShowTooltip=!0,this.Click=new r.EventEmitter,this.DblClick=new r.EventEmitter,this.Drag=new r.EventEmitter,this.DragEnd=new r.EventEmitter,this.DragStart=new r.EventEmitter,this.MouseDown=new r.EventEmitter,this.MouseMove=new r.EventEmitter,this.MouseOut=new r.EventEmitter,this.MouseOver=new r.EventEmitter,this.MouseUp=new r.EventEmitter,this.RightClick=new r.EventEmitter,this.PathChanged=new r.EventEmitter,this._id=pe++}var fe=0,de=(Object.defineProperty(ye.prototype,"AddedToService",{get:function(){return this._addedToService},enumerable:!0,configurable:!0}),Object.defineProperty(ye.prototype,"Id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(ye.prototype,"IdAsString",{get:function(){return this._id.toString()},enumerable:!0,configurable:!0}),Object.defineProperty(ye.prototype,"InCustomLayer",{get:function(){return this._inCustomLayer},enumerable:!0,configurable:!0}),Object.defineProperty(ye.prototype,"LayerId",{get:function(){return this._layerId},enumerable:!0,configurable:!0}),ye.prototype.ngAfterContentInit=function(){this._containerRef.element.nativeElement.parentElement&&"x-map-layer"===this._containerRef.element.nativeElement.parentElement.tagName.toLowerCase()&&(this._inCustomLayer=!0,this._layerId=Number(this._containerRef.element.nativeElement.parentElement.attributes.layerId)),this._addedToService||(this._polylineService.AddPolyline(this),this._addedToService=!0,this.AddEventListeners())},ye.prototype.ngOnChanges=function(t){if(this._addedToService){var e=this.GeneratePolylineChangeSet(t);null!=e&&this._polylineService.SetOptions(this,e),t.Path&&!t.Path.isFirstChange()&&this._polylineService.UpdatePolyline(this)}},ye.prototype.ngOnDestroy=function(){this._polylineService.DeletePolyline(this),this._events.forEach(function(t){return t.unsubscribe()})},ye.prototype.AddEventListeners=function(){function e(t){return{Polyline:i,Click:t}}var i=this;this._polylineService.CreateEventObservable("click",this).subscribe(function(t){null!=i._infoBox&&i._infoBox.Open(i._polylineService.GetCoordinatesFromClick(t)),i.Click.emit(e(t))}),[{name:"dblclick",handler:function(t){return i.DblClick.emit(e(t))}},{name:"drag",handler:function(t){return i.Drag.emit(e(t))}},{name:"dragend",handler:function(t){return i.DragEnd.emit(e(t))}},{name:"dragstart",handler:function(t){return i.DragStart.emit(e(t))}},{name:"mousedown",handler:function(t){return i.MouseDown.emit(e(t))}},{name:"mousemove",handler:function(t){return i.MouseMove.emit(e(t))}},{name:"mouseout",handler:function(t){return i.MouseOut.emit(e(t))}},{name:"mouseover",handler:function(t){return i.MouseOver.emit(e(t))}},{name:"mouseup",handler:function(t){return i.MouseUp.emit(e(t))}},{name:"rightclick",handler:function(t){return i.RightClick.emit(e(t))}}].forEach(function(t){var e=i._polylineService.CreateEventObservable(t.name,i).subscribe(t.handler);i._events.push(e)})},ye.prototype.GeneratePolylineChangeSet=function(t){var e={id:this._id},i=!1;return t.Clickable&&(e.clickable=this.Clickable,i=!0),t.Draggable&&(e.draggable=this.Draggable,i=!0),t.Editable&&(e.editable=this.Editable,i=!0),t.Geodesic&&(e.geodesic=this.Geodesic,i=!0),t.ShowTooltip&&(e.showTooltip=this.ShowTooltip,i=!0),t.StrokeColor&&(e.strokeColor=this.StrokeColor,i=!0),t.StrokeOpacity&&(e.strokeOpacity=this.StrokeOpacity,i=!0),t.StrokeWeight&&(e.strokeWeight=this.StrokeWeight,i=!0),t.Title&&(e.title=this.Title,i=!0),t.Visible&&(e.visible=this.Visible,i=!0),t.zIndex&&(e.zIndex=this.zIndex,i=!0),i?e:null},ye.decorators=[{type:r.Directive,args:[{selector:"x-map-polyline"}]}],ye.ctorParameters=function(){return[{type:Gt},{type:r.ViewContainerRef}]},ye.propDecorators={_infoBox:[{type:r.ContentChild,args:[Ft]}],Clickable:[{type:r.Input}],Draggable:[{type:r.Input}],Editable:[{type:r.Input}],Geodesic:[{type:r.Input}],Metadata:[{type:r.Input}],Path:[{type:r.Input}],ShowTooltip:[{type:r.Input}],StrokeColor:[{type:r.Input}],StrokeOpacity:[{type:r.Input}],StrokeWeight:[{type:r.Input}],Title:[{type:r.Input}],Visible:[{type:r.Input}],zIndex:[{type:r.Input}],Click:[{type:r.Output}],DblClick:[{type:r.Output}],Drag:[{type:r.Output}],DragEnd:[{type:r.Output}],DragStart:[{type:r.Output}],MouseDown:[{type:r.Output}],MouseMove:[{type:r.Output}],MouseOut:[{type:r.Output}],MouseOver:[{type:r.Output}],MouseUp:[{type:r.Output}],RightClick:[{type:r.Output}]},ye);function ye(t,e){this._polylineService=t,this._containerRef=e,this._inCustomLayer=!1,this._addedToService=!1,this._events=[],this.Clickable=!0,this.Draggable=!1,this.Editable=!1,this.Geodesic=!1,this.Metadata=new Map,this.Path=[],this.ShowTooltip=!0,this.Click=new r.EventEmitter,this.DblClick=new r.EventEmitter,this.Drag=new r.EventEmitter,this.DragEnd=new r.EventEmitter,this.DragStart=new r.EventEmitter,this.MouseDown=new r.EventEmitter,this.MouseMove=new r.EventEmitter,this.MouseOut=new r.EventEmitter,this.MouseOver=new r.EventEmitter,this.MouseUp=new r.EventEmitter,this.RightClick=new r.EventEmitter,this._id=fe++}var me=1e6,ge=(Object.defineProperty(ve.prototype,"CustomMarkerCallback",{get:function(){return this._iconCreationCallback},set:function(t){if(this._useDynamicSizeMarker)throw new Error("You cannot set a custom marker callback when UseDynamicSizeMarkers is set to true.\n                    Set UseDynamicSizeMakers to false.");this._iconCreationCallback=t},enumerable:!0,configurable:!0}),Object.defineProperty(ve.prototype,"DynamicMarkerBaseSize",{get:function(){return this._dynamicMarkerBaseSize},set:function(t){this._dynamicMarkerBaseSize=t},enumerable:!0,configurable:!0}),Object.defineProperty(ve.prototype,"DynamicMarkerRanges",{get:function(){return this._dynamicMarkerRanges},set:function(t){this._dynamicMarkerRanges=t},enumerable:!0,configurable:!0}),Object.defineProperty(ve.prototype,"MarkerOptions",{get:function(){return this._markers},set:function(t){var e,i;this._streaming?((e=this._markersLast).push.apply(e,v(t.slice(0))),(i=this._markers).push.apply(i,v(t))):this._markers=t.slice(0)},enumerable:!0,configurable:!0}),Object.defineProperty(ve.prototype,"Styles",{get:function(){return this._styles},set:function(t){this._styles=t},enumerable:!0,configurable:!0}),Object.defineProperty(ve.prototype,"TreatNewMarkerOptionsAsStream",{get:function(){return this._streaming},set:function(t){this._streaming=t},enumerable:!0,configurable:!0}),Object.defineProperty(ve.prototype,"UseDynamicSizeMarkers",{get:function(){return this._useDynamicSizeMarker},set:function(t){var i=this;(this._useDynamicSizeMarker=t)&&(this._iconCreationCallback=function(t,e){return le.CreateDynamicSizeMarker(t.length,e,i._dynamicMarkerBaseSize,i._dynamicMarkerRanges)})},enumerable:!0,configurable:!0}),Object.defineProperty(ve.prototype,"Id",{get:function(){return this._id},enumerable:!0,configurable:!0}),ve.prototype.LocationToPixel=function(t){return this._markerService.LocationToPoint(t)},ve.prototype.ngAfterContentInit=function(){var e=this;this._id,this._zone.runOutsideAngular(function(){var t={Id:e._id,Visible:e.Visible};e.EnableClustering?(t.LayerOffset=e.LayerOffset,t.ZIndex=e.ZIndex,t.ClusteringEnabled=e.EnableClustering,t.ClusterPlacementMode=e.ClusterPlacementMode,t.GridSize=e.GridSize,t.ClusterClickAction=e.ClusterClickAction,t.IconInfo=e.ClusterIconInfo,t.CustomMarkerCallback=e.CustomMarkerCallback,t.UseDynamicSizeMarkers=e.UseDynamicSizeMarkers,e._clusterService.AddLayer(t),e._layerPromise=e._clusterService.GetNativeLayer(t),e._service=e._clusterService):(e._layerService.AddLayer(t),e._layerPromise=e._layerService.GetNativeLayer(t),e._service=e._layerService),e._layerPromise.then(function(t){t.SetVisible(e.Visible),e.MarkerOptions&&e._zone.runOutsideAngular(function(){return e.UpdateMarkers()})})})},ve.prototype.ngOnDestroy=function(){this._layerPromise.then(function(t){t.Delete()})},ve.prototype.ngOnChanges=function(t){var e=this,i=!1,n={id:this._id};if(t.MarkerOptions&&this._zone.runOutsideAngular(function(){e.UpdateMarkers()}),t.Visible&&!t.Visible.firstChange&&this._zone.runOutsideAngular(function(){e._layerPromise.then(function(t){return t.SetVisible(e.Visible)})}),t.EnableClustering&&!t.EnableClustering.firstChange){if(!("StopClustering"in this._service))throw new Error("You cannot change EnableClustering after the layer has been created.");n.clusteringEnabled=this.EnableClustering,i=!0}if(t.ClusterPlacementMode&&!t.ClusterPlacementMode.firstChange&&"StopClustering"in this._service&&(n.placementMode=this.ClusterPlacementMode,i=!0),t.GridSize&&!t.GridSize.firstChange&&"StopClustering"in this._service&&(n.gridSize=this.GridSize,i=!0),t.ClusterClickAction&&!t.ClusterClickAction.firstChange&&"StopClustering"in this._service&&(n.zoomOnClick=this.ClusterClickAction===C.ZoomIntoCluster,i=!0),t.ZIndex&&!t.ZIndex.firstChange||t.LayerOffset&&!t.LayerOffset.firstChange||t.IconInfo&&!t.IconInfo.firstChange)throw new Error("You cannot change ZIndex or LayerOffset after the layer has been created.");i&&this._zone.runOutsideAngular(function(){e._id,e._layerPromise.then(function(t){return t.SetOptions(n)})})},ve.prototype.toString=function(){return"MapMarkerLayer-"+this._id.toString()},ve.prototype.AddEventListeners=function(e){var i=this;e.AddListener("click",function(t){return i.MarkerClick.emit({Marker:e,Click:t,Location:i._markerService.GetCoordinatesFromClick(t),Pixels:i._markerService.GetPixelsFromClick(t)})}),e.AddListener("dragend",function(t){return i.DragEnd.emit({Marker:e,Click:t,Location:i._markerService.GetCoordinatesFromClick(t),Pixels:i._markerService.GetPixelsFromClick(t)})})},ve.prototype.UpdateMarkers=function(){var i=this;null!=this._layerPromise&&this._layerPromise.then(function(e){var t=i._streaming?i._markersLast.splice(0):i._markers;i._service.CreateMarkers(t,i.IconInfo).then(function(t){t.forEach(function(t){i.AddEventListeners(t)}),i._streaming?e.AddEntities(t):e.SetEntities(t)})})},ve.decorators=[{type:r.Directive,args:[{selector:"x-map-marker-layer"}]}],ve.ctorParameters=function(){return[{type:Lt},{type:xt},{type:Zt},{type:Pt},{type:r.NgZone}]},ve.propDecorators={ClusterClickAction:[{type:r.Input}],ClusterIconInfo:[{type:r.Input}],ClusterPlacementMode:[{type:r.Input}],CustomMarkerCallback:[{type:r.Input}],DynamicMarkerBaseSize:[{type:r.Input}],DynamicMarkerRanges:[{type:r.Input}],EnableClustering:[{type:r.Input}],GridSize:[{type:r.Input}],IconInfo:[{type:r.Input}],LayerOffset:[{type:r.Input}],MarkerOptions:[{type:r.Input}],Styles:[{type:r.Input}],TreatNewMarkerOptionsAsStream:[{type:r.Input}],UseDynamicSizeMarkers:[{type:r.Input}],Visible:[{type:r.Input}],ZIndex:[{type:r.Input}],ZoomOnClick:[{type:r.Input}],DynamicMarkerCreated:[{type:r.Output}],MarkerClick:[{type:r.Output}],DragEnd:[{type:r.Output}]},ve);function ve(t,e,i,n,o){this._markerService=t,this._layerService=e,this._clusterService=i,this._mapService=n,this._zone=o,this._useDynamicSizeMarker=!1,this._dynamicMarkerBaseSize=18,this._dynamicMarkerRanges=new Map([[10,"rgba(20, 180, 20, 0.5)"],[100,"rgba(255, 210, 40, 0.5)"],[Number.MAX_SAFE_INTEGER,"rgba(255, 40, 40, 0.5)"]]),this._streaming=!1,this._markers=new Array,this._markersLast=new Array,this.ClusterClickAction=C.ZoomIntoCluster,this.ClusterPlacementMode=k.MeanValue,this.EnableClustering=!1,this.GridSize=150,this.LayerOffset=null,this.ZIndex=0,this.ZoomOnClick=!0,this.DynamicMarkerCreated=new r.EventEmitter,this.MarkerClick=new r.EventEmitter,this.DragEnd=new r.EventEmitter,this._id=me++}var _e=1e6,be=(Object.defineProperty(Me.prototype,"PolygonOptions",{get:function(){return this._polygons},set:function(t){var e,i;this._streaming?((e=this._polygonsLast).push.apply(e,v(t.slice(0))),(i=this._polygons).push.apply(i,v(t))):this._polygons=t.slice(0)},enumerable:!0,configurable:!0}),Object.defineProperty(Me.prototype,"TreatNewPolygonOptionsAsStream",{get:function(){return this._streaming},set:function(t){this._streaming=t},enumerable:!0,configurable:!0}),Object.defineProperty(Me.prototype,"Id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Me.prototype.ngAfterContentInit=function(){var e=this;this._id,this._zone.runOutsideAngular(function(){var t={Id:e._id,Visible:e.Visible,LayerOffset:e.LayerOffset,ZIndex:e.ZIndex};e._layerService.AddLayer(t),e._layerPromise=e._layerService.GetNativeLayer(t),Promise.all([e._layerPromise,e._mapService.CreateCanvasOverlay(function(t){return e.DrawLabels(t)})]).then(function(t){t[0].SetVisible(e.Visible),e._canvas=t[1],e._canvas._canvasReady.then(function(t){e._tooltip=e._canvas.GetToolTipOverlay(),e.ManageTooltip(e.ShowTooltips)}),e.PolygonOptions&&e._zone.runOutsideAngular(function(){return e.UpdatePolygons()})}),e._service=e._layerService})},Me.prototype.ngOnDestroy=function(){this._tooltipSubscriptions.forEach(function(t){return t.unsubscribe()}),this._layerPromise.then(function(t){t.Delete()}),this._canvas&&this._canvas.Delete()},Me.prototype.ngOnChanges=function(t){var e=this;if(t.PolygonOptions&&this._zone.runOutsideAngular(function(){e.UpdatePolygons()}),t.Visible&&!t.Visible.firstChange&&this._layerPromise.then(function(t){return t.SetVisible(e.Visible)}),t.ZIndex&&!t.ZIndex.firstChange||t.LayerOffset&&!t.LayerOffset.firstChange)throw new Error("You cannot change ZIndex or LayerOffset after the layer has been created.");(t.ShowLabels&&!t.ShowLabels.firstChange||t.LabelMinZoom&&!t.LabelMinZoom.firstChange||t.LabelMaxZoom&&!t.LabelMaxZoom.firstChange)&&this._canvas&&this._canvas.Redraw(!0),t.ShowTooltips&&this._tooltip&&this.ManageTooltip(t.ShowTooltips.currentValue)},Me.prototype.toString=function(){return"MapPolygonLayer-"+this._id.toString()},Me.prototype.AddEventListeners=function(e){var i=this;[{name:"click",handler:function(t){return i.PolygonClick.emit({Polygon:e,Click:t})}},{name:"dblclick",handler:function(t){return i.PolygonDblClick.emit({Polygon:e,Click:t})}},{name:"mousemove",handler:function(t){return i.PolygonMouseMove.emit({Polygon:e,Click:t})}},{name:"mouseout",handler:function(t){return i.PolygonMouseOut.emit({Polygon:e,Click:t})}},{name:"mouseover",handler:function(t){return i.PolygonMouseOver.emit({Polygon:e,Click:t})}}].forEach(function(t){return e.AddListener(t.name,t.handler)})},Me.prototype.DrawLabels=function(e){var a=this;this.ShowLabels&&this._mapService.GetZoom().then(function(t){if(a.LabelMinZoom<=t&&a.LabelMaxZoom>=t){var o=e.getContext("2d"),r=a._labels.map(function(t){return t.title});a._mapService.LocationsToPoints(a._labels.map(function(t){return t.loc})).then(function(t){for(var e=a._mapService.MapSize,i=0,n=t.length;i<n;i++)0<=t[i].x&&0<=t[i].y&&t[i].x<=e.width&&t[i].y<=e.height&&a.DrawText(o,t[i],r[i])})}})},Me.prototype.DrawText=function(t,e,i){var n=this.LabelOptions;null==n&&this._tooltip&&(n=this._tooltip.DefaultLabelStyle),null==n&&(n=this._defaultOptions),t.strokeStyle=n.strokeColor,t.font=n.fontSize+"px "+n.fontFamily,t.textAlign="center";var o=n.strokeWeight;i&&o&&0<o&&(t.lineWidth=o,t.strokeText(i,e.x,e.y)),t.fillStyle=n.fontColor,t.fillText(i,e.x,e.y)},Me.prototype.ManageTooltip=function(t){var i=this;t&&this._canvas?(this._tooltip.Set("hidden",!0),this._tooltipVisible=!1,this._tooltipSubscriptions.push(this.PolygonMouseMove.asObservable().subscribe(function(t){if(i._tooltipVisible){var e=i._canvas.GetCoordinatesFromClick(t.Click);i._tooltip.Set("position",e)}})),this._tooltipSubscriptions.push(this.PolygonMouseOver.asObservable().subscribe(function(t){if(t.Polygon.Title&&0<t.Polygon.Title.length){var e=i._canvas.GetCoordinatesFromClick(t.Click);i._tooltip.Set("text",t.Polygon.Title),i._tooltip.Set("position",e),i._tooltipVisible||(i._tooltip.Set("hidden",!1),i._tooltipVisible=!0)}})),this._tooltipSubscriptions.push(this.PolygonMouseOut.asObservable().subscribe(function(t){i._tooltipVisible&&(i._tooltip.Set("hidden",!0),i._tooltipVisible=!1)}))):(this._tooltipSubscriptions.forEach(function(t){return t.unsubscribe()}),this._tooltipSubscriptions.splice(0),this._tooltip.Set("hidden",!0),this._tooltipVisible=!1)},Me.prototype.UpdatePolygons=function(){var i=this;null!=this._layerPromise&&this._layerPromise.then(function(e){var t=i._streaming?i._polygonsLast.splice(0):i._polygons;i._streaming||i._labels.splice(0),i._service.CreatePolygons(e.GetOptions().id,t).then(function(t){t.forEach(function(t){null!=t.Title&&0<t.Title.length&&i._labels.push({loc:t.Centroid,title:t.Title}),i.AddEventListeners(t)}),i._streaming?e.AddEntities(t):e.SetEntities(t),i._canvas&&i._canvas.Redraw(!i._streaming)})})},Me.decorators=[{type:r.Directive,args:[{selector:"x-map-polygon-layer"}]}],Me.ctorParameters=function(){return[{type:xt},{type:Pt},{type:r.NgZone}]},Me.propDecorators={LabelMaxZoom:[{type:r.Input}],LabelMinZoom:[{type:r.Input}],LabelOptions:[{type:r.Input}],LayerOffset:[{type:r.Input}],PolygonOptions:[{type:r.Input}],ShowLabels:[{type:r.Input}],ShowTooltips:[{type:r.Input}],TreatNewPolygonOptionsAsStream:[{type:r.Input}],Visible:[{type:r.Input}],ZIndex:[{type:r.Input}],PolygonClick:[{type:r.Output}],PolygonDblClick:[{type:r.Output}],PolygonMouseMove:[{type:r.Output}],PolygonMouseOut:[{type:r.Output}],PolygonMouseOver:[{type:r.Output}]},Me);function Me(t,e,i){this._layerService=t,this._mapService=e,this._zone=i,this._labels=new Array,this._tooltipSubscriptions=new Array,this._tooltipVisible=!1,this._defaultOptions={fontSize:11,fontFamily:"sans-serif",strokeWeight:2,strokeColor:"#000000",fontColor:"#ffffff"},this._streaming=!1,this._polygons=new Array,this._polygonsLast=new Array,this.LabelMaxZoom=Number.MAX_SAFE_INTEGER,this.LabelMinZoom=-1,this.LayerOffset=null,this.ShowLabels=!1,this.ShowTooltips=!0,this.ZIndex=0,this.PolygonClick=new r.EventEmitter,this.PolygonDblClick=new r.EventEmitter,this.PolygonMouseMove=new r.EventEmitter,this.PolygonMouseOut=new r.EventEmitter,this.PolygonMouseOver=new r.EventEmitter,this._id=_e++}var ke=1e6,Ce=(Object.defineProperty(Se.prototype,"PolylineOptions",{get:function(){return this._polylines},set:function(t){var e,i;this._streaming?((e=this._polylinesLast).push.apply(e,v(t.slice(0))),(i=this._polylines).push.apply(i,v(t))):this._polylines=t.slice(0)},enumerable:!0,configurable:!0}),Object.defineProperty(Se.prototype,"TreatNewPolylineOptionsAsStream",{get:function(){return this._streaming},set:function(t){this._streaming=t},enumerable:!0,configurable:!0}),Object.defineProperty(Se.prototype,"Id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Se.prototype.ngAfterContentInit=function(){var e=this;this._id,this._zone.runOutsideAngular(function(){var t={Id:e._id,Visible:e.Visible,LayerOffset:e.LayerOffset,ZIndex:e.ZIndex};e._layerService.AddLayer(t),e._layerPromise=e._layerService.GetNativeLayer(t),Promise.all([e._layerPromise,e._mapService.CreateCanvasOverlay(function(t){return e.DrawLabels(t)})]).then(function(t){t[0].SetVisible(e.Visible),e._canvas=t[1],e._canvas._canvasReady.then(function(t){e._tooltip=e._canvas.GetToolTipOverlay(),e.ManageTooltip(e.ShowTooltips)}),e.PolylineOptions&&e._zone.runOutsideAngular(function(){return e.UpdatePolylines()})}),e._service=e._layerService})},Se.prototype.ngOnDestroy=function(){this._tooltipSubscriptions.forEach(function(t){return t.unsubscribe()}),this._layerPromise.then(function(t){t.Delete()}),this._canvas&&this._canvas.Delete()},Se.prototype.ngOnChanges=function(t){var e=this;if(t.PolylineOptions&&this._zone.runOutsideAngular(function(){e.UpdatePolylines()}),t.Visible&&!t.Visible.firstChange&&this._layerPromise.then(function(t){return t.SetVisible(e.Visible)}),t.ZIndex&&!t.ZIndex.firstChange||t.LayerOffset&&!t.LayerOffset.firstChange)throw new Error("You cannot change ZIndex or LayerOffset after the layer has been created.");(t.ShowLabels&&!t.ShowLabels.firstChange||t.LabelMinZoom&&!t.LabelMinZoom.firstChange||t.LabelMaxZoom&&!t.LabelMaxZoom.firstChange)&&this._canvas&&this._canvas.Redraw(!0),t.ShowTooltips&&this._tooltip&&this.ManageTooltip(t.ShowTooltips.currentValue)},Se.prototype.toString=function(){return"MapPolylineLayer-"+this._id.toString()},Se.prototype.AddEventListeners=function(e){var i=this;[{name:"click",handler:function(t){return i.PolylineClick.emit({Polyline:e,Click:t})}},{name:"dblclick",handler:function(t){return i.PolylineDblClick.emit({Polyline:e,Click:t})}},{name:"mousemove",handler:function(t){return i.PolylineMouseMove.emit({Polyline:e,Click:t})}},{name:"mouseout",handler:function(t){return i.PolylineMouseOut.emit({Polyline:e,Click:t})}},{name:"mouseover",handler:function(t){return i.PolylineMouseOver.emit({Polyline:e,Click:t})}}].forEach(function(t){return e.AddListener(t.name,t.handler)})},Se.prototype.DrawLabels=function(e){var a=this;this.ShowLabels&&this._mapService.GetZoom().then(function(t){if(a.LabelMinZoom<=t&&a.LabelMaxZoom>=t){var o=e.getContext("2d"),r=a._labels.map(function(t){return t.title});a._mapService.LocationsToPoints(a._labels.map(function(t){return t.loc})).then(function(t){for(var e=a._mapService.MapSize,i=0,n=t.length;i<n;i++)0<=t[i].x&&0<=t[i].y&&t[i].x<=e.width&&t[i].y<=e.height&&a.DrawText(o,t[i],r[i])})}})},Se.prototype.DrawText=function(t,e,i){var n=this.LabelOptions;null==n&&this._tooltip&&(n=this._tooltip.DefaultLabelStyle),null==n&&(n=this._defaultOptions),t.strokeStyle=n.strokeColor,t.font=n.fontSize+"px "+n.fontFamily,t.textAlign="center";var o=n.strokeWeight;i&&o&&0<o&&(t.lineWidth=o,t.strokeText(i,e.x,e.y)),t.fillStyle=n.fontColor,t.fillText(i,e.x,e.y)},Se.prototype.ManageTooltip=function(t){var i=this;t&&this._canvas?(this._tooltip.Set("hidden",!0),this._tooltipVisible=!1,this._tooltipSubscriptions.push(this.PolylineMouseMove.asObservable().subscribe(function(t){if(i._tooltipVisible){var e=i._canvas.GetCoordinatesFromClick(t.Click);i._tooltip.Set("position",e)}})),this._tooltipSubscriptions.push(this.PolylineMouseOver.asObservable().subscribe(function(t){if(t.Polyline.Title&&0<t.Polyline.Title.length){var e=i._canvas.GetCoordinatesFromClick(t.Click);i._tooltip.Set("text",t.Polyline.Title),i._tooltip.Set("position",e),i._tooltipVisible||(i._tooltip.Set("hidden",!1),i._tooltipVisible=!0)}})),this._tooltipSubscriptions.push(this.PolylineMouseOut.asObservable().subscribe(function(t){i._tooltipVisible&&(i._tooltip.Set("hidden",!0),i._tooltipVisible=!1)}))):(this._tooltipSubscriptions.forEach(function(t){return t.unsubscribe()}),this._tooltipSubscriptions.splice(0),this._tooltip.Set("hidden",!0),this._tooltipVisible=!1)},Se.prototype.UpdatePolylines=function(){var o=this;null!=this._layerPromise&&this._layerPromise.then(function(e){var t=o._streaming?o._polylinesLast.splice(0):o._polylines;o._streaming||o._labels.splice(0),o._service.CreatePolylines(e.GetOptions().id,t).then(function(t){var n=new Array;t.forEach(function(t){if(Array.isArray(t)){var e="",i=new Array;t.forEach(function(t){n.push(t),o.AddEventListeners(t),i.push(t.Centroid),null!=t.Title&&0<t.Title.length&&0===e.length&&(e=t.Title)}),o._labels.push({loc:f.GetPolylineCentroid(i),title:e})}else n.push(t),null!=t.Title&&0<t.Title.length&&o._labels.push({loc:t.Centroid,title:t.Title}),o.AddEventListeners(t)}),o._streaming?e.AddEntities(n):e.SetEntities(n),o._canvas&&o._canvas.Redraw(!o._streaming)})})},Se.decorators=[{type:r.Directive,args:[{selector:"x-map-polyline-layer"}]}],Se.ctorParameters=function(){return[{type:xt},{type:Pt},{type:r.NgZone}]},Se.propDecorators={LabelMaxZoom:[{type:r.Input}],LabelMinZoom:[{type:r.Input}],LabelOptions:[{type:r.Input}],LayerOffset:[{type:r.Input}],PolylineOptions:[{type:r.Input}],ShowLabels:[{type:r.Input}],ShowTooltips:[{type:r.Input}],TreatNewPolylineOptionsAsStream:[{type:r.Input}],Visible:[{type:r.Input}],ZIndex:[{type:r.Input}],PolylineClick:[{type:r.Output}],PolylineDblClick:[{type:r.Output}],PolylineMouseMove:[{type:r.Output}],PolylineMouseOut:[{type:r.Output}],PolylineMouseOver:[{type:r.Output}]},Se);function Se(t,e,i){this._layerService=t,this._mapService=e,this._zone=i,this._labels=new Array,this._tooltipSubscriptions=new Array,this._tooltipVisible=!1,this._defaultOptions={fontSize:11,fontFamily:"sans-serif",strokeWeight:2,strokeColor:"#000000",fontColor:"#ffffff"},this._streaming=!1,this._polylines=new Array,this._polylinesLast=new Array,this.LabelMaxZoom=Number.MAX_SAFE_INTEGER,this.LabelMinZoom=-1,this.LayerOffset=null,this.ShowLabels=!1,this.ShowTooltips=!0,this.ZIndex=0,this.PolylineClick=new r.EventEmitter,this.PolylineDblClick=new r.EventEmitter,this.PolylineMouseMove=new r.EventEmitter,this.PolylineMouseOut=new r.EventEmitter,this.PolylineMouseOver=new r.EventEmitter,this._id=ke++}var Oe=(Pe.decorators=[{type:r.Injectable}],Pe);function Pe(){}var we=(Object.defineProperty(Le.prototype,"IsAvailable",{get:function(){return!("undefined"==typeof document)},enumerable:!0,configurable:!0}),Le.prototype.GetNativeDocument=function(){return"undefined"==typeof document?null:document},Le.decorators=[{type:r.Injectable}],Le);function Le(){}var Ie=(Object.defineProperty(Ee.prototype,"IsAvailable",{get:function(){return!("undefined"==typeof window)},enumerable:!0,configurable:!0}),Ee.prototype.GetNativeWindow=function(){return"undefined"==typeof window?null:window},Ee.decorators=[{type:r.Injectable}],Ee);function Ee(){}var Te={HTTP:0,HTTPS:1,AUTO:2};Te[Te.HTTP]="HTTP",Te[Te.HTTPS]="HTTPS",Te[Te.AUTO]="AUTO";var xe=(Ae.decorators=[{type:r.Injectable}],Ae);function Ae(){this.apiKey="",this.hostAndPath="www.bing.com/api/maps/mapcontrol",this.protocol=Te.HTTPS,this.branch=""}var ze,De=new xe,Ge=(m(je,ze=Oe),Object.defineProperty(je.prototype,"Config",{get:function(){return this._config},enumerable:!0,configurable:!0}),je.prototype.Load=function(){var i=this;if(this._scriptLoadingPromise)return this._scriptLoadingPromise;var n=this._documentRef.GetNativeDocument().createElement("script");n.type="text/javascript",n.async=!0,n.defer=!0;var o="angular2bingmaps"+(new Date).getMilliseconds();return n.src=this.GetScriptSrc(o),this._scriptLoadingPromise=new Promise(function(t,e){i._windowRef.GetNativeWindow()[o]=function(){t()},n.onerror=function(t){e(t)}}),this._documentRef.GetNativeDocument().head.appendChild(n),this._scriptLoadingPromise},je.prototype.GetScriptSrc=function(t){var e;switch(this._config&&this._config.protocol||De.protocol){case Te.AUTO:e="";break;case Te.HTTP:e="http:";break;case Te.HTTPS:e="https:"}var i=this._config.hostAndPath||De.hostAndPath,n={callback:t};return""!==this._config.branch&&(n.branch=this._config.branch),e+"//"+i+Object.keys(n).map(function(t,e){return(0===e?"?":"&")+t+"="+n[t]}).join("")},je.decorators=[{type:r.Injectable}],je.ctorParameters=function(){return[{type:xe,decorators:[{type:r.Optional}]},{type:Ie},{type:we}]},je);function je(t,e,i){var n=ze.call(this)||this;return n._config=t,n._windowRef=e,n._documentRef=i,null!==n._config&&n._config!==undefined||(n._config=De),n}var Ne=(Ze.prototype.AddInfoWindow=function(t){var e={};"number"==typeof t.Latitude&&"number"==typeof t.Longitude&&(e.position={latitude:t.Latitude,longitude:t.Longitude}),"undefined"!=typeof t.InfoWindowActions&&0<t.InfoWindowActions.length&&(e.actions=[],t.InfoWindowActions.forEach(function(t){e.actions.push({label:t.Label,eventHandler:function(){t.ActionClicked.emit(null)}})})),""!==t.HtmlContent?e.htmlContent=t.HtmlContent:(e.title=t.Title,e.description=t.Description),(t.xOffset||t.yOffset)&&(null==e.pixelOffset&&(e.pixelOffset={x:0,y:0}),t.xOffset&&(e.pixelOffset.x=t.xOffset),t.yOffset&&(e.pixelOffset.y=t.yOffset)),e.visible=t.Visible;var i=this._mapService.CreateInfoWindow(e);this._boxes.set(t,i)},Ze.prototype.Close=function(t){return this._boxes.get(t).then(function(t){return t.Close()})},Ze.prototype.CreateEventObservable=function(t,i){var n=this,o=et[t];return a.Observable.create(function(e){n._boxes.get(i).then(function(t){t.AddListener(o,function(t){return n._zone.run(function(){return e.next(t)})})})})},Ze.prototype.DeleteInfoWindow=function(e){var i=this,t=this._boxes.get(e);return null==t?Promise.resolve():t.then(function(t){return i._zone.run(function(){t.Close(),i._boxes["delete"](e)})})},Ze.prototype.Open=function(i,n){return(i.CloseInfoBoxesOnOpen||i.Modal)&&this._boxes.forEach(function(t,e){i.Id!==e.Id&&t.then(function(t){t.IsOpen&&(t.Close(),e.Close())})}),this._boxes.get(i).then(function(t){var e={};""!==i.HtmlContent?e.htmlContent=i.HtmlContent:(e.title=i.Title,e.description=i.Description),t.SetOptions(e),i.Latitude&&i.Longitude?t.SetPosition({latitude:i.Latitude,longitude:i.Longitude}):n?t.SetPosition(n):i.HostMarker&&t.SetPosition({latitude:i.HostMarker.Latitude,longitude:i.HostMarker.Longitude}),t.Open()})},Ze.prototype.SetOptions=function(t,e){return this._boxes.get(t).then(function(t){return t.SetOptions(e)})},Ze.prototype.SetPosition=function(e){return this._boxes.get(e).then(function(t){return t.SetPosition({latitude:e.Latitude,longitude:e.Longitude})})},Ze.decorators=[{type:r.Injectable}],Ze.ctorParameters=function(){return[{type:Pt},{type:r.NgZone}]},Ze);function Ze(t,e){this._mapService=t,this._zone=e,this._boxes=new Map}var Ve=(Re.prototype.AddMarker=function(i){var n={position:{latitude:i.Latitude,longitude:i.Longitude},title:i.Title,label:i.Label,draggable:i.Draggable,icon:i.IconUrl,iconInfo:i.IconInfo,isFirst:i.IsFirstInSet,isLast:i.IsLastInSet};i.Width&&(n.width=i.Width),i.Height&&(n.height=i.Height),i.Anchor&&(n.anchor=i.Anchor),i.Metadata&&(n.metadata=i.Metadata);var t=null;t=i.InClusterLayer?this._clusterService.CreateMarker(i.LayerId,n):i.InCustomLayer?this._layerService.CreateMarker(i.LayerId,n):this._mapService.CreateMarker(n),this._markers.set(i,t),i.IconInfo&&t.then(function(t){i.DynamicMarkerCreated.emit(n.iconInfo);var e={x:n.iconInfo.size&&n.iconInfo.markerOffsetRatio?n.iconInfo.size.width*n.iconInfo.markerOffsetRatio.x:0,y:n.iconInfo.size&&n.iconInfo.markerOffsetRatio?n.iconInfo.size.height*n.iconInfo.markerOffsetRatio.y:0};t.SetAnchor(e)})},Re.prototype.CreateEventObservable=function(i,t){var n=this,e=new a.Subject;return"mousemove"===i?e.asObservable():"rightclick"===i?e.asObservable():a.Observable.create(function(e){n._markers.get(t).then(function(t){t.AddListener(i,function(t){return n._zone.run(function(){return e.next(t)})})})})},Re.prototype.DeleteMarker=function(t){var i=this,e=this._markers.get(t),n=Promise.resolve();return null!=e&&(n=e.then(function(e){return t.InClusterLayer&&i._clusterService.GetNativeLayer(t.LayerId).then(function(t){t.RemoveEntity(e)}),t.InCustomLayer&&i._layerService.GetNativeLayer(t.LayerId).then(function(t){t.RemoveEntity(e)}),i._zone.run(function(){e.DeleteMarker(),i._markers["delete"](t)})})),n},Re.prototype.GetCoordinatesFromClick=function(t){if(!t)return null;if(!t.primitive)return null;if(!(t.primitive instanceof Microsoft.Maps.Pushpin))return null;var e=t.primitive.getLocation();return{latitude:e.latitude,longitude:e.longitude}},Re.prototype.GetNativeMarker=function(t){return this._markers.get(t)},Re.prototype.GetPixelsFromClick=function(t){var e=this.GetCoordinatesFromClick(t);if(null==e)return null;var i=I.TranslateLocation(e),n=this._mapService.MapInstance.tryLocationToPixel(i,Microsoft.Maps.PixelReference.control);return null==n?null:{x:n.x,y:n.y}},Re.prototype.LocationToPoint=function(t){var i=this;return null==t?Promise.resolve(null):t instanceof qt?this._markers.get(t).then(function(t){var e=t.Location;return i._mapService.LocationToPoint(e)}):this._mapService.LocationToPoint(t)},Re.prototype.UpdateAnchor=function(e){return this._markers.get(e).then(function(t){t.SetAnchor(e.Anchor)})},Re.prototype.UpdateDraggable=function(e){return this._markers.get(e).then(function(t){return t.SetDraggable(e.Draggable)})},Re.prototype.UpdateIcon=function(n){function i(t,e,i){e&&""!==e&&(t.SetIcon(e),n.DynamicMarkerCreated.emit(i))}return this._markers.get(n).then(function(e){if(n.IconInfo){var t=l.CreateMarker(n.IconInfo);return"string"==typeof t?i(e,t,n.IconInfo):t.then(function(t){return i(e,t.icon,t.iconInfo)})}return e.SetIcon(n.IconUrl)})},Re.prototype.UpdateLabel=function(e){return this._markers.get(e).then(function(t){t.SetLabel(e.Label)})},Re.prototype.UpdateMarkerPosition=function(e){return this._markers.get(e).then(function(t){return t.SetPosition({latitude:e.Latitude,longitude:e.Longitude})})},Re.prototype.UpdateTitle=function(e){return this._markers.get(e).then(function(t){return t.SetTitle(e.Title)})},Re.prototype.UpdateVisible=function(e){return this._markers.get(e).then(function(t){return t.SetVisible(e.Visible)})},Re.decorators=[{type:r.Injectable}],Re.ctorParameters=function(){return[{type:Pt},{type:xt},{type:Zt},{type:r.NgZone}]},Re);function Re(t,e,i,n){this._mapService=t,this._layerService=e,this._clusterService=i,this._zone=n,this._markers=new Map}var Be=(Object.defineProperty(He.prototype,"LoadedModules",{get:function(){return this._modules},enumerable:!0,configurable:!0}),Object.defineProperty(He.prototype,"MapInstance",{get:function(){return this._mapInstance},enumerable:!0,configurable:!0}),Object.defineProperty(He.prototype,"MapPromise",{get:function(){return this._map},enumerable:!0,configurable:!0}),Object.defineProperty(He.prototype,"MapSize",{get:function(){return this.MapInstance?{width:this.MapInstance.getWidth(),height:this.MapInstance.getHeight()}:null},enumerable:!0,configurable:!0}),He.prototype.CreateCanvasOverlay=function(i){return this._map.then(function(t){var e=new it(i);return t.layers.insert(e),e})},He.prototype.CreateClusterLayer=function(r){var a=this;return this._map.then(function(o){return new Promise(function(n){a.LoadModule("Microsoft.Maps.Clustering",function(){var t,e=I.TranslateClusterOptions(r),i=new Microsoft.Maps.ClusterLayer(new Array,e);o.layers.insert(i),(t=new G(i,a)).SetOptions(r),n(t)})})})},He.prototype.CreateInfoWindow=function(n){return this._map.then(function(t){var e;e=null==n.position?t.getCenter():new Microsoft.Maps.Location(n.position.latitude,n.position.longitude);var i=new Microsoft.Maps.Infobox(e,I.TranslateInfoBoxOptions(n));return i.setMap(t),new N(i)})},He.prototype.CreateLayer=function(i){var n=this;return this._map.then(function(t){var e=new Microsoft.Maps.Layer(i.id.toString());return t.layers.insert(e),new w(e,n)})},He.prototype.CreateMap=function(o,r){var a=this;return this._loader.Load().then(function(){!function i(){new B(U).Extend(new Microsoft.Maps.CustomOverlay).Map("onAdd","OnAdd").Map("onLoad","OnLoad").Map("onRemove","OnRemove")}(),function n(){new B(it).Extend(new Microsoft.Maps.CustomOverlay).Map("onAdd","OnAdd").Map("onLoad","OnLoad").Map("onRemove","OnRemove")}(),null!=a._mapInstance&&a.DisposeMap();var t=I.TranslateLoadOptions(r);t.credentials||(t.credentials=a._config.apiKey);var e=new Microsoft.Maps.Map(o,t);a._mapInstance=e,a._mapResolver(e)})},He.prototype.CreateMarker=function(a){function i(t,e){var i=I.TranslateLocation(a.position),n=I.TranslateMarkerOptions(a);t&&""!==t&&(n.icon=t);var o=new Microsoft.Maps.Pushpin(i,n),r=new T(o,e,null);return a.metadata&&a.metadata.forEach(function(t,e){return r.Metadata.set(e,t)}),e.entities.push(o),r}return void 0===a&&(a={}),this._map.then(function(e){if(a.iconInfo&&a.iconInfo.markerType){var t=l.CreateMarker(a.iconInfo);return"string"==typeof t?i(t,e):t.then(function(t){return i(t.icon,e)})}return i(null,e)})},He.prototype.CreatePolygon=function(r){var a=this;return this._map.then(function(t){var e=I.TranslatePaths(r.paths),i=I.TranslatePolygonOptions(r),n=new Microsoft.Maps.Polygon(e,i);t.entities.push(n);var o=new K(n,a,null);return r.metadata&&r.metadata.forEach(function(t,e){return o.Metadata.set(e,t)}),r.title&&""!==r.title&&(o.Title=r.title),null!=r.showLabel&&(o.ShowLabel=r.showLabel),null!=r.showTooltip&&(o.ShowTooltip=r.showTooltip),null!=r.labelMaxZoom&&(o.LabelMaxZoom=r.labelMaxZoom),null!=r.labelMinZoom&&(o.LabelMinZoom=r.labelMinZoom),r.editable&&o.SetEditable(r.editable),o})},He.prototype.CreatePolyline=function(r){var a;return this._map.then(function(e){var n=I.TranslatePolylineOptions(r),t=I.TranslatePaths(r.path);if(r.path&&0<r.path.length&&!Array.isArray(r.path[0])){a=new Microsoft.Maps.Polyline(t[0],n),e.entities.push(a);var i=new Q(a,e,null);return r.metadata&&r.metadata.forEach(function(t,e){return i.Metadata.set(e,t)}),r.title&&""!==r.title&&(i.Title=r.title),null!=r.showTooltip&&(i.ShowTooltip=r.showTooltip),i}var o=new Array;return t.forEach(function(t){a=new Microsoft.Maps.Polyline(t,n),e.entities.push(a);var i=new Q(a,e,null);r.metadata&&r.metadata.forEach(function(t,e){return i.Metadata.set(e,t)}),r.title&&""!==r.title&&(i.Title=r.title),null!=r.showTooltip&&(i.ShowTooltip=r.showTooltip),o.push(i)}),o})},He.prototype.DeleteLayer=function(e){return this._map.then(function(t){t.layers.remove(e.NativePrimitve)})},He.prototype.DisposeMap=function(){var e=this;null==this._map&&null==this._mapInstance||null!=this._mapInstance&&(this._mapInstance.dispose(),this._mapInstance=null,this._map=new Promise(function(t){e._mapResolver=t}))},He.prototype.GetCenter=function(){return this._map.then(function(t){var e=t.getCenter();return{latitude:e.latitude,longitude:e.longitude}})},He.prototype.GetBounds=function(){return this._map.then(function(t){var e=t.getBounds();return{maxLatitude:e.getNorth(),maxLongitude:e.crossesInternationalDateLine()?e.getWest():e.getEast(),minLatitude:e.getSouth(),minLongitude:e.crossesInternationalDateLine()?e.getEast():e.getWest(),center:{latitude:e.center.latitude,longitude:e.center.longitude},padding:0}})},He.prototype.GetDrawingTools=function(i){var n=this;return void 0===i&&(i=!0),new Promise(function(e,t){n.LoadModuleInstance("Microsoft.Maps.DrawingTools",i).then(function(t){e(t)})})},He.prototype.GetZoom=function(){return this._map.then(function(t){return t.getZoom()})},He.prototype.LoadModule=function(t,e){var i=this;this._modules.has(t)?e():Microsoft.Maps.loadModule(t,function(){i._modules.set(t,null),e()})},He.prototype.LoadModuleInstance=function(n,o){var r=this;void 0===o&&(o=!0);var a=n.substr(n.lastIndexOf(".")+1);if(this._modules.has(n)){var t=null;return o?null!=this._modules.get(n)?t=this._modules.get(n):(t=new Microsoft.Maps[a](this._mapInstance),this._modules.set(n,t)):t=new Microsoft.Maps[a](this._mapInstance),Promise.resolve(t)}return new Promise(function(e,t){try{Microsoft.Maps.loadModule(n,function(){var t=new Microsoft.Maps[a](r._mapInstance);o?r._modules.set(n,t):r._modules.set(n,null),e(t)})}catch(i){t("Could not load module or create instance.")}})},He.prototype.LocationToPoint=function(n){return this._map.then(function(t){var e=I.TranslateLocation(n),i=t.tryLocationToPixel(e,Microsoft.Maps.PixelReference.control);return null!=i?{x:i.x,y:i.y}:null})},He.prototype.LocationsToPoints=function(n){return this._map.then(function(t){var e=n.map(function(t){return I.TranslateLocation(t)}),i=t.tryLocationToPixel(e,Microsoft.Maps.PixelReference.control);return i||new Array})},He.prototype.SetCenter=function(e){return this._map.then(function(t){return t.setView({center:I.TranslateLocation(e)})})},He.prototype.SetMapOptions=function(i){this._map.then(function(t){var e=I.TranslateOptions(i);t.setOptions(e)})},He.prototype.SetViewOptions=function(i){this._map.then(function(t){var e=I.TranslateViewOptions(i);t.setView(e)})},He.prototype.SetZoom=function(e){return this._map.then(function(t){return t.setView({zoom:e})})},He.prototype.SubscribeToMapEvent=function(t){var i=this,n=et[t];return a.Observable.create(function(e){i._map.then(function(t){Microsoft.Maps.Events.addHandler(t,n,function(t){i._zone.run(function(){return e.next(t)})})})})},He.prototype.TriggerMapEvent=function(e){return this._map.then(function(t){return Microsoft.Maps.Events.invoke(t,e,null)})},He.decorators=[{type:r.Injectable}],He.ctorParameters=function(){return[{type:Oe},{type:r.NgZone}]},He);function He(t,e){var i=this;this._loader=t,this._zone=e,this._modules=new Map,this._map=new Promise(function(t){i._mapResolver=t}),this._config=this._loader.Config}var Fe=(We.prototype.CreateMarker=function(t,a){function i(t,e){var i=I.TranslateLocation(a.position),n=I.TranslateMarkerOptions(a);t&&""!==t&&(n.icon=t);var o=new Microsoft.Maps.Pushpin(i,n),r=new T(o,null,e.NativePrimitve);return r.IsFirst=a.isFirst,r.IsLast=a.isLast,a.metadata&&a.metadata.forEach(function(t,e){return r.Metadata.set(e,t)}),e.AddEntity(r),r}var e=this.GetLayerById(t);if(null==e)throw new Error("Layer with id "+t+" not found in Layer Map");return e.then(function(e){if(a.iconInfo&&a.iconInfo.markerType){var t=l.CreateMarker(a.iconInfo);return"string"==typeof t?i(t,e):t.then(function(t){return i(t.icon,e)})}return i(null,e)})},We.prototype.CreateMarkers=function(n,o){function r(s,t){return t.map(function(t){var e,i=I.TranslateMarkerOptions(t);s&&""!==s?e=s:i.icon&&(e=i.icon),i.icon&&delete i.icon;var n=I.TranslateLocation(t.position),o=new Microsoft.Maps.Pushpin(n,i),r=l.GetImageForMarker(e);null!=r&&(o.image=r);var a=new T(o,null,null);return a.IsFirst=t.isFirst,a.IsLast=t.isLast,t.metadata&&t.metadata.forEach(function(t,e){return a.Metadata.set(e,t)}),a})}return new Promise(function(e,t){if(o&&o.markerType){var i=l.CreateMarker(o);if("string"!=typeof i)return i.then(function(t){e(r(t.icon,n))});e(r(i,n))}else e(r(null,n))})},We.prototype.DeleteLayer=function(e){var i=this,t=this._layers.get(e.Id);return null==t?Promise.resolve():t.then(function(t){return i._zone.run(function(){t.Delete(),i._layers["delete"](e.Id)})})},We.prototype.GetNativeLayer=function(t){return"number"==typeof t?this._layers.get(t):this._layers.get(t.Id)},We.prototype.GetLayerById=function(i){var n;return this._layers.forEach(function(t,e){e===i&&(n=t)}),n},We);function We(t,e){this._mapService=t,this._zone=e,this._layers=new Map}var Ue,qe=(m(Ye,Ue=Fe),Ye.prototype.AddLayer=function(e){var t=this._mapService.CreateLayer({id:e.Id});this._layers.set(e.Id,t),t.then(function(t){return t.SetVisible(e.Visible)})},Ye.prototype.CreatePolygon=function(t,r){var a=this,e=this.GetLayerById(t);if(null==e)throw new Error("Layer with id "+t+" not found in Layer Map");return e.then(function(t){var e=I.TranslatePaths(r.paths),i=I.TranslatePolygonOptions(r),n=new Microsoft.Maps.Polygon(e,i),o=new K(n,a._mapService,t.NativePrimitve);return r.metadata&&r.metadata.forEach(function(t,e){return o.Metadata.set(e,t)}),r.title&&""!==r.title&&(o.Title=r.title),null!=r.showLabel&&(o.ShowLabel=r.showLabel),null!=r.showTooltip&&(o.ShowTooltip=r.showTooltip),null!=r.labelMaxZoom&&(o.LabelMaxZoom=r.labelMaxZoom),null!=r.labelMinZoom&&(o.LabelMinZoom=r.labelMinZoom),t.AddEntity(o),o})},Ye.prototype.CreatePolygons=function(t,i){var a=this,e=this.GetLayerById(t);if(null==e)throw new Error("Layer with id "+t+" not found in Layer Map");return e.then(function(r){return new Promise(function(t,e){t(i.map(function(t){var e=I.TranslatePaths(t.paths),i=I.TranslatePolygonOptions(t),n=new Microsoft.Maps.Polygon(e,i),o=new K(n,a._mapService,r.NativePrimitve);return t.title&&""!==t.title&&(o.Title=t.title),t.metadata&&t.metadata.forEach(function(t,e){return o.Metadata.set(e,t)}),o}))})})},Ye.prototype.CreatePolyline=function(t,o){var r,a,s=this,e=this.GetLayerById(t);if(null==e)throw new Error("Layer with id "+t+" not found in Layer Map");return e.then(function(e){var t=I.TranslatePaths(o.path),i=I.TranslatePolylineOptions(o);if(o.path&&0<o.path.length&&!Array.isArray(o.path[0]))return r=new Microsoft.Maps.Polyline(t[0],i),a=new Q(r,s._mapService.MapInstance,e.NativePrimitve),e.AddEntity(a),o.metadata&&o.metadata.forEach(function(t,e){return a.Metadata.set(e,t)}),o.title&&""!==o.title&&(a.Title=o.title),null!=o.showTooltip&&(a.ShowTooltip=o.showTooltip),a;var n=new Array;return t.forEach(function(t){r=new Microsoft.Maps.Polyline(t,i),a=new Q(r,s._mapService.MapInstance,e.NativePrimitve),e.AddEntity(a),o.metadata&&o.metadata.forEach(function(t,e){return a.Metadata.set(e,t)}),o.title&&""!==o.title&&(a.Title=o.title),null!=o.showTooltip&&(a.ShowTooltip=o.showTooltip),n.push(a)}),n})},Ye.prototype.CreatePolylines=function(t,i){var s=this,e=this.GetLayerById(t);if(null==e)throw new Error("Layer with id "+t+" not found in Layer Map");return e.then(function(a){return new Promise(function(t,e){t(i.map(function(n){var t=I.TranslatePaths(n.path),o=I.TranslatePolylineOptions(n);if(t&&0<t.length&&!Array.isArray(t[0])){var e=new Microsoft.Maps.Polyline(t[0],o),i=new Q(e,s._mapService.MapInstance,a.NativePrimitve);return n.title&&""!==n.title&&(i.Title=n.title),n.metadata&&n.metadata.forEach(function(t,e){return i.Metadata.set(e,t)}),i}var r=new Array;return t.forEach(function(t){var e=new Microsoft.Maps.Polyline(t,o),i=new Q(e,s._mapService.MapInstance,a.NativePrimitve);n.metadata&&n.metadata.forEach(function(t,e){return i.Metadata.set(e,t)}),n.title&&""!==n.title&&(i.Title=n.title),r.push(i)}),r}))})})},Ye.decorators=[{type:r.Injectable}],Ye.ctorParameters=function(){return[{type:Pt},{type:r.NgZone}]},Ye);function Ye(t,e){return Ue.call(this,t,e)||this}var Ke,Xe=(m(Je,Ke=Fe),Je.prototype.AddLayer=function(i){var e=this,t={id:i.Id,visible:i.Visible,clusteringEnabled:i.ClusteringEnabled,placementMode:i.ClusterPlacementMode};i.GridSize&&(t.gridSize=i.GridSize),i.LayerOffset&&(t.layerOffset=i.LayerOffset),i.ZIndex&&(t.zIndex=i.ZIndex),i.IconInfo&&(t.clusteredPinCallback=function(t){e.CreateClusterPushPin(t,i)}),i.CustomMarkerCallback&&(t.clusteredPinCallback=function(t){e.CreateCustomClusterPushPin(t,i)}),i.SpiderClusterOptions&&(t.spiderClusterOptions=i.SpiderClusterOptions);var n=this._mapService.CreateClusterLayer(t);this._mapService.MapPromise.then(function(e){Microsoft.Maps.Events.addHandler(e,"viewchangeend",function(t){i.ClusteringEnabled&&19===e.getZoom()&&n.then(function(t){t.SetOptions({id:i.Id,clusteringEnabled:!1})}),i.ClusteringEnabled&&e.getZoom()<19&&n.then(function(t){t.GetOptions().clusteringEnabled||t.SetOptions({id:i.Id,clusteringEnabled:!0})})})}),this._layers.set(i.Id,n)},Je.prototype.CreatePolygon=function(t,e){throw new Error("Polygons are not supported in clustering layers. You can only use markers.")},Je.prototype.CreatePolygons=function(t,e){throw new Error("Polygons are not supported in clustering layers. You can only use markers.")},Je.prototype.CreatePolyline=function(t,e){throw new Error("Polylines are not supported in clustering layers. You can only use markers.")},Je.prototype.CreatePolylines=function(t,e){throw new Error("Polylines are not supported in clustering layers. You can only use markers.")},Je.prototype.StartClustering=function(t){var e=this,i=this._layers.get(t.Id);return null==i?Promise.resolve():i.then(function(t){return e._zone.run(function(){t.StartClustering()})})},Je.prototype.StopClustering=function(t){var e=this,i=this._layers.get(t.Id);return null==i?Promise.resolve():i.then(function(t){return e._zone.run(function(){t.StopClustering()})})},Je.prototype.CreateClusterPushPin=function(o,r){var a=this;this._layers.get(r.Id).then(function(t){if(r.IconInfo){var i={},e=function(t,e){i.icon=t,i.anchor=new Microsoft.Maps.Point(e.size&&e.markerOffsetRatio?e.size.width*e.markerOffsetRatio.x:0,e.size&&e.markerOffsetRatio?e.size.height*e.markerOffsetRatio.y:0),o.setOptions(i)},n=l.CreateMarker(r.IconInfo);"string"==typeof n?e(n,r.IconInfo):n.then(function(t){e(t.icon,t.iconInfo)})}r.ClusterClickAction===C.ZoomIntoCluster&&Microsoft.Maps.Events.addHandler(o,"click",function(t){return a.ZoomIntoCluster(t)}),r.ClusterClickAction===C.Spider&&(Microsoft.Maps.Events.addHandler(o,"dblclick",function(t){return a.ZoomIntoCluster(t)}),t.InitializeSpiderClusterSupport())})},Je.prototype.CreateCustomClusterPushPin=function(o,r){var a=this;this._layers.get(r.Id).then(function(i){var n=new Array;o.containedPushpins.forEach(function(t){var e=i.GetMarkerFromBingMarker(t);e&&n.push(e)});var t={markerType:s.None},e={};e.icon=r.CustomMarkerCallback(n,t),""!==e.icon&&(e.anchor=new Microsoft.Maps.Point(t.size&&t.markerOffsetRatio?t.size.width*t.markerOffsetRatio.x:0,t.size&&t.markerOffsetRatio?t.size.height*t.markerOffsetRatio.y:0),t.textOffset&&(e.textOffset=new Microsoft.Maps.Point(t.textOffset.x,t.textOffset.y)),o.setOptions(e)),r.ClusterClickAction===C.ZoomIntoCluster&&Microsoft.Maps.Events.addHandler(o,"click",function(t){return a.ZoomIntoCluster(t)}),r.ClusterClickAction===C.Spider&&(Microsoft.Maps.Events.addHandler(o,"dblclick",function(t){return a.ZoomIntoCluster(t)}),i.InitializeSpiderClusterSupport())})},Je.prototype.ZoomIntoCluster=function(t){var e=t.target;if(e&&e.containedPushpins){var i,n=new Array;e.containedPushpins.forEach(function(t){return n.push(t.getLocation())}),i=Microsoft.Maps.LocationRect.fromLocations(n),this._mapService.MapPromise.then(function(t){t.setView({bounds:i,padding:75})})}},Je.decorators=[{type:r.Injectable}],Je.ctorParameters=function(){return[{type:Pt},{type:r.NgZone}]},Je);function Je(t,e){return Ke.call(this,t,e)||this}var Qe=($e.prototype.AddPolygon=function(t){var e,i={id:t.Id,clickable:t.Clickable,draggable:t.Draggable,editable:t.Editable,fillColor:t.FillColor,fillOpacity:t.FillOpacity,geodesic:t.Geodesic,labelMaxZoom:t.LabelMaxZoom,labelMinZoom:t.LabelMinZoom,paths:t.Paths,showLabel:t.ShowLabel,showTooltip:t.ShowTooltip,strokeColor:t.StrokeColor,strokeOpacity:t.StrokeOpacity,strokeWeight:t.StrokeWeight,title:t.Title,visible:t.Visible,zIndex:t.zIndex};e=t.InCustomLayer?this._layerService.CreatePolygon(t.LayerId,i):this._mapService.CreatePolygon(i),this._polygons.set(t,e)},$e.prototype.CreateEventObservable=function(i,t){var n=this,e=new a.Subject;return"mousemove"===i?e.asObservable():"rightclick"===i?e.asObservable():a.Observable.create(function(e){n._polygons.get(t).then(function(t){t.AddListener(i,function(t){return n._zone.run(function(){return e.next(t)})})})})},$e.prototype.DeletePolygon=function(e){var i=this,t=this._polygons.get(e);return null==t?Promise.resolve():t.then(function(t){return i._zone.run(function(){t.Delete(),i._polygons["delete"](e)})})},$e.prototype.GetCoordinatesFromClick=function(t){var e=t;return{latitude:e.location.latitude,longitude:e.location.longitude}},$e.prototype.GetNativePolygon=function(t){return this._polygons.get(t)},$e.prototype.SetOptions=function(t,e){return this._polygons.get(t).then(function(t){t.SetOptions(e)})},$e.prototype.UpdatePolygon=function(e){var t=this._polygons.get(e);return null!=t&&null!=e.Paths&&Array.isArray(e.Paths)&&0!==e.Paths.length?t.then(function(t){Array.isArray(e.Paths[0])?t.SetPaths(e.Paths):t.SetPath(e.Paths)}):Promise.resolve()},$e.decorators=[{type:r.Injectable}],$e.ctorParameters=function(){return[{type:Pt},{type:xt},{type:r.NgZone}]},$e);function $e(t,e,i){this._mapService=t,this._layerService=e,this._zone=i,this._polygons=new Map}var ti=(ei.prototype.AddPolyline=function(t){var e,i={id:t.Id,clickable:t.Clickable,draggable:t.Draggable,editable:t.Editable,geodesic:t.Geodesic,path:t.Path,showTooltip:t.ShowTooltip,strokeColor:t.StrokeColor,strokeOpacity:t.StrokeOpacity,strokeWeight:t.StrokeWeight,title:t.Title,visible:t.Visible,zIndex:t.zIndex};e=t.InCustomLayer?this._layerService.CreatePolyline(t.LayerId,i):this._mapService.CreatePolyline(i),this._polylines.set(t,e)},ei.prototype.CreateEventObservable=function(i,t){var n=this,e=new a.Subject;return"mousemove"===i?e.asObservable():"rightclick"===i?e.asObservable():a.Observable.create(function(e){n._polylines.get(t).then(function(t){(Array.isArray(t)?t:[t]).forEach(function(t){return t.AddListener(i,function(t){return n._zone.run(function(){return e.next(t)})})})})})},ei.prototype.DeletePolyline=function(e){var i=this,t=this._polylines.get(e);return null==t?Promise.resolve():t.then(function(t){return i._zone.run(function(){(Array.isArray(t)?t:[t]).forEach(function(t){return t.Delete()}),i._polylines["delete"](e)})})},ei.prototype.GetCoordinatesFromClick=function(t){return t&&t.location?{latitude:t.location.latitude,longitude:t.location.longitude}:null},ei.prototype.GetNativePolyline=function(t){return this._polylines.get(t)},ei.prototype.SetOptions=function(t,e){return this._polylines.get(t).then(function(t){(Array.isArray(t)?t:[t]).forEach(function(t){return t.SetOptions(e)})})},ei.prototype.UpdatePolyline=function(n){var t=this,e=this._polylines.get(n);return null==e?Promise.resolve():e.then(function(e){return t._zone.run(function(){var t=Array.isArray(e)?e:[e],i=0<n.Path.length&&Array.isArray(n.Path[0])?n.Path:[n.Path];t.forEach(function(t,e){i.length>e&&t.SetPath(i[e])}),Array.isArray(e)&&e.length>i.length&&e.splice(i.length-1).forEach(function(t){return t.Delete()})})})},ei.decorators=[{type:r.Injectable}],ei.ctorParameters=function(){return[{type:Pt},{type:xt},{type:r.NgZone}]},ei);function ei(t,e,i){this._mapService=t,this._layerService=e,this._zone=i,this._polylines=new Map}var ii=(ni.prototype.Create=function(){return new Be(this._loader,this._zone)},ni.prototype.CreateClusterService=function(t){return new Xe(t,this._zone)},ni.prototype.CreateInfoBoxService=function(t){return new Ne(t,this._zone)},ni.prototype.CreateLayerService=function(t){return new qe(t,this._zone)},ni.prototype.CreateMarkerService=function(t,e,i){return new Ve(t,e,i,this._zone)},ni.prototype.CreatePolygonService=function(t,e){return new Qe(t,e,this._zone)},ni.prototype.CreatePolylineService=function(t,e){return new ti(t,e,this._zone)},ni.decorators=[{type:r.Injectable}],ni.ctorParameters=function(){return[{type:Oe},{type:r.NgZone}]},ni);function ni(t,e){this._loader=t,this._zone=e}function oi(t,e){return new ii(t,e)}function ri(){return new Ge(new xe,new Ie,new we)}var ai=(si.prototype.DeleteLayer=function(e){var i=this,t=this._layers.get(e.Id);return null==t?Promise.resolve():t.then(function(t){return i._zone.run(function(){t.Delete(),i._layers["delete"](e.Id)})})},si.prototype.GetNativeLayer=function(t){return"number"==typeof t?this._layers.get(t):this._layers.get(t.Id)},si.prototype.CreateMarker=function(t,s){var e=this._mapService.MapPromise,i=this._layers.get(t);return Promise.all([e,i]).then(function(t){function e(t){var i=new google.maps.Marker(t);s.metadata&&s.metadata.forEach(function(t,e){return i.Metadata.set(e,t)}),i.setMap(o);var n=new ut(i);return n.IsFirst=s.isFirst,n.IsLast=s.isLast,s.metadata&&s.metadata.forEach(function(t,e){return n.Metadata.set(e,t)}),r.AddEntity(n),n}var i=g(t,2),o=i[0],r=i[1],n=rt.TranslateMarkerOptions(s);if(s.iconInfo&&s.iconInfo.markerType){var a=l.CreateMarker(s.iconInfo);return"string"==typeof a?(n.icon=a,e(n)):a.then(function(t){return n.icon=t.icon,e(n)})}return e(n)})},si.prototype.CreateMarkers=function(t,n){function o(o){return t.map(function(t){var e=rt.TranslateMarkerOptions(t);o&&""!==o&&(e.icon=o);var i=new google.maps.Marker(e),n=new ut(i);return n.IsFirst=t.isFirst,n.IsLast=t.isLast,t.metadata&&t.metadata.forEach(function(t,e){return n.Metadata.set(e,t)}),n})}return new Promise(function(e,t){if(n&&n.markerType){var i=l.CreateMarker(n);if("string"!=typeof i)return i.then(function(t){e(o(t.icon))});e(o(i))}else e(o(null))})},si.prototype.GetLayerById=function(i){var n;return this._layers.forEach(function(t,e){e===i&&(n=t)}),n},si);function si(t,e){this._mapService=t,this._zone=e}var li,ui=(m(pi,li=ai),pi.CreateClusterIcons=function(i){return new Promise(function(t,e){var o=new Array;i.forEach(function(i,t){if(i.iconInfo){var e=l.CreateMarker(i.iconInfo);if("string"==typeof e){if(i.url=e,null==i.width&&(i.width=i.iconInfo.size.width,i.height=i.iconInfo.size.height),i.iconInfo.markerOffsetRatio&&i.iconInfo.size&&null==i.anchor){var n=i.iconInfo;i.anchor=[n.size.width*n.markerOffsetRatio.x,n.size.height*n.markerOffsetRatio.y]}delete i.iconInfo}else e.then(function(t){if(i.url=t.icon,null==i.width&&(i.width=t.iconInfo.size.width,i.height=t.iconInfo.size.height),t.iconInfo.markerOffsetRatio&&t.iconInfo.size&&null==i.anchor){var e=t.iconInfo;i.anchor=[e.size.width*e.markerOffsetRatio.x,e.size.height*e.markerOffsetRatio.y]}delete i.iconInfo}),o.push(e)}}),0===o.length?t(i):Promise.all(o).then(function(){t(i)})})},pi.prototype.AddLayer=function(o){var r=this,i={id:o.Id,visible:o.Visible,clusteringEnabled:o.ClusteringEnabled,zoomOnClick:o.ClusterClickAction===C.ZoomIntoCluster};function n(t){if(r._layerStyles.has(o.Id))r._layerStyles.get(o.Id).splice(0);else{var e=new Array;e.push({}),r._layerStyles.set(o.Id,e),t.setStyles(e)}}o.GridSize&&(i.gridSize=o.GridSize),o.MinimumClusterSize&&(i.minimumClusterSize=o.MinimumClusterSize),o.Styles&&(i.styles=o.Styles),o.UseDynamicSizeMarkers?i.styles=null:i.styles=[{height:30,width:35,textColor:"white",textSize:11,backgroundPosition:"center",iconInfo:{markerType:s.FontMarker,fontName:"FontAwesome",fontSize:30,color:"green",text:""}}];var t=this._mapService.CreateClusterLayer(i);this._layers.set(o.Id,t),t.then(function(t){var e=t.NativePrimitve;i.styles?pi.CreateClusterIcons(i.styles).then(function(t){e.setStyles(t)}):(n(e),r._mapService.MapPromise.then(function(t){t.addListener("zoom_changed",function(){n(e)})}),e.setCalculator(function(t,e){return function(t){var e=r._layerStyles.get(o.Id),i={markerType:s.None},n=o.CustomMarkerCallback(t,i);return e[0]={url:'"data:image/svg+xml;utf8,'+n+'"',height:i.size.height,width:i.size.width,textColor:"white",textSize:11,backgroundPosition:"center"},{text:t.length.toString(),index:1}}(t)}))})},pi.prototype.CreateMarker=function(t,i){var n=this,e=this.GetLayerById(t);if(null==e)throw new Error("Layer with id "+t+" not found in Layer Map");return e.then(function(e){return n._mapService.CreateMarker(i).then(function(t){return t.IsFirst=i.isFirst,t.IsLast=i.isLast,e.AddEntity(t),t})})},pi.prototype.StartClustering=function(t){return Promise.resolve()},pi.prototype.StopClustering=function(t){return Promise.resolve()},pi.prototype.CreatePolygon=function(t,e){throw new Error("Polygons are not supported in clustering layers. You can only use markers.")},pi.prototype.CreatePolygons=function(t,e){throw new Error("Polygons are not supported in clustering layers. You can only use markers.")},pi.prototype.CreatePolyline=function(t,e){throw new Error("Polylines are not supported in clustering layers. You can only use markers.")},pi.prototype.CreatePolylines=function(t,e){throw new Error("Polylines are not supported in clustering layers. You can only use markers.")},pi.decorators=[{type:r.Injectable}],pi.ctorParameters=function(){return[{type:Pt},{type:r.NgZone}]},pi);function pi(t,e){var i=li.call(this,t,e)||this;return i._layers=new Map,i._layerStyles=new Map,i}var ci,hi=(m(fi,ci=Et),fi.prototype.AddInfoWindow=function(t){var e={};""!==t.HtmlContent?e.htmlContent=t.HtmlContent:(e.title=t.Title,e.description=t.Description),(t.xOffset||t.yOffset)&&(null==e.pixelOffset&&(e.pixelOffset={x:0,y:0}),t.xOffset&&(e.pixelOffset.x=t.xOffset),t.yOffset&&(e.pixelOffset.y=t.yOffset)),e.disableAutoPan=t.DisableAutoPan,e.visible=t.Visible,"number"==typeof t.Latitude&&"number"==typeof t.Longitude&&(e.position={latitude:t.Latitude,longitude:t.Longitude});var i=this._mapService.CreateInfoWindow(e);this._boxes.set(t,i)},fi.prototype.Close=function(t){return this._boxes.get(t).then(function(t){t.Close()})},fi.prototype.CreateEventObservable=function(t,i){var n=this,o=Mt[t];return a.Observable.create(function(e){n._boxes.get(i).then(function(t){t.AddListener(o,function(t){return n._zone.run(function(){return e.next(t)})})})})},fi.prototype.DeleteInfoWindow=function(t){return Promise.resolve()},fi.prototype.Open=function(n,e){var o=this;return(n.CloseInfoBoxesOnOpen||n.Modal)&&this._boxes.forEach(function(t,e){n.Id!==e.Id&&t.then(function(t){t.IsOpen&&(t.Close(),e.Close())})}),this._boxes.get(n).then(function(i){var t={};return""!==n.HtmlContent?t.htmlContent=n.HtmlContent:(t.title=n.Title,t.description=n.Description),i.SetOptions(t),null!=n.HostMarker?o._markerService.GetNativeMarker(n.HostMarker).then(function(e){return o._mapService.MapPromise.then(function(t){return i.Open(e.NativePrimitve)})}):o._mapService.MapPromise.then(function(t){e&&i.SetPosition(e),i.Open()})})},fi.prototype.SetOptions=function(t,e){return this._boxes.get(t).then(function(t){t.SetOptions(e)})},fi.prototype.SetPosition=function(t,e){return this._boxes.get(t).then(function(t){t.SetPosition(e)}),Promise.resolve()},fi.decorators=[{type:r.Injectable}],fi.ctorParameters=function(){return[{type:Pt},{type:Lt},{type:r.NgZone}]},fi);function fi(t,e,i){var n=ci.call(this)||this;return n._mapService=t,n._markerService=e,n._zone=i,n._boxes=new Map,n}var di=(Object.defineProperty(yi.prototype,"NativePrimitve",{get:function(){return this._layer},enumerable:!0,configurable:!0}),yi.prototype.AddListener=function(t,e){throw new Error("Events are not supported on Google Layers. You can still add events to individual markers.")},yi.prototype.AddEntity=function(t){t.NativePrimitve&&(this._entities.push(t),t.NativePrimitve.setVisible(this._visible),t.NativePrimitve.setMap(this.NativePrimitve))},yi.prototype.AddEntities=function(t){var e,i=this;null!=t&&Array.isArray(t)&&0!==t.length&&((e=this._entities).push.apply(e,v(t)),n.eachSeries(v(t),function(t,e){t.NativePrimitve.setVisible(i._visible),t.NativePrimitve.setMap(i.NativePrimitve),n.nextTick(function(){return e()})}))},yi.prototype.Delete=function(){n.eachSeries(this._entities.splice(0),function(t,e){t.NativePrimitve.setMap(null),n.nextTick(function(){return e()})})},yi.prototype.GetOptions=function(){return{id:this._id}},yi.prototype.GetVisible=function(){return this._visible},yi.prototype.RemoveEntity=function(t){if(t.NativePrimitve){var e=this._entities.indexOf(t);-1<e&&this._entities.splice(e,1),t.NativePrimitve.setMap(null)}},yi.prototype.SetEntities=function(t){this.Delete(),this.AddEntities(t)},yi.prototype.SetOptions=function(t){this._id=t.id},yi.prototype.SetVisible=function(i){n.eachSeries(v(this._entities),function(t,e){t.NativePrimitve.setVisible(i),n.nextTick(function(){return e()})}),this._visible=i},yi);function yi(t,e,i){this._layer=t,this._maps=e,this._id=i,this._entities=new Array,this._visible=!0}var mi,gi=(m(vi,mi=ai),vi.prototype.AddLayer=function(n){var o=this,t=new Promise(function(i,t){o._mapService.MapPromise.then(function(t){var e=new di(t,o._mapService,n.Id);e.SetVisible(n.Visible),i(e)})});this._layers.set(n.Id,t)},vi.prototype.CreatePolygon=function(t,e){var i=this._mapService.CreatePolygon(e),n=this._layers.get(t);return Promise.all([i,n]).then(function(t){return t[1].AddEntity(t[0])}),i},vi.prototype.CreatePolygons=function(t,i){var e=this.GetLayerById(t);if(null==e)throw new Error("Layer with id "+t+" not found in Layer Map");return e.then(function(t){return new Promise(function(t,e){t(i.map(function(t){var e=rt.TranslatePolygonOptions(t),i=new google.maps.Polygon(e),n=new yt(i);return t.title&&""!==t.title&&(n.Title=t.title),t.metadata&&t.metadata.forEach(function(t,e){return n.Metadata.set(e,t)}),n}))})})},vi.prototype.CreatePolyline=function(t,e){var i=this._mapService.CreatePolyline(e),n=this._layers.get(t);return Promise.all([i,n]).then(function(t){var e,i,n=Array.isArray(t[0])?t[0]:[t[0]];try{for(var o=function s(t){var e="function"==typeof Symbol&&t[Symbol.iterator],i=0;return e?e.call(t):{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}}}(n),r=o.next();!r.done;r=o.next()){var a=r.value;t[1].AddEntity(a)}}catch(l){e={error:l}}finally{try{r&&!r.done&&(i=o["return"])&&i.call(o)}finally{if(e)throw e.error}}}),i},vi.prototype.CreatePolylines=function(t,i){var e=this.GetLayerById(t);if(null==e)throw new Error("Layer with id "+t+" not found in Layer Map");return e.then(function(t){return new Promise(function(t,e){t(i.map(function(n){var o=rt.TranslatePolylineOptions(n);if(n.path&&0<n.path.length&&!Array.isArray(n.path[0])){o.path=rt.TranslatePaths(n.path)[0];var t=new google.maps.Polyline(o),i=new vt(t);return n.title&&""!==n.title&&(i.Title=n.title),n.metadata&&n.metadata.forEach(function(t,e){return i.Metadata.set(e,t)}),i}var e=rt.TranslatePaths(n.path),r=new Array;return e.forEach(function(t){o.path=t;var e=new google.maps.Polyline(o),i=new vt(e);n.metadata&&n.metadata.forEach(function(t,e){return i.Metadata.set(e,t)}),n.title&&""!==n.title&&(i.Title=n.title),r.push(i)}),r}))})})},vi.decorators=[{type:r.Injectable}],vi.ctorParameters=function(){return[{type:Pt},{type:r.NgZone}]},vi);function vi(t,e){var i=mi.call(this,t,e)||this;return i._layers=new Map,i}var _i={HTTP:0,HTTPS:1,AUTO:2};_i[_i.HTTP]="HTTP",_i[_i.HTTPS]="HTTPS",_i[_i.AUTO]="AUTO";var bi=(Mi.decorators=[{type:r.Injectable}],Mi);function Mi(){}var ki,Ci=new bi,Si=(m(Oi,ki=Oe),Object.defineProperty(Oi.prototype,"Config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Oi.prototype.Load=function(){var n=this;if(this._scriptLoadingPromise)return this._scriptLoadingPromise;var t=this._documentRef.GetNativeDocument().createElement("script");return t.type="text/javascript",t.async=!0,t.defer=!0,t.src=this.GetMapsScriptSrc("Create"),this._scriptLoadingPromise=new Promise(function(e,i){n._windowRef.GetNativeWindow().Create=function(){if(n._config.enableClustering){var t=n._documentRef.GetNativeDocument().createElement("script");t.type="text/javascript",t.src=n.GetClusterScriptSrc(),t.onload=t.onreadystatechange=function(){e()},n._documentRef.GetNativeDocument().head.appendChild(t)}else e()},t.onerror=function(t){i(t)}}),this._documentRef.GetNativeDocument().head.appendChild(t),this._scriptLoadingPromise},Oi.prototype.GetMapsScriptSrc=function(t){var e=this._config.hostAndPath||"maps.googleapis.com/maps/api/js",i={v:this._config.apiVersion,callback:t,key:this._config.apiKey,client:this._config.clientId,channel:this._config.channel,libraries:this._config.libraries,region:this._config.region,language:this._config.language};return this.GetScriptSrc(e,i)},Oi.prototype.GetClusterScriptSrc=function(){var t=this._config.clusterHostAndPath||"developers.google.com/maps/documentation/javascript/examples/markerclusterer/markerclusterer.js";return this.GetScriptSrc(t,{})},Oi.prototype.GetScriptSrc=function(t,i){var e;switch(this._config&&this._config.protocol||_i.HTTPS){case _i.AUTO:e="";break;case _i.HTTP:e="http:";break;case _i.HTTPS:e="https:"}return e+"//"+t+"?"+Object.keys(i).filter(function(t){return null!=i[t]}).filter(function(t){return!Array.isArray(i[t])||Array.isArray(i[t])&&0<i[t].length}).map(function(t){var e=i[t];return Array.isArray(e)?{key:t,value:e.join(",")}:{key:t,value:i[t]}}).map(function(t){return t.key+"="+t.value}).join("&")},Oi.decorators=[{type:r.Injectable}],Oi.ctorParameters=function(){return[{type:bi,decorators:[{type:r.Optional}]},{type:Ie},{type:we}]},Oi);function Oi(t,e,i){var n=ki.call(this)||this;return n._config=t,n._windowRef=e,n._documentRef=i,null!==n._config&&n._config!==undefined||(n._config=Ci),n}var Pi=(wi.prototype.AddMarker=function(i){var n={anchor:i.Anchor,position:{latitude:i.Latitude,longitude:i.Longitude},title:i.Title,label:i.Label,draggable:i.Draggable,icon:i.IconUrl,iconInfo:i.IconInfo,width:i.Width,height:i.Height,isFirst:i.IsFirstInSet,isLast:i.IsLastInSet},t=null;t=i.InClusterLayer?this._clusterService.CreateMarker(i.LayerId,n):i.InCustomLayer?this._layerService.CreateMarker(i.LayerId,n):this._mapService.CreateMarker(n),this._markers.set(i,t),i.IconInfo&&t.then(function(t){i.DynamicMarkerCreated.emit(n.iconInfo);var e={x:n.iconInfo.size&&n.iconInfo.markerOffsetRatio?n.iconInfo.size.width*n.iconInfo.markerOffsetRatio.x:0,y:n.iconInfo.size&&n.iconInfo.markerOffsetRatio?n.iconInfo.size.height*n.iconInfo.markerOffsetRatio.y:0};t.SetAnchor(e)})},wi.prototype.CreateEventObservable=function(i,t){var n=this;return a.Observable.create(function(e){n._markers.get(t).then(function(t){t.AddListener(i,function(t){return n._zone.run(function(){return e.next(t)})})})})},wi.prototype.DeleteMarker=function(t){var i=this,e=this._markers.get(t);return null==e?Promise.resolve():e.then(function(e){return t.InClusterLayer&&i._clusterService.GetNativeLayer(t.LayerId).then(function(t){t.RemoveEntity(e)}),t.InCustomLayer&&i._layerService.GetNativeLayer(t.LayerId).then(function(t){t.RemoveEntity(e)}),i._zone.run(function(){e.DeleteMarker(),i._markers["delete"](t)})})},wi.prototype.GetCoordinatesFromClick=function(t){return t&&t.latLng&&t.latLng.lat&&t.latLng.lng?{latitude:t.latLng.lat(),longitude:t.latLng.lng()}:null},wi.prototype.GetNativeMarker=function(t){return this._markers.get(t)},wi.prototype.GetPixelsFromClick=function(t){if(!(t&&t.latLng&&t.latLng.lat&&t.latLng.lng))return null;if(null==this._mapService.MapInstance)return null;var e=!1,i=this._mapService.MapInstance,n=i.getProjection(),o=Math.pow(2,i.getZoom()),r=i.getBounds();(r.getCenter().lng()<r.getSouthWest().lng()||r.getCenter().lng()>r.getNorthEast().lng())&&(e=!0);var a=n.fromLatLngToPoint(r.getNorthEast()).y,s=n.fromLatLngToPoint(r.getSouthWest()).x,l=n.fromLatLngToPoint(t.latLng);return{x:Math.floor((l.x-s+(e&&l.x<s?256:0))*o),y:Math.floor((l.y-a)*o)}},wi.prototype.LocationToPoint=function(t){var i=this;return null==t?Promise.resolve(null):t instanceof qt?this._markers.get(t).then(function(t){var e=t.Location;return i._mapService.LocationToPoint(e)}):this._mapService.LocationToPoint(t)},wi.prototype.UpdateAnchor=function(e){return this._markers.get(e).then(function(t){t.SetAnchor(e.Anchor)})},wi.prototype.UpdateDraggable=function(e){return this._markers.get(e).then(function(t){return t.SetDraggable(e.Draggable)})},wi.prototype.UpdateIcon=function(n){return this._markers.get(n).then(function(t){if(n.IconInfo){var e={position:{latitude:n.Latitude,longitude:n.Longitude},iconInfo:n.IconInfo},i=rt.TranslateMarkerOptions(e);t.SetIcon(i.icon),n.DynamicMarkerCreated.emit(e.iconInfo)}else t.SetIcon(n.IconUrl)})},wi.prototype.UpdateLabel=function(e){return this._markers.get(e).then(function(t){t.SetLabel(e.Label)})},wi.prototype.UpdateMarkerPosition=function(e){return this._markers.get(e).then(function(t){return t.SetPosition({latitude:e.Latitude,longitude:e.Longitude})})},wi.prototype.UpdateTitle=function(e){return this._markers.get(e).then(function(t){return t.SetTitle(e.Title)})},wi.prototype.UpdateVisible=function(e){return this._markers.get(e).then(function(t){return t.SetVisible(e.Visible)})},wi.decorators=[{type:r.Injectable}],wi.ctorParameters=function(){return[{type:Pt},{type:xt},{type:Zt},{type:r.NgZone}]},wi);function wi(t,e,i,n){this._mapService=t,this._layerService=e,this._clusterService=i,this._zone=n,this._markers=new Map}var Li=(Object.defineProperty(Ii.prototype,"NativePrimitve",{get:function(){return this._layer},enumerable:!0,configurable:!0}),Ii.prototype.AddListener=function(t,e){throw new Error("Events are not supported on Google Cluster Layers. You can still add events to individual markers.")},Ii.prototype.AddEntity=function(t){var e=t instanceof l;(e=t instanceof ut||e)&&(t.NativePrimitve.setMap(null),t.IsFirst&&this.StopClustering()),t.NativePrimitve&&t.Location&&(this._isClustering&&this._visible?(this._layer.addMarker(t.NativePrimitve),this._markers.push(t)):this._pendingMarkers.push(t),this._markerLookup.set(t.NativePrimitve,t)),e&&t.IsLast&&this.StartClustering()},Ii.prototype.AddEntities=function(t){var e,i,n=this;if(null!=t&&Array.isArray(t)&&0!==t.length){var o=t.map(function(t){return n._markerLookup.set(t.NativePrimitve,t),t.NativePrimitve.setMap(null),t.NativePrimitve});this._isClustering&&this._visible?(this._layer.addMarkers(o),(e=this._markers).push.apply(e,v(t))):(i=this._pendingMarkers).push.apply(i,v(t))}},Ii.prototype.Delete=function(){this._layer.getMarkers().forEach(function(t){t.setMap(null)}),this._layer.clearMarkers(),this._markers.splice(0),this._pendingMarkers.splice(0)},Ii.prototype.GetMarkerFromGoogleMarker=function(t){return this._markerLookup.get(t)},Ii.prototype.GetOptions=function(){return{id:0,gridSize:this._layer.getGridSize(),clusteringEnabled:0===this._layer.getGridSize(),maxZoom:this._layer.getMaxZoom(),minimumClusterSize:this._layer.getMinClusterSize(),placementMode:this._layer.isAverageCenter()?k.MeanValue:k.FirstPin,visible:this._visible,zoomOnClick:this._layer.isZoomOnClick(),styles:this._layer.getStyles()}},Ii.prototype.GetVisible=function(){return this._visible},Ii.prototype.RemoveEntity=function(t){if(t.NativePrimitve&&t.Location){var e=this._markers.indexOf(t),i=this._pendingMarkers.indexOf(t);-1<e&&this._markers.splice(e,1),-1<i&&this._pendingMarkers.splice(i,1),this._isClustering&&this._layer.removeMarker(t.NativePrimitve),this._markerLookup["delete"](t.NativePrimitve)}},Ii.prototype.SetEntities=function(t){var e=this;this._layer.getMarkers().forEach(function(t){t.setMap(null)}),this._layer.clearMarkers(),this._markers.splice(0),this._pendingMarkers.splice(0),this._markerLookup.clear();var i=new Array;t.forEach(function(t){t.NativePrimitve&&t.Location&&(t.NativePrimitve.setMap(null),e._markerLookup.set(t.NativePrimitve,t),e._visible?(e._markers.push(t),i.push(t.NativePrimitve)):e._pendingMarkers.push(t))}),this._layer.addMarkers(i)},Ii.prototype.SetOptions=function(t){if(null!=t.placementMode)throw new Error("GoogleMarkerClusterer: PlacementMode option cannot be set after initial creation.");if(null!=t.zoomOnClick)throw new Error("GoogleMarkerClusterer: ZoomOnClick option cannot be set after initial creation.");t.callback,null!=t.clusteringEnabled&&(this._layer.setMinClusterSize(t.clusteringEnabled?1:1e7),this._layer.resetViewport(),this._layer.redraw()),null==t.gridSize||null!=t.clusteringEnabled&&!t.clusteringEnabled||(this._layer.setGridSize(t.gridSize),this._layer.resetViewport(),this._layer.redraw()),null!=t.maxZoom&&this._layer.setMaxZoom(t.maxZoom),null!=t.minimumClusterSize&&this._layer.setMinClusterSize(t.minimumClusterSize),null!=t.styles&&this._layer.setStyles(t.styles),null!=t.visible&&this.SetVisible(t.visible)},Ii.prototype.SetVisible=function(t){if(t&&this._layer.getMap(),t){var e=new Array;0<this._pendingMarkers.length?(this._pendingMarkers.forEach(function(t){t.NativePrimitve&&t.Location&&e.push(t.NativePrimitve)}),this._layer.addMarkers(e),this._markers=this._markers.concat(this._pendingMarkers.splice(0))):this._layer.redraw()}else this._layer.resetViewport(!0);this._visible=t},Ii.prototype.StartClustering=function(){var t=this;if(!this._isClustering){if(this._visible){var e=new Array;this._markers.forEach(function(t){t.NativePrimitve&&t.Location&&e.push(t.NativePrimitve)}),this._pendingMarkers.forEach(function(t){t.NativePrimitve&&t.Location&&e.push(t.NativePrimitve)}),this._layer.addMarkers(e),this._markers=this._markers.concat(this._pendingMarkers.splice(0))}this._visible||a.timer(0).subscribe(function(){t._layer.resetViewport(!0)}),this._isClustering=!0}},Ii.prototype.StopClustering=function(){this._isClustering&&(this._isClustering=!1)},Ii);function Ii(t){this._layer=t,this._isClustering=!0,this._markerLookup=new Map,this._markers=new Array,this._pendingMarkers=new Array,this._mapclicks=0,this._currentZoom=0,this._visible=!0}var Ei=(Object.defineProperty(Ti.prototype,"MapInstance",{get:function(){return this._mapInstance},enumerable:!0,configurable:!0}),Object.defineProperty(Ti.prototype,"MapPromise",{get:function(){return this._map},enumerable:!0,configurable:!0}),Object.defineProperty(Ti.prototype,"MapSize",{get:function(){if(this.MapInstance){var t=this.MapInstance.getDiv();return{width:t.offsetWidth,height:t.offsetHeight}}return null},enumerable:!0,configurable:!0}),Ti.prototype.CreateCanvasOverlay=function(i){return this._map.then(function(t){var e=new kt(i);return e.SetMap(t),e})},Ti.prototype.CreateClusterLayer=function(r){return this._map.then(function(t){var e=!1,i=new MarkerClusterer(t,[],r),n=new Li(i),o={id:r.id};return r.visible||(e=!(o.visible=!1)),r.clusteringEnabled||(e=!(o.clusteringEnabled=!1)),e&&n.SetOptions(o),n})},Ti.prototype.CreateInfoWindow=function(n){var o=this;return this._map.then(function(t){var e=rt.TranslateInfoWindowOptions(n),i=new google.maps.InfoWindow(e);return new st(i,o)})},Ti.prototype.CreateLayer=function(e){var i=this;return this._map.then(function(t){return new di(t,i,e.id)})},Ti.prototype.CreateMap=function(o,r){var a=this;return this._loader.Load().then(function(){!function i(){new B(ht).Extend(new google.maps.OverlayView).Map("changed","Changed").Map("onAdd","OnAdd").Map("draw","Draw").Map("onRemove","OnRemove")}(),function n(){new B(kt).Extend(new google.maps.OverlayView).Map("onAdd","OnAdd").Map("draw","OnDraw").Map("onRemove","OnRemove")}(),null==!r.mapTypeId&&(r.mapTypeId=p.hybrid),null!=a._mapInstance&&a.DisposeMap();var t=rt.TranslateOptions(r),e=new google.maps.Map(o,t);r.bounds&&e.fitBounds(rt.TranslateBounds(r.bounds)),a._mapInstance=e,a._mapResolver(e)})},Ti.prototype.CreateMarker=function(o){function n(t,e){var i=new google.maps.Marker(t),n=new ut(i);return n.IsFirst=o.isFirst,n.IsLast=o.isLast,o.metadata&&o.metadata.forEach(function(t,e){return n.Metadata.set(e,t)}),i.setMap(e),n}return void 0===o&&(o={}),this._map.then(function(e){var i=rt.TranslateMarkerOptions(o);if(o.iconInfo&&o.iconInfo.markerType){var t=l.CreateMarker(o.iconInfo);return"string"==typeof t?(i.icon=t,n(i,e)):t.then(function(t){return i.icon=t.icon,n(i,e)})}return n(i,e)})},Ti.prototype.CreatePolygon=function(o){return this._map.then(function(t){var e=rt.TranslatePolygonOptions(o),i=new google.maps.Polygon(e);i.setMap(t);var n=new yt(i);return o.metadata&&o.metadata.forEach(function(t,e){return n.Metadata.set(e,t)}),o.title&&""!==o.title&&(n.Title=o.title),null!=o.showLabel&&(n.ShowLabel=o.showLabel),null!=o.showTooltip&&(n.ShowTooltip=o.showTooltip),null!=o.labelMaxZoom&&(n.LabelMaxZoom=o.labelMaxZoom),null!=o.labelMinZoom&&(n.LabelMinZoom=o.labelMinZoom),n})},Ti.prototype.CreatePolyline=function(r){var a;return this._map.then(function(e){var n=rt.TranslatePolylineOptions(r);if(r.path&&0<r.path.length&&!Array.isArray(r.path[0])){n.path=rt.TranslatePaths(r.path)[0],(a=new google.maps.Polyline(n)).setMap(e);var i=new vt(a);return r.metadata&&r.metadata.forEach(function(t,e){return i.Metadata.set(e,t)}),r.title&&""!==r.title&&(i.Title=r.title),null!=r.showTooltip&&(i.ShowTooltip=r.showTooltip),i}var t=rt.TranslatePaths(r.path),o=new Array;return t.forEach(function(t){n.path=t,(a=new google.maps.Polyline(n)).setMap(e);var i=new vt(a);r.metadata&&r.metadata.forEach(function(t,e){return i.Metadata.set(e,t)}),r.title&&""!==r.title&&(i.Title=r.title),null!=r.showTooltip&&(i.ShowTooltip=r.showTooltip),o.push(i)}),o})},Ti.prototype.DeleteLayer=function(t){return Promise.resolve()},Ti.prototype.DisposeMap=function(){var e=this;null==this._map&&null==this._mapInstance||null!=this._mapInstance&&(this._mapInstance=null,this._map=new Promise(function(t){e._mapResolver=t}))},Ti.prototype.GetCenter=function(){return this._map.then(function(t){var e=t.getCenter();return{latitude:e.lat(),longitude:e.lng()}})},Ti.prototype.GetBounds=function(){return this._map.then(function(t){var e=t.getBounds();return{maxLatitude:e.getNorthEast().lat(),maxLongitude:Math.max(e.getNorthEast().lng(),e.getSouthWest().lng()),minLatitude:e.getSouthWest().lat(),minLongitude:Math.min(e.getNorthEast().lng(),e.getSouthWest().lng()),center:{latitude:e.getCenter().lat(),longitude:e.getCenter().lng()},padding:0}})},Ti.prototype.GetZoom=function(){return this._map.then(function(t){return t.getZoom()})},Ti.prototype.LocationToPoint=function(u){return this._map.then(function(t){var e=!1,i=rt.TranslateLocationObject(u),n=t.getProjection(),o=Math.pow(2,t.getZoom()),r=t.getBounds();(r.getCenter().lng()<r.getSouthWest().lng()||r.getCenter().lng()>r.getNorthEast().lng())&&(e=!0);var a=n.fromLatLngToPoint(r.getNorthEast()).y,s=n.fromLatLngToPoint(r.getSouthWest()).x,l=n.fromLatLngToPoint(i);return{x:Math.floor((l.x-s+(e&&l.x<s?256:0))*o),y:Math.floor((l.y-a)*o)}})},Ti.prototype.LocationsToPoints=function(i){return this._map.then(function(t){var n=!1,o=t.getProjection(),r=Math.pow(2,t.getZoom()),e=t.getBounds();(e.getCenter().lng()<e.getSouthWest().lng()||e.getCenter().lng()>e.getNorthEast().lng())&&(n=!0);var a=o.fromLatLngToPoint(e.getSouthWest()).x,s=o.fromLatLngToPoint(e.getNorthEast()).y;return i.map(function(t){var e=rt.TranslateLocationObject(t),i=o.fromLatLngToPoint(e);return{x:Math.floor((i.x-a+(n&&i.x<a?256:0))*r),y:Math.floor((i.y-s)*r)}})})},Ti.prototype.SetCenter=function(i){return this._map.then(function(t){var e=rt.TranslateLocationObject(i);t.setCenter(e)})},Ti.prototype.SetMapOptions=function(i){this._map.then(function(t){var e=rt.TranslateOptions(i);t.setOptions(e)})},Ti.prototype.SetViewOptions=function(i){this._map.then(function(t){i.bounds&&t.fitBounds(rt.TranslateBounds(i.bounds));var e=rt.TranslateOptions(i);t.setOptions(e)})},Ti.prototype.SetZoom=function(e){return this._map.then(function(t){return t.setZoom(e)})},Ti.prototype.SubscribeToMapEvent=function(t){var i=this,n=Mt[t];return a.Observable.create(function(e){i._map.then(function(t){t.addListener(n,function(t){i._zone.run(function(){return e.next(t)})})})})},Ti.prototype.TriggerMapEvent=function(e){return this._map.then(function(t){return google.maps.event.trigger(t,e,null)})},Ti.decorators=[{type:r.Injectable}],Ti.ctorParameters=function(){return[{type:Oe},{type:r.NgZone}]},Ti);function Ti(t,e){var i=this;this._loader=t,this._zone=e,this._map=new Promise(function(t){i._mapResolver=t}),this._config=this._loader.Config}var xi=(Ai.prototype.AddPolygon=function(t){var e={id:t.Id,clickable:t.Clickable,draggable:t.Draggable,editable:t.Editable,fillColor:t.FillColor,fillOpacity:t.FillOpacity,geodesic:t.Geodesic,labelMaxZoom:t.LabelMaxZoom,labelMinZoom:t.LabelMinZoom,paths:t.Paths,showLabel:t.ShowLabel,showTooltip:t.ShowTooltip,strokeColor:t.StrokeColor,strokeOpacity:t.StrokeOpacity,strokeWeight:t.StrokeWeight,title:t.Title,visible:t.Visible,zIndex:t.zIndex},i=this._mapService.CreatePolygon(e);this._polygons.set(t,i)},Ai.prototype.CreateEventObservable=function(i,t){var n=this;return a.Observable.create(function(e){n._polygons.get(t).then(function(t){t.AddListener(i,function(t){return n._zone.run(function(){return e.next(t)})})})})},Ai.prototype.DeletePolygon=function(e){var i=this,t=this._polygons.get(e);return null==t?Promise.resolve():t.then(function(t){return i._zone.run(function(){t.Delete(),i._polygons["delete"](e)})})},Ai.prototype.GetCoordinatesFromClick=function(t){return{latitude:t.latLng.lat(),longitude:t.latLng.lng()}},Ai.prototype.GetNativePolygon=function(t){return this._polygons.get(t)},Ai.prototype.SetOptions=function(t,e){return this._polygons.get(t).then(function(t){t.SetOptions(e)})},Ai.prototype.UpdatePolygon=function(e){var t=this._polygons.get(e);return null!=t&&null!=e.Paths&&Array.isArray(e.Paths)&&0!==e.Paths.length?t.then(function(t){Array.isArray(e.Paths[0])?t.SetPaths(e.Paths):t.SetPath(e.Paths)}):Promise.resolve()},Ai.decorators=[{type:r.Injectable}],Ai.ctorParameters=function(){return[{type:Pt},{type:xt},{type:r.NgZone}]},Ai);function Ai(t,e,i){this._mapService=t,this._layerService=e,this._zone=i,this._polygons=new Map}var zi=(Di.prototype.AddPolyline=function(t){var e={id:t.Id,clickable:t.Clickable,draggable:t.Draggable,editable:t.Editable,geodesic:t.Geodesic,path:t.Path,showTooltip:t.ShowTooltip,strokeColor:t.StrokeColor,strokeOpacity:t.StrokeOpacity,strokeWeight:t.StrokeWeight,title:t.Title,visible:t.Visible,zIndex:t.zIndex},i=this._mapService.CreatePolyline(e);this._polylines.set(t,i)},Di.prototype.CreateEventObservable=function(i,t){var n=this;return a.Observable.create(function(e){n._polylines.get(t).then(function(t){(Array.isArray(t)?t:[t]).forEach(function(t){return t.AddListener(i,function(t){return n._zone.run(function(){return e.next(t)})})})})})},Di.prototype.DeletePolyline=function(e){var i=this,t=this._polylines.get(e);return null==t?Promise.resolve():t.then(function(t){return i._zone.run(function(){(Array.isArray(t)?t:[t]).forEach(function(t){return t.Delete()}),i._polylines["delete"](e)})})},Di.prototype.GetCoordinatesFromClick=function(t){return t&&t.latLng&&t.latLng.lat&&t.latLng.lng?{latitude:t.latLng.lat(),longitude:t.latLng.lng()}:null},Di.prototype.GetNativePolyline=function(t){return this._polylines.get(t)},Di.prototype.SetOptions=function(t,e){return this._polylines.get(t).then(function(t){(Array.isArray(t)?t:[t]).forEach(function(t){return t.SetOptions(e)})})},Di.prototype.UpdatePolyline=function(n){var t=this,e=this._polylines.get(n);return null==e?Promise.resolve():e.then(function(e){return t._zone.run(function(){var t=Array.isArray(e)?e:[e],i=0<n.Path.length&&Array.isArray(n.Path[0])?n.Path:[n.Path];t.forEach(function(t,e){i.length>e&&t.SetPath(i[e])}),Array.isArray(e)&&e.length>i.length&&e.splice(i.length-1).forEach(function(t){return t.Delete()})})})},Di.decorators=[{type:r.Injectable}],Di.ctorParameters=function(){return[{type:Pt},{type:xt},{type:r.NgZone}]},Di);function Di(t,e,i){this._mapService=t,this._layerService=e,this._zone=i,this._polylines=new Map}var Gi=(ji.prototype.Create=function(){return new Ei(this._loader,this._zone)},ji.prototype.CreateClusterService=function(t){return new ui(t,this._zone)},ji.prototype.CreateInfoBoxService=function(t,e){return new hi(t,e,this._zone)},ji.prototype.CreateLayerService=function(t){return new gi(t,this._zone)},ji.prototype.CreateMarkerService=function(t,e,i){return new Pi(t,e,i,this._zone)},ji.prototype.CreatePolygonService=function(t,e){return new xi(t,e,this._zone)},ji.prototype.CreatePolylineService=function(t,e){return new zi(t,e,this._zone)},ji.decorators=[{type:r.Injectable}],ji.ctorParameters=function(){return[{type:Oe},{type:r.NgZone}]},ji);function ji(t,e){var i=this;this._loader=t,this._zone=e,this._map=new Promise(function(t){i._mapResolver=t})}function Ni(t,e){return new Gi(t,e)}function Zi(){return new Si(new bi,new Ie,new we)}var Vi=(Ri.forRoot=function(t,e){return{ngModule:Ri,providers:[t?{provide:St,useValue:t}:{provide:St,deps:[Oe,r.NgZone],useFactory:oi},e?{provide:Oe,useValue:e}:{provide:Oe,useFactory:ri},we,Ie]}},Ri.forRootBing=function(){return{ngModule:Ri,providers:[{provide:St,deps:[Oe,r.NgZone],useFactory:oi},{provide:Oe,useFactory:ri},we,Ie]}},Ri.forRootGoogle=function(){return{ngModule:Ri,providers:[{provide:St,deps:[Oe,r.NgZone],useFactory:Ni},{provide:Oe,useFactory:Zi},we,Ie]}},Ri.decorators=[{type:r.NgModule,args:[{declarations:[re,Kt,qt,Ft,Rt,ce,de,le,ge,be,Ce],imports:[e.CommonModule],exports:[e.CommonModule,Kt,qt,ce,de,Ft,Rt,re,le,ge,be,Ce]}]}],Ri);function Ri(){}t.MapComponent=Kt,t.InfoBoxComponent=Ft,t.MapMarkerDirective=qt,t.MapPolygonDirective=ce,t.MapPolylineDirective=de,t.InfoBoxActionDirective=Rt,t.MapMarkerLayerDirective=ge,t.MapPolygonLayerDirective=be,t.MapLayerDirective=re,t.ClusterLayerDirective=le,t.MapPolylineLayerDirective=Ce,t.MapTypeId=p,t.Marker=l,t.MarkerTypeId=s,t.InfoWindow=i,t.Layer=o,t.ClusterPlacementMode=k,t.ClusterClickAction=C,t.SpiderClusterMarker=b,t.Polygon=c,t.Polyline=f,t.CanvasOverlay=O,t.MapService=Pt,t.MapServiceFactory=St,t.MarkerService=Lt,t.InfoBoxService=Et,t.MapAPILoader=Oe,t.WindowRef=Ie,t.DocumentRef=we,t.LayerService=xt,t.PolygonService=zt,t.PolylineService=Gt,t.ClusterService=Zt,t.BingMapServiceFactory=ii,t.BingMapAPILoaderConfig=xe,t.BingMapService=Be,t.BingInfoBoxService=Ne,t.BingMarkerService=Ve,t.BingPolygonService=Qe,t.BingPolylineService=ti,t.BingMapAPILoader=Ge,t.BingLayerService=qe,t.BingClusterService=Xe,t.BingLayer=w,t.BingMarker=T,t.BingPolyline=Q,t.BingMapEventsLookup=et,t.BingPolygon=K,t.BingInfoWindow=N,t.BingClusterLayer=G,t.BingSpiderClusterMarker=z,t.BingCanvasOverlay=it,t.GoogleClusterService=ui,t.GoogleInfoBoxService=hi,t.GoogleLayerService=gi,t.GoogleMapAPILoader=Si,t.GoogleMapAPILoaderConfig=bi,t.GoogleMapServiceFactory=Gi,t.GoogleMapService=Ei,t.GoogleMarkerService=Pi,t.GooglePolygonService=xi,t.GooglePolylineService=zi,t.GoogleMarker=ut,t.GoogleInfoWindow=st,t.GooglePolygon=yt,t.GooglePolyline=vt,t.GoogleMapEventsLookup=Mt,t.GoogleCanvasOverlay=kt,t.MapModule=Vi,t.ɵa=Jt,t.ɵb=Qt,t.ɵc=$t,t.ɵd=te,t.ɵe=ee,t.ɵf=ie,t.ɵg=ne,t.ɵl=Fe,t.ɵi=ri,t.ɵh=oi,t.ɵm=ai,t.ɵk=Zi,t.ɵj=Ni,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=angular-maps.umd.min.js.map